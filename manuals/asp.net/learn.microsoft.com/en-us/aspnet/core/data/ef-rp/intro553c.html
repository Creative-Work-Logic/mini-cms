 <!DOCTYPE html>
		<html
			class="layout layout-holy-grail   show-table-of-contents conceptual show-breadcrumb default-focus"
			lang="en-us"
			dir="ltr"
			data-authenticated="false"
			data-auth-status-determined="false"
			data-target="docs"
			x-ms-format-detection="none"
		>
			
		
<!-- Mirrored from learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro?view=aspnetcore-9.0 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Aug 2025 14:53:03 GMT -->
<head>
			<title>Razor Pages with Entity Framework Core in ASP.NET Core - Tutorial 1 of 8 | Microsoft Learn</title>
			<meta charset="utf-8" />
			<meta name="viewport" content="width=device-width, initial-scale=1.0" />
			<meta name="color-scheme" content="light dark" />

			<meta name="description" content="Shows how to create a Razor Pages app using Entity Framework Core" />
			<link rel="canonical" href="intro553c.html?view=aspnetcore-9.0" /> 

			<!-- Non-customizable open graph and sharing-related metadata -->
			<meta name="twitter:card" content="summary" />
			<meta name="twitter:site" content="@MicrosoftLearn" />
			<meta property="og:type" content="website" />
			<meta property="og:image:alt" content="Razor Pages with Entity Framework Core in ASP.NET Core - Tutorial 1 of 8 | Microsoft Learn" />
			<meta property="og:image" content="https://learn.microsoft.com/dotnet/media/dotnet-logo.png" />
			<!-- Page specific open graph and sharing-related metadata -->
			<meta property="og:title" content="Razor Pages with Entity Framework Core in ASP.NET Core - Tutorial 1 of 8" />
			<meta property="og:url" content="intro553c.html?view=aspnetcore-9.0" />
			<meta property="og:description" content="Shows how to create a Razor Pages app using Entity Framework Core" />
			<meta name="platform_id" content="c27312f0-163f-6430-cbc5-0527c212d314" /> <meta name="scope" content="ASP.NET Core" />
			<meta name="locale" content="en-us" />
			 <meta name="adobe-target" content="true" />
			<meta name="uhfHeaderId" content="MSDocsHeader-AspNet" />

			<meta name="page_type" content="conceptual" />

			<!--page specific meta tags-->
			

			<!-- custom meta tags -->
			
		<meta name="breadcrumb_path" content="/aspnet/core/breadcrumb/toc.json" />
	
		<meta name="feedback_system" content="OpenSource" />
	
		<meta name="feedback_product_url" content="https://github.com/dotnet/aspnetcore/blob/main/CONTRIBUTING.md" />
	
		<meta name="ms.service" content="aspnet-core" />
	
		<meta name="ms.topic" content="conceptual" />
	
		<meta name="ms.subservice" content="data-access" />
	
		<meta name="author" content="tdykstra" />
	
		<meta name="ms.author" content="tdykstra" />
	
		<meta name="monikerRange" content="&gt;= aspnetcore-3.1" />
	
		<meta name="ms.custom" content="mvc" />
	
		<meta name="ms.date" content="2025-04-23T00:00:00Z" />
	
		<meta name="uid" content="data/ef-rp/intro" />
	
		<meta name="document_id" content="7a54c97f-ddd4-b041-5e5f-a2df009ace50" />
	
		<meta name="document_version_independent_id" content="fa488196-1f98-08ea-adcc-17d9dac86727" />
	
		<meta name="updated_at" content="2025-07-23T20:49:00Z" />
	
		<meta name="original_content_git_url" content="https://github.com/dotnet/AspNetCore.Docs/blob/live/aspnetcore/data/ef-rp/intro.md" />
	
		<meta name="gitcommit" content="https://github.com/dotnet/AspNetCore.Docs/blob/38f05a0772d0a9963dc2660688275ef78be08649/aspnetcore/data/ef-rp/intro.md" />
	
		<meta name="git_commit_id" content="38f05a0772d0a9963dc2660688275ef78be08649" />
	
		<meta name="monikers" content="aspnetcore-3.1" />
	
		<meta name="monikers" content="aspnetcore-5.0" />
	
		<meta name="monikers" content="aspnetcore-6.0" />
	
		<meta name="monikers" content="aspnetcore-7.0" />
	
		<meta name="monikers" content="aspnetcore-8.0" />
	
		<meta name="monikers" content="aspnetcore-9.0" />
	
		<meta name="monikers" content="aspnetcore-10.0" />
	
		<meta name="default_moniker" content="aspnetcore-9.0" />
	
		<meta name="site_name" content="Docs" />
	
		<meta name="depot_name" content="MSDN.aspnet-core-conceptual" />
	
		<meta name="schema" content="Conceptual" />
	
		<meta name="toc_rel" content="../../toc.json" />
	
		<meta name="pdf_url_template" content="https://learn.microsoft.com/pdfstore/en-us/MSDN.aspnet-core-conceptual/{branchName}{pdfName}" />
	
		<meta name="feedback_help_link_type" content="" />
	
		<meta name="feedback_help_link_url" content="" />
	
		<meta name="word_count" content="11412" />
	
		<meta name="config_moniker_range" content="&gt;= aspnetcore-1.0" />
	
		<meta name="asset_id" content="data/ef-rp/intro" />
	
		<meta name="moniker_range_name" content="dd7b9de2e2e080a77b76aef7078b3e55" />
	
		<meta name="item_type" content="Content" />
	
		<meta name="source_path" content="aspnetcore/data/ef-rp/intro.md" />
	
		<meta name="previous_tlsh_hash" content="4FAB3F43B70EEB01EFC24D2B289BBB4052F1C885BEA02AC4162775A1EA4A3D27AFAAACBB9717B344833203D302E1B15E55D5EB1EE07C577155622CBCC11D1591774E3FFAD6" />
	
		<meta name="github_feedback_content_git_url" content="https://github.com/dotnet/AspNetCore.Docs/blob/main/aspnetcore/data/ef-rp/intro.md" />
	 
		<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/911a44a7-2f6c-477c-810f-dc8b7d425cce" data-source="generated" />
	
		<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/56a03cf0-cabf-4e70-800b-dcb9ff39361c" data-source="generated" />
	
		<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/d452572f-6212-498f-9050-ca4a9e50a425" data-source="generated" />
	
		<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/14f2b9d5-6f06-45a8-ac5f-313eaa351153" data-source="generated" />
	
		<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/1ca0db39-5d2f-4866-9e04-a7fe05b37dd8" data-source="generated" />
	
		<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/a12e40b7-59a2-4437-96e2-166ce622b864" data-source="generated" />
	

			<!-- assets and js globals -->
			
			<link rel="stylesheet" href="https://learn.microsoft.com/static/assets/0.4.03137.7032-e8b681c0/styles/site-ltr.css" />
			<link rel="preconnect" href="http://mscom.demdex.net/" crossorigin />
						<link rel="dns-prefetch" href="http://target.microsoft.com/" />
						<link rel="dns-prefetch" href="http://microsoftmscompoc.tt.omtrdc.net/" />
						<link
							rel="preload"
							as="script"
							href="https://learn.microsoft.com/static/third-party/adobe-target/at-js/2.9.0/at.js"
							integrity="sha384-1/viVM50hgc33O2gOgkWz3EjiD/Fy/ld1dKYXJRUyjNYVEjSUGcSN+iPiQF7e4cu"
							crossorigin="anonymous"
							id="adobe-target-script"
							type="application/javascript"
						/>
			<script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
			<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-4.min.js"></script>
			<script src="https://learn.microsoft.com/_themes/docs.theme/master/en-us/_themes/global/deprecation.js"></script>

			<!-- msdocs global object -->
			<script id="msdocs-script">
		var msDocs = {
  "environment": {
    "accessLevel": "online",
    "azurePortalHostname": "portal.azure.com",
    "reviewFeatures": false,
    "supportLevel": "production",
    "systemContent": true,
    "siteName": "learn",
    "legacyHosting": false
  },
  "data": {
    "contentLocale": "en-us",
    "contentDir": "ltr",
    "userLocale": "en-us",
    "userDir": "ltr",
    "pageTemplate": "Conceptual",
    "brand": "",
    "context": {},
    "standardFeedback": false,
    "showFeedbackReport": false,
    "feedbackHelpLinkType": "",
    "feedbackHelpLinkUrl": "",
    "feedbackSystem": "OpenSource",
    "feedbackGitHubRepo": "dotnet/AspNetCore.Docs",
    "feedbackProductUrl": "https://github.com/dotnet/aspnetcore/blob/main/CONTRIBUTING.md",
    "extendBreadcrumb": false,
    "isEditDisplayable": true,
    "isPrivateUnauthorized": false,
    "hideViewSource": false,
    "isPermissioned": false,
    "hasRecommendations": true,
    "contributors": [
      {
        "name": "tdykstra",
        "url": "https://github.com/tdykstra"
      },
      {
        "name": "guardrex",
        "url": "https://github.com/guardrex"
      },
      {
        "name": "wadepickett",
        "url": "https://github.com/wadepickett"
      },
      {
        "name": "Rick-Anderson",
        "url": "https://github.com/Rick-Anderson"
      },
      {
        "name": "bonskki",
        "url": "https://github.com/bonskki"
      },
      {
        "name": "DavideDunne",
        "url": "https://github.com/DavideDunne"
      },
      {
        "name": "roji",
        "url": "https://github.com/roji"
      },
      {
        "name": "serpent5",
        "url": "https://github.com/serpent5"
      },
      {
        "name": "v-haiboz",
        "url": "https://github.com/v-haiboz"
      },
      {
        "name": "dharmatech",
        "url": "https://github.com/dharmatech"
      },
      {
        "name": "scottaddie",
        "url": "https://github.com/scottaddie"
      },
      {
        "name": "the-wazz",
        "url": "https://github.com/the-wazz"
      },
      {
        "name": "DCtheGeek",
        "url": "https://github.com/DCtheGeek"
      },
      {
        "name": "alberto-guerrero",
        "url": "https://github.com/alberto-guerrero"
      },
      {
        "name": "HamidMolareza",
        "url": "https://github.com/HamidMolareza"
      },
      {
        "name": "ashishagarwal06",
        "url": "https://github.com/ashishagarwal06"
      },
      {
        "name": "Potapy4",
        "url": "https://github.com/Potapy4"
      },
      {
        "name": "nschonni",
        "url": "https://github.com/nschonni"
      },
      {
        "name": "Loves2Code",
        "url": "https://github.com/Loves2Code"
      },
      {
        "name": "daveabrock",
        "url": "https://github.com/daveabrock"
      }
    ],
    "openSourceFeedbackIssueUrl": "https://github.com/dotnet/aspnetcore.docs/issues/new?template=customer-feedback.yml",
    "openSourceFeedbackIssueTitle": "",
    "openSourceFeedbackIssueLabels": "Source - Docs.ms,:watch: Not Triaged"
  },
  "functions": {}
};;
	</script>

			<!-- base scripts, msdocs global should be before this -->
			<script src="https://learn.microsoft.com/static/assets/0.4.03137.7032-e8b681c0/scripts/en-us/index-docs.js"></script>
			

			<!-- json-ld -->
			
		</head>
	
			<body
				id="body"
				data-bi-name="body"
				class="layout-body "
				lang="en-us"
				dir="ltr"
			>
				<header class="layout-body-header">
		<div class="header-holder has-default-focus">
			
		<a
			href="#main"
			
			style="z-index: 1070"
			class="outline-color-text visually-hidden-until-focused position-fixed inner-focus focus-visible top-0 left-0 right-0 padding-xs text-align-center background-color-body"
			
		>
			Skip to main content
		</a>
	
		<a
			href="#"
			data-skip-to-ask-learn
			style="z-index: 1070"
			class="outline-color-text visually-hidden-until-focused position-fixed inner-focus focus-visible top-0 left-0 right-0 padding-xs text-align-center background-color-body"
			hidden
		>
			Skip to Ask Learn chat experience
		</a>
	

			<div hidden id="cookie-consent-holder" data-test-id="cookie-consent-container"></div>
			<!-- Unsupported browser warning -->
			<div
				id="unsupported-browser"
				style="background-color: white; color: black; padding: 16px; border-bottom: 1px solid grey;"
				hidden
			>
				<div style="max-width: 800px; margin: 0 auto;">
					<p style="font-size: 24px">This browser is no longer supported.</p>
					<p style="font-size: 16px; margin-top: 16px;">
						Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.
					</p>
					<div style="margin-top: 12px;">
						<a
							href="https://go.microsoft.com/fwlink/p/?LinkID=2092881"
							style="background-color: #0078d4; border: 1px solid #0078d4; color: white; padding: 6px 12px; border-radius: 2px; display: inline-block;"
						>
							Download Microsoft Edge
						</a>
						<a
							href="https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge"
							style="background-color: white; padding: 6px 12px; border: 1px solid #505050; color: #171717; border-radius: 2px; display: inline-block;"
						>
							More info about Internet Explorer and Microsoft Edge
						</a>
					</div>
				</div>
			</div>
			<!-- site header -->
			<header
				id="ms--site-header"
				data-test-id="site-header-wrapper"
				role="banner"
				itemscope="itemscope"
				itemtype="http://schema.org/Organization"
			>
				<div
					id="ms--mobile-nav"
					class="site-header display-none-tablet padding-inline-none gap-none"
					data-bi-name="mobile-header"
					data-test-id="mobile-header"
				></div>
				<div
					id="ms--primary-nav"
					class="site-header display-none display-flex-tablet"
					data-bi-name="L1-header"
					data-test-id="primary-header"
				></div>
				<div
					id="ms--secondary-nav"
					class="site-header display-none display-flex-tablet"
					data-bi-name="L2-header"
					data-test-id="secondary-header"
				></div>
			</header>
			
		<!-- banner -->
		<div data-banner>
			<div id="disclaimer-holder"></div>
			
		</div>
		<!-- banner end -->
	
		</div>
	</header>
				 <section
					id="layout-body-menu"
					class="layout-body-menu display-flex"
					data-bi-name="menu"
			  >
					<div
		id="left-container"
		class="left-container display-none display-block-tablet padding-inline-sm padding-bottom-sm width-full"
	>
		<nav
			id="affixed-left-container"
			class="margin-top-sm-tablet position-sticky display-flex flex-direction-column"
			aria-label="Primary"
		></nav>
	</div>
			  </section>

				<main
					id="main"
					role="main"
					class="layout-body-main "
					data-bi-name="content"
					lang="en-us"
					dir="ltr"
				>
					
			<div
		id="ms--content-header"
		class="content-header default-focus border-bottom-none"
		data-bi-name="content-header"
	>
		<div class="content-header-controls margin-xxs margin-inline-sm-tablet">
			<button
				type="button"
				class="contents-button button button-sm margin-right-xxs"
				data-bi-name="contents-expand"
				aria-haspopup="true"
				data-contents-button
			>
				<span class="icon" aria-hidden="true"><span class="docon docon-menu"></span></span>
				<span class="contents-expand-title"> Table of contents </span>
			</button>
			<button
				type="button"
				class="ap-collapse-behavior ap-expanded button button-sm"
				data-bi-name="ap-collapse"
				aria-controls="action-panel"
			>
				<span class="icon" aria-hidden="true"><span class="docon docon-exit-mode"></span></span>
				<span>Exit editor mode</span>
			</button>
		</div>
	</div>
			<div data-main-column class="padding-sm padding-top-none padding-top-sm-tablet">
				<div>
					
		<div id="article-header" class="background-color-body margin-bottom-xs display-none-print">
			<div class="display-flex align-items-center justify-content-space-between">
				
		<details
			id="article-header-breadcrumbs-overflow-popover"
			class="popover"
			data-for="article-header-breadcrumbs"
		>
			<summary
				class="button button-clear button-primary button-sm inner-focus"
				aria-label="All breadcrumbs"
			>
				<span class="icon">
					<span class="docon docon-more"></span>
				</span>
			</summary>
			<div id="article-header-breadcrumbs-overflow" class="popover-content padding-none"></div>
		</details>

		<bread-crumbs
			id="article-header-breadcrumbs"
			data-test-id="article-header-breadcrumbs"
			class="overflow-hidden flex-grow-1 margin-right-sm margin-right-md-tablet margin-right-lg-desktop margin-left-negative-xxs padding-left-xxs"
		></bread-crumbs>
	 
		<div
			id="article-header-page-actions"
			class="opacity-none margin-left-auto display-flex flex-wrap-no-wrap align-items-stretch"
		>
			
		<button
			class="button button-sm border-none inner-focus display-none-tablet flex-shrink-0 "
			data-bi-name="ask-learn-assistant-entry"
			data-test-id="ask-learn-assistant-modal-entry-mobile"
			data-ask-learn-modal-entry
			type="button"
			style="min-width: max-content;"
			aria-expanded="false"
			aria-label="Ask Learn"
			hidden
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
			</span>
		</button>
		<button
			class="button button-sm display-none display-inline-flex-tablet display-none-desktop flex-shrink-0 margin-right-xxs border-color-ask-learn "
			data-bi-name="ask-learn-assistant-entry"
			data-test-id="ask-learn-assistant-modal-entry-tablet"
			data-ask-learn-modal-entry
			type="button"
			style="min-width: max-content;"
			aria-expanded="false"
			hidden
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
			</span>
			<span>Ask Learn</span>
		</button>
		<button
			class="button button-sm display-none flex-shrink-0 display-inline-flex-desktop margin-right-xxs	border-color-ask-learn "
			data-bi-name="ask-learn-assistant-entry"
			data-test-id="ask-learn-assistant-flyout-entry"
			data-ask-learn-flyout-entry
			data-flyout-button="toggle"
			type="button"
			style="min-width: max-content;"
			aria-expanded="false"
			aria-controls="ask-learn-flyout"
			hidden
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
			</span>
			<span>Ask Learn</span>
		</button>
	 
		<button
			type="button"
			id="ms--focus-mode-button"
			data-focus-mode
			data-bi-name="focus-mode-entry"
			class="button button-sm flex-shrink-0 margin-right-xxs display-none display-inline-flex-desktop"
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-glasses"></span>
			</span>
			<span>Focus mode</span>
		</button>
	 

			<details class="popover popover-right" id="article-header-page-actions-overflow">
				<summary
					class="justify-content-flex-start button button-clear button-sm button-primary inner-focus"
					aria-label="More actions"
					title="More actions"
				>
					<span class="icon" aria-hidden="true">
						<span class="docon docon-more-vertical"></span>
					</span>
				</summary>
				<div class="popover-content">
					
		<button
			data-page-action-item="overflow-mobile"
			type="button"
			class="button-block button-sm has-inner-focus button button-clear display-none-tablet justify-content-flex-start text-align-left"
			data-bi-name="contents-expand"
			data-contents-button
			data-popover-close
		>
			<span class="icon">
				<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
			</span>
			<span class="contents-expand-title">Table of contents</span>
		</button>
	 
		<a
			id="lang-link-overflow"
			class="button-sm has-inner-focus button button-clear button-block justify-content-flex-start text-align-left"
			data-bi-name="language-toggle"
			data-page-action-item="overflow-all"
			data-check-hidden="true"
			data-read-in-link
			href="#"
			hidden
		>
			<span class="icon" aria-hidden="true" data-read-in-link-icon>
				<span class="docon docon-locale-globe"></span>
			</span>
			<span data-read-in-link-text>Read in English</span>
		</a>
	 
		<button
			type="button"
			class="collection button button-clear button-sm button-block justify-content-flex-start text-align-left inner-focus"
			data-list-type="collection"
			data-bi-name="collection"
			data-page-action-item="overflow-all"
			data-check-hidden="true"
			data-popover-close
		>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-circle-addition"></span>
			</span>
			<span class="collection-status">Add</span>
		</button>
	
					
		<button
			type="button"
			class="collection button button-block button-clear button-sm justify-content-flex-start text-align-left inner-focus"
			data-list-type="plan"
			data-bi-name="plan"
			data-page-action-item="overflow-all"
			data-check-hidden="true"
			data-popover-close
			hidden
		>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-circle-addition"></span>
			</span>
			<span class="plan-status">Add to plan</span>
		</button>
	  
		<a
			data-contenteditbtn
			class="button button-clear button-block button-sm inner-focus justify-content-flex-start text-align-left text-decoration-none"
			data-bi-name="edit"
			
			href="https://github.com/dotnet/AspNetCore.Docs/blob/main/aspnetcore/data/ef-rp/intro.md"
			data-original_content_git_url="https://github.com/dotnet/AspNetCore.Docs/blob/live/aspnetcore/data/ef-rp/intro.md"
			data-original_content_git_url_template="{repo}/blob/{branch}/aspnetcore/data/ef-rp/intro.md"
			data-pr_repo=""
			data-pr_branch=""
		>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-edit-outline"></span>
			</span>
			<span>Edit</span>
		</a>
	
					
		<hr class="margin-block-xxs" />
		<h4 class="font-size-sm padding-left-xxs">Share via</h4>
		
					<a
						class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-facebook"
						data-bi-name="facebook"
						data-page-action-item="overflow-all"
						href="#"
					>
						<span class="icon color-primary" aria-hidden="true">
							<span class="docon docon-facebook-share"></span>
						</span>
						<span>Facebook</span>
					</a>

					<a
						href="#"
						class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-twitter"
						data-bi-name="twitter"
						data-page-action-item="overflow-all"
					>
						<span class="icon color-text" aria-hidden="true">
							<span class="docon docon-xlogo-share"></span>
						</span>
						<span>x.com</span>
					</a>

					<a
						href="#"
						class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-linkedin"
						data-bi-name="linkedin"
						data-page-action-item="overflow-all"
					>
						<span class="icon color-primary" aria-hidden="true">
							<span class="docon docon-linked-in-logo"></span>
						</span>
						<span>LinkedIn</span>
					</a>
					<a
						href="#"
						class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-email"
						data-bi-name="email"
						data-page-action-item="overflow-all"
					>
						<span class="icon color-primary" aria-hidden="true">
							<span class="docon docon-mail-message"></span>
						</span>
						<span>Email</span>
					</a>
			  
	 
		<hr class="margin-block-xxs" />
		<button
			class="button button-block button-clear button-sm justify-content-flex-start text-align-left inner-focus"
			type="button"
			data-bi-name="print"
			data-page-action-item="overflow-all"
			data-popover-close
			data-print-page
			data-check-hidden="true"
		>
			<span class="icon color-primary" aria-hidden="true">
				<span class="docon docon-print"></span>
			</span>
			<span>Print</span>
		</button>
	
				</div>
			</details>
		</div>
	
			</div>
		</div>
	
					<!-- azure disclaimer -->
					
					<!-- privateUnauthorizedTemplate is hidden by default -->
					
		<div unauthorized-private-section data-bi-name="permission-content-unauthorized-private" hidden>
			<hr class="hr margin-top-xs margin-bottom-sm" />
			<div class="notification notification-info">
				<div class="notification-content">
					<p class="margin-top-none notification-title">
						<span class="icon">
							<span class="docon docon-exclamation-circle-solid" aria-hidden="true"></span>
						</span>
						<span>Note</span>
					</p>
					<p class="margin-top-none authentication-determined not-authenticated">
						Access to this page requires authorization. You can try <a class="docs-sign-in" href="#" data-bi-name="permission-content-sign-in">signing in</a> or <a  class="docs-change-directory" data-bi-name="permisson-content-change-directory">changing directories</a>.
					</p>
					<p class="margin-top-none authentication-determined authenticated">
						Access to this page requires authorization. You can try <a class="docs-change-directory" data-bi-name="permisson-content-change-directory">changing directories</a>.
					</p>
				</div>
			</div>
		</div>
	
					<div class="content"><h1 id="razor-pages-with-entity-framework-core-in-aspnet-core---tutorial-1-of-8">Razor Pages with Entity Framework Core in ASP.NET Core - Tutorial 1 of 8</h1></div>
					
		<div
			id="article-metadata"
			class="page-metadata-container display-flex gap-xxs justify-content-space-between align-items-center flex-wrap-wrap"
		>
			
		<div class="margin-block-xxs">
			<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
				  <li class="visibility-hidden-visual-diff">
			<local-time
				format="twoDigitNumeric"
				datetime="2025-04-23T08:00:00.000Z"
				data-article-date-source="calculated"
				class="is-invisible"
			>
				2025-04-23
			</local-time>
		</li>  
			</ul>
		</div>
	 
				<div
					id="user-feedback"
					class="margin-block-xxs display-none display-none-print"
					hidden
					data-hide-on-archived
				>
					
		<button
			id="user-feedback-button"
			data-test-id="conceptual-feedback-button"
			class="button button-sm button-clear button-primary display-none"
			type="button"
			data-bi-name="user-feedback-button"
			data-user-feedback-button
			hidden
		>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-like"></span>
			</span>
			<span>Feedback</span>
		</button>
	
				</div>
		  
		</div>
	 
		<nav
			id="center-doc-outline"
			class="doc-outline is-hidden-desktop display-none-print margin-bottom-sm"
			data-bi-name="intopic toc"
			aria-label="In this article"
		>
			<h2 id="ms--in-this-article" class="title is-6 margin-block-xs">
				In this article
			</h2>
		</nav>
	
					<div class="content"><div data-moniker="aspnetcore-3.1 aspnetcore-5.0 aspnetcore-6.0 aspnetcore-7.0 aspnetcore-8.0">
<div class="NOTE">
<p>Note</p>
<p>This isn't the latest version of this article. For the current release, see the <a href="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro?view=aspnetcore-9.0&amp;preserve-view=true" data-linktype="relative-path">.NET 9 version of this article</a>.</p>
</div>
</div>
<div data-moniker="aspnetcore-3.1 aspnetcore-5.0 aspnetcore-7.0">
<div class="WARNING">
<p>Warning</p>
<p>This version of ASP.NET Core is no longer supported. For more information, see the <a href="https://dotnet.microsoft.com/platform/support/policy/dotnet-core" data-linktype="external">.NET and .NET Core Support Policy</a>. For the current release, see the <a href="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro?view=aspnetcore-9.0&amp;preserve-view=true" data-linktype="relative-path">.NET 9 version of this article</a>.</p>
</div>
</div>
<div data-moniker="aspnetcore-10.0">
<div class="IMPORTANT">
<p>Important</p>
<p>This information relates to a pre-release product that may be substantially modified before it's commercially released. Microsoft makes no warranties, express or implied, with respect to the information provided here.</p>
<p>For the current release, see the <a href="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro?view=aspnetcore-9.0&amp;preserve-view=true" data-linktype="relative-path">.NET 9 version of this article</a>.</p>
</div>
</div>
<!--
Include either this file or 'not-latest-version-without-not-supported-content.md' at the top 
of articles.

'not-latest-version.md' (this file): Includes not-supported content.
'not-latest-version-without-not-supported-content.md': Doesn't include not-supported content.

Use this file in articles that target >=7.0. For articles that target >=8.0 prior to 9.0
reaching EOL, 'not-latest-version-without-not-supported-content.md' must be used to avoid
a zone/file moniker range mismatch error.

When a new version is released, it might be necessary to temporarily comment out the current 
version moniker range section until the new moniker is created.

Markdown to include this file:

[!INCLUDE[](~/includes/not-latest-version.md)]
-->
<p>By <a href="https://github.com/tdykstra" data-linktype="external">Tom Dykstra</a>, <a href="https://twitter.com/jeremylikness" data-linktype="external">Jeremy Likness</a>, and <a href="https://twitter.com/thereformedprog" data-linktype="external">Jon P Smith</a></p>
<div data-moniker="aspnetcore-10.0 aspnetcore-6.0 aspnetcore-7.0 aspnetcore-8.0 aspnetcore-9.0">
<p>This is the first in a series of tutorials that show how to use Entity Framework (EF) Core in an <a href="../../razor-pages/index553c.html?view=aspnetcore-9.0" data-linktype="relative-path">ASP.NET Core Razor Pages</a> app. The tutorials build a web site for a fictional Contoso University. The site includes functionality such as student admission, course creation, and instructor assignments. The tutorial uses the code first approach. For information on following this tutorial using the database first approach, see <a href="https://github.com/dotnet/AspNetCore.Docs/issues/16897" data-linktype="external">this Github issue</a>.</p>
<p><a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/data/ef-rp/intro/samples/cu60" data-linktype="external">Download or view the completed app.</a> <a href="../../overview553c.html?view=aspnetcore-9.0#how-to-download-a-sample" data-linktype="relative-path">Download instructions</a>.</p>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li>If you're new to Razor Pages, go through the <a href="../../tutorials/razor-pages/razor-pages-start553c.html?view=aspnetcore-9.0" data-linktype="relative-path">Get started with Razor Pages</a> tutorial series before starting this one.</li>
</ul>
<div class="tabGroup" id="tabgroup_1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_1_visual-studio" role="tab" aria-controls="tabpanel_1_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_1_visual-studio-code" role="tab" aria-controls="tabpanel_1_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_1_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li><p><a href="https://visualstudio.microsoft.com/downloads/" data-linktype="external">Visual Studio 2022</a> with the <strong>ASP.NET and web development</strong> workload.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/tutorials/min-web-api/_static/asp-net-web-dev.png?view=aspnetcore-9.0" alt="VS22 installer workloads" data-linktype="relative-path"></p>
</li>
</ul>
<h3 id="database-engines">Database engines</h3>
<p>The Visual Studio instructions use <a href="https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/sql-server-2016-express-localdb" data-linktype="absolute-path">SQL Server LocalDB</a>, a version of SQL Server Express that runs only on Windows.</p>
</section>
<section id="tabpanel_1_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<ul>
<li><a href="https://code.visualstudio.com/download" data-linktype="external">Visual Studio Code</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=ms-dotnettools.csharp" data-linktype="external">C# for Visual Studio Code (latest version)</a></li>
<li><a href="https://dotnet.microsoft.com/download/dotnet/6.0" data-linktype="external">.NET 6 SDK</a></li>
</ul>
<p>The Visual Studio Code instructions use the .NET CLI for ASP.NET Core development functions such as project creation. You can follow these instructions on macOS, Linux, or Windows and with any code editor. Minor changes may be required if you use something other than Visual Studio Code.</p>
<p>Consider downloading and installing a third-party tool for managing and viewing a SQLite database, such as <a href="https://sqlitebrowser.org/" data-linktype="external">DB Browser for SQLite</a>.</p>
<h3 id="database-engines-1">Database engines</h3>
<p>The Visual Studio Code tab use <a href="https://www.sqlite.org/" data-linktype="external">SQLite</a>, a cross-platform database engine.</p>
</section>
</div>
<h3 id="troubleshooting">Troubleshooting</h3>
<p>If you run into a problem you can't resolve, compare your code to the <a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/data/ef-rp/intro/samples" data-linktype="external">completed project</a>. A good way to get help is by posting a question to StackOverflow.com, using the <a href="https://stackoverflow.com/questions/tagged/asp.net-core" data-linktype="external">ASP.NET Core tag</a> or the <a href="https://stackoverflow.com/questions/tagged/entity-framework-core" data-linktype="external">EF Core tag</a>.</p>
<h3 id="the-sample-app">The sample app</h3>
<p>The app built in these tutorials is a basic university web site. Users can view and update student, course, and instructor information. Here are a few of the screens created in the tutorial.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/students-index30.png?view=aspnetcore-9.0" alt="Students Index page" data-linktype="relative-path"></p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/student-edit30.png?view=aspnetcore-9.0" alt="Students Edit page" data-linktype="relative-path"></p>
<p>The UI style of this site is based on the built-in project templates. The tutorial's focus is on how to use EF Core with ASP.NET Core, not how to customize the UI.</p>
<p><a name="build"></a></p>
<h3 id="optional-build-the-sample-download">Optional: Build the sample download</h3>
<p>This step is optional. Building the completed app is recommended when you have problems you can't solve. If you run into a problem you can't resolve, compare your code to the <a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/data/ef-rp/intro/samples/cu50" data-linktype="external">completed project</a>. <a href="../../overview553c.html?view=aspnetcore-9.0#how-to-download-a-sample" data-linktype="relative-path">Download instructions</a>.</p>
<div class="tabGroup" id="tabgroup_2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_2_visual-studio" role="tab" aria-controls="tabpanel_2_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_2_visual-studio-code" role="tab" aria-controls="tabpanel_2_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_2_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>Select <code>ContosoUniversity.csproj</code> to open the project.</p>
<ul>
<li><p>Build the project.</p>
</li>
<li><p>In Package Manager Console (PMC) run the following command:</p>
<pre><code class="lang-powershell">Update-Database
</code></pre>
</li>
</ul>
</section>
<section id="tabpanel_2_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<ul>
<li><p>Remove the comments from the <code>ContosoUniversity.csproj</code> file so <code>SQLiteVersion</code> is defined:</p>
<pre><code class="lang-xml">&lt;PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|AnyCPU'"&gt;
  &lt;DefineConstants&gt;TRACE;SQLiteVersion&lt;/DefineConstants&gt;
&lt;/PropertyGroup&gt;
</code></pre>
</li>
<li><p>In a command window, update the database:</p>
<pre><code class="lang-dotnetcli">dotnet tool install --global dotnet-ef
dotnet ef database update

</code></pre>
</li>
</ul>
<div class="NOTE">
<p>Note</p>
<p>By default the architecture of the .NET binaries to install represents the currently running OS architecture. To specify a different OS architecture, see <a href="https://learn.microsoft.com/en-us/dotnet/core/tools/dotnet-tool-install#options" data-linktype="absolute-path">dotnet tool install, --arch option</a>.
For more information, see GitHub issue <a href="https://github.com/dotnet/AspNetCore.Docs/issues/29262" data-linktype="external">dotnet/AspNetCore.Docs #29262</a>.</p>
</div>
<!-- prerelease versions require
  dotnet tool uninstall --global dotnet-ef
-->
</section>
</div>

<p>Run the project to seed the database.</p>
<h2 id="create-the-web-app-project">Create the web app project</h2>
<div class="tabGroup" id="tabgroup_3">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_3_visual-studio" role="tab" aria-controls="tabpanel_3_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_3_visual-studio-code" role="tab" aria-controls="tabpanel_3_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_3_visual-studio" role="tabpanel" data-tab="visual-studio">

<ol>
<li><p>Start Visual Studio 2022 and select <strong>Create a new project</strong>.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/tutorials/razor-pages/razor-pages-start/_static/6/start-window-create-new-project.png?view=aspnetcore-9.0" alt="Create a new project from the start window" data-linktype="relative-path"></p>
</li>
<li><p>In the <strong>Create a new project</strong> dialog, select <strong>ASP.NET Core Web App</strong>, and then select <strong>Next</strong>.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/tutorials/razor-pages/razor-pages-start/_static/6/np.png?view=aspnetcore-9.0" alt="Create an ASP.NET Core Web App" data-linktype="relative-path"></p>
</li>
<li><p>In the <strong>Configure your new project</strong> dialog, enter <code>ContosoUniversity</code> for <strong>Project name</strong>. It's important to name the project <em>ContosoUniversity</em>, including matching the capitalization, so the namespaces will match when you copy and paste example code.</p>
</li>
<li><p>Select <strong>Next</strong>.</p>
</li>
<li><p>In the <strong>Additional information</strong> dialog, select <strong>.NET 6.0 (Long-term support)</strong> and then select <strong>Create</strong>.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/tutorials/razor-pages/razor-pages-start/_static/6/additional-info.png?view=aspnetcore-9.0" alt="Additional information" data-linktype="relative-path"></p>
</li>
</ol>
</section>
<section id="tabpanel_3_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<ul>
<li><p>In a terminal, navigate to the folder in which the project folder should be created.</p>
</li>
<li><p>Run the following commands to create a Razor Pages project and <code>cd</code> into the new project folder:</p>
<pre><code class="lang-dotnetcli">dotnet new webapp -o ContosoUniversity
cd ContosoUniversity  
</code></pre>
</li>
</ul>
</section>
</div>
<h2 id="set-up-the-site-style">Set up the site style</h2>
<p>Copy and paste the following code into the <code>Pages/Shared/_Layout.cshtml</code> file:</p>
<pre><code class="lang-cshtml" name="Main" highlight-lines="6,15,22-36,50">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
    &lt;title&gt;@ViewData["Title"] - Contoso University&lt;/title&gt;
    &lt;link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.css" /&gt;
    &lt;link rel="stylesheet" href="~/css/site.css" asp-append-version="true" /&gt;
    &lt;link rel="stylesheet" href="~/ContosoUniversity.styles.css" asp-append-version="true" /&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;header&gt;
        &lt;nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3"&gt;
            &lt;div class="container"&gt;
                &lt;a class="navbar-brand" asp-area="" asp-page="/Index"&gt;Contoso University&lt;/a&gt;
                &lt;button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target=".navbar-collapse" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation"&gt;
                    &lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;
                &lt;/button&gt;
                &lt;div class="navbar-collapse collapse d-sm-inline-flex justify-content-between"&gt;
                    &lt;ul class="navbar-nav flex-grow-1"&gt;                        
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" asp-area="" asp-page="/About"&gt;About&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" asp-area="" asp-page="/Students/Index"&gt;Students&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" asp-area="" asp-page="/Courses/Index"&gt;Courses&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" asp-area="" asp-page="/Instructors/Index"&gt;Instructors&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" asp-area="" asp-page="/Departments/Index"&gt;Departments&lt;/a&gt;
                        &lt;/li&gt;
                    &lt;/ul&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/nav&gt;
    &lt;/header&gt;
    &lt;div class="container"&gt;
        &lt;main role="main" class="pb-3"&gt;
            @RenderBody()
        &lt;/main&gt;
    &lt;/div&gt;

    &lt;footer class="border-top footer text-muted"&gt;
        &lt;div class="container"&gt;
            &amp;copy; 2021 - Contoso University - &lt;a asp-area="" asp-page="/Privacy"&gt;Privacy&lt;/a&gt;
        &lt;/div&gt;
    &lt;/footer&gt;

    &lt;script src="~/lib/jquery/dist/jquery.js"&gt;&lt;/script&gt;
    &lt;script src="~/lib/bootstrap/dist/js/bootstrap.bundle.js"&gt;&lt;/script&gt;
    &lt;script src="~/js/site.js" asp-append-version="true"&gt;&lt;/script&gt;

    @await RenderSectionAsync("Scripts", required: false)
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>The layout file sets the site header, footer, and menu. The preceding code makes the following changes:</p>
<ul>
<li>Each occurrence of "ContosoUniversity" to "Contoso University". There are three occurrences.</li>
<li>The <strong>Home</strong> and <strong>Privacy</strong> menu entries are deleted.</li>
<li>Entries are added for <strong>About</strong>, <strong>Students</strong>, <strong>Courses</strong>, <strong>Instructors</strong>, and <strong>Departments</strong>.</li>
</ul>
<p>In <code>Pages/Index.cshtml</code>, replace the contents of the file with the following code:</p>
<pre><code class="lang-cshtml" name="Main">@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

&lt;div class="row mb-auto"&gt;
    &lt;div class="col-md-4"&gt;
        &lt;div class="row no-gutters border mb-4"&gt;
            &lt;div class="col p-4 mb-4 "&gt;
                &lt;p class="card-text"&gt;
                    Contoso University is a sample application that
                    demonstrates how to use Entity Framework Core in an
                    ASP.NET Core Razor Pages web app.
                &lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="col-md-4"&gt;
        &lt;div class="row no-gutters border mb-4"&gt;
            &lt;div class="col p-4 d-flex flex-column position-static"&gt;
                &lt;p class="card-text mb-auto"&gt;
                    You can build the application by following the steps in a series of tutorials.
                &lt;/p&gt;
                &lt;p&gt;
@*                    &lt;a href="https://docs.microsoft.com/aspnet/core/data/ef-rp/intro" class="stretched-link"&gt;See the tutorial&lt;/a&gt;
*@                &lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="col-md-4"&gt;
        &lt;div class="row no-gutters border mb-4"&gt;
            &lt;div class="col p-4 d-flex flex-column"&gt;
                &lt;p class="card-text mb-auto"&gt;
                    You can download the completed project from GitHub.
                &lt;/p&gt;
                &lt;p&gt;
@*                    &lt;a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/data/ef-rp/intro/samples" class="stretched-link"&gt;See project source code&lt;/a&gt;
*@                &lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>
<p>The preceding code replaces the text about ASP.NET Core with text about this app.</p>
<p>Run the app to verify that the home page appears.</p>
<h2 id="the-data-model">The data model</h2>
<p>The following sections create a data model:</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/data-model-diagram.png?view=aspnetcore-9.0" alt="Course-Enrollment-Student data model diagram" data-linktype="relative-path"></p>
<p>A student can enroll in any number of courses, and a course can have any number of students enrolled in it.</p>
<h2 id="the-student-entity">The Student entity</h2>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/student-entity.png?view=aspnetcore-9.0" alt="Student entity diagram" data-linktype="relative-path"></p>
<ul>
<li>Create a <em>Models</em> folder in the project folder.</li>
<li>Create <code>Models/Student.cs</code> with the following code:<pre><code class="lang-csharp" name="Main">namespace ContosoUniversity.Models
{
    public class Student
    {
        public int ID { get; set; }
        public string LastName { get; set; }
        public string FirstMidName { get; set; }
        public DateTime EnrollmentDate { get; set; }

        public ICollection&lt;Enrollment&gt; Enrollments { get; set; }
    }
}
</code></pre></li>
</ul>
<p>The <code>ID</code> property becomes the primary key column of the database table that corresponds to this class. By default, EF Core interprets a property that's named <code>ID</code> or <code>classnameID</code> as the primary key. So the alternative automatically recognized name for the <code>Student</code> class primary key is <code>StudentID</code>. For more information, see <a href="https://learn.microsoft.com/en-us/ef/core/modeling/keys?tabs=data-annotations" data-linktype="absolute-path">EF Core - Keys</a>.</p>
<p>The <code>Enrollments</code> property is a <a href="https://learn.microsoft.com/en-us/ef/core/modeling/relationships" data-linktype="absolute-path">navigation property</a>. Navigation properties hold other entities that are related to this entity. In this case, the <code>Enrollments</code> property of a <code>Student</code> entity holds all of the <code>Enrollment</code> entities that are related to that Student. For example, if a Student row in the database has two related Enrollment rows, the <code>Enrollments</code> navigation property contains those two Enrollment entities.</p>
<p>In the database, an Enrollment row is related to a Student row if its <code>StudentID</code> column contains the student's ID value. For example, suppose a Student row has ID=1. Related Enrollment rows will have <code>StudentID</code> = 1. <code>StudentID</code> is a <em>foreign key</em> in the Enrollment table.</p>
<p>The <code>Enrollments</code> property is defined as <code>ICollection&lt;Enrollment&gt;</code> because there may be multiple related Enrollment entities. Other collection types can be used, such as <code>List&lt;Enrollment&gt;</code> or <code>HashSet&lt;Enrollment&gt;</code>. When <code>ICollection&lt;Enrollment&gt;</code> is used, EF Core creates a <code>HashSet&lt;Enrollment&gt;</code> collection by default.</p>
<h2 id="the-enrollment-entity">The Enrollment entity</h2>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/enrollment-entity.png?view=aspnetcore-9.0" alt="Enrollment entity diagram" data-linktype="relative-path"></p>
<p>Create <code>Models/Enrollment.cs</code> with the following code:</p>
<pre><code class="lang-csharp">using System.ComponentModel.DataAnnotations;

namespace ContosoUniversity.Models
{
    public enum Grade
    {
        A, B, C, D, F
    }

    public class Enrollment
    {
        public int EnrollmentID { get; set; }
        public int CourseID { get; set; }
        public int StudentID { get; set; }
        [DisplayFormat(NullDisplayText = "No grade")]
        public Grade? Grade { get; set; }

        public Course Course { get; set; }
        public Student Student { get; set; }
    }
}
</code></pre>
<p>The <code>EnrollmentID</code> property is the primary key; this entity uses the <code>classnameID</code> pattern instead of <code>ID</code> by itself. For a production data model, many developers choose one pattern and use it consistently. This tutorial uses both just to illustrate that both work. Using <code>ID</code> without <code>classname</code> makes it easier to implement some kinds of data model changes.</p>
<p>The <code>Grade</code> property is an <code>enum</code>. The question mark after the <code>Grade</code> type declaration indicates that the <code>Grade</code> property is <a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/nullable-types/" data-linktype="absolute-path">nullable</a>. A grade that's null is different from a zero grade—null means a grade isn't known or hasn't been assigned yet.</p>
<p>The <code>StudentID</code> property is a foreign key, and the corresponding navigation property is <code>Student</code>. An <code>Enrollment</code> entity is associated with one <code>Student</code> entity, so the property contains a single <code>Student</code> entity.</p>
<p>The <code>CourseID</code> property is a foreign key, and the corresponding navigation property is <code>Course</code>. An <code>Enrollment</code> entity is associated with one <code>Course</code> entity.</p>
<p>EF Core interprets a property as a foreign key if it's named <code>&lt;navigation property name&gt;&lt;primary key property name&gt;</code>. For example,<code>StudentID</code> is the foreign key for the <code>Student</code> navigation property, since the <code>Student</code> entity's primary key is <code>ID</code>. Foreign key properties can also be named <code>&lt;primary key property name&gt;</code>. For example, <code>CourseID</code> since the <code>Course</code> entity's primary key is <code>CourseID</code>.</p>
<h2 id="the-course-entity">The Course entity</h2>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/course-entity.png?view=aspnetcore-9.0" alt="Course entity diagram" data-linktype="relative-path"></p>
<p>Create <code>Models/Course.cs</code> with the following code:</p>
<pre><code class="lang-csharp" name="Main">using System.ComponentModel.DataAnnotations.Schema;

namespace ContosoUniversity.Models
{
    public class Course
    {
        [DatabaseGenerated(DatabaseGeneratedOption.None)]
        public int CourseID { get; set; }
        public string Title { get; set; }
        public int Credits { get; set; }

        public ICollection&lt;Enrollment&gt; Enrollments { get; set; }
    }
}
</code></pre>
<p>The <code>Enrollments</code> property is a navigation property. A <code>Course</code> entity can be related to any number of <code>Enrollment</code> entities.</p>
<p>The <code>DatabaseGenerated</code> attribute allows the app to specify the primary key rather than having the database generate it.</p>
<p>Build the app. The compiler generates several warnings about how <code>null</code> values are handled. See <a href="https://github.com/dotnet/Scaffolding/issues/1594" data-linktype="external">this GitHub issue</a>, <a href="https://learn.microsoft.com/en-us/dotnet/csharp/nullable-references" data-linktype="absolute-path">Nullable reference types</a>, and <a href="https://learn.microsoft.com/en-us/dotnet/csharp/whats-new/tutorials/nullable-reference-types" data-linktype="absolute-path">Tutorial: Express your design intent more clearly with nullable and non-nullable reference types</a> for more information.</p>
<p>To eliminate the warnings from nullable reference types, remove the following line from the <code>ContosoUniversity.csproj</code> file:</p>
<pre><code class="lang-xml">&lt;Nullable&gt;enable&lt;/Nullable&gt;
</code></pre>
<p>The scaffolding engine currently does not support <a href="https://learn.microsoft.com/en-us/dotnet/csharp/nullable-references" data-linktype="absolute-path">nullable reference types</a>, therefore the models used in scaffold can't either.</p>
<p>Remove the <code>?</code> nullable reference type annotation from <code>public string? RequestId { get; set; }</code> in <code>Pages/Error.cshtml.cs</code> so the project builds without compiler warnings.</p>
<h2 id="scaffold-student-pages">Scaffold Student pages</h2>
<p>In this section, the ASP.NET Core scaffolding tool is used to generate:</p>
<ul>
<li>An EF Core <code>DbContext</code> class. The context is the main class that coordinates Entity Framework functionality for a given data model. It derives from the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.dbcontext" class="no-loc" data-linktype="absolute-path">Microsoft.EntityFrameworkCore.DbContext</a> class.</li>
<li>Razor pages that handle Create, Read, Update, and Delete (CRUD) operations for the <code>Student</code> entity.</li>
</ul>
<div class="tabGroup" id="tabgroup_4">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_4_visual-studio" role="tab" aria-controls="tabpanel_4_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_4_visual-studio-code" role="tab" aria-controls="tabpanel_4_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_4_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>Create a <em>Pages/Students</em> folder.</li>
<li>In <strong>Solution Explorer</strong>, right-click the <em>Pages/Students</em> folder and select <strong>Add</strong> &gt; <strong>New Scaffolded Item</strong>.</li>
<li>In the <strong>Add New Scaffold Item</strong> dialog:
<ul>
<li>In the left tab, select <strong>Installed &gt; Common &gt; Razor Pages</strong></li>
<li>Select <strong>Razor Pages using Entity Framework (CRUD)</strong> &gt; <strong>ADD</strong>.</li>
</ul>
</li>
<li>In the <strong>Add Razor Pages using Entity Framework (CRUD)</strong> dialog:
<ul>
<li>In the <strong>Model class</strong> drop-down, select <strong>Student (ContosoUniversity.Models)</strong>.</li>
<li>In the <strong>Data context class</strong> row, select the <strong>+</strong> (plus) sign.
<ul>
<li>Change the data context name to end in <code>SchoolContext</code> rather than <code>ContosoUniversityContext</code>. The updated context name: <code>ContosoUniversity.Data.SchoolContext</code></li>
<li>Select <strong>Add</strong> to finish adding the data context class.</li>
<li>Select <strong>Add</strong> to finish the <strong>Add Razor Pages</strong> dialog.</li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- If scaffolding fails with the error `'Install the package Microsoft.VisualStudio.Web.CodeGeneration.Design and try again.'`, run the scaffold tool again or see [this GitHub issue](https://github.com/dotnet/Scaffolding/issues/1540). -->
<p>The following packages are automatically installed:</p>
<ul>
<li><code>Microsoft.EntityFrameworkCore.SqlServer</code></li>
<li><code>Microsoft.EntityFrameworkCore.Tools</code></li>
<li><code>Microsoft.VisualStudio.Web.CodeGeneration.Design</code></li>
</ul>
</section>
<section id="tabpanel_4_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<ul>
<li><p>Run the following .NET CLI commands to install required NuGet packages:</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.EntityFrameworkCore.SQLite
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.EntityFrameworkCore.Tools
dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore
</code></pre>
<p>The <code>Microsoft.VisualStudio.Web.CodeGeneration.Design</code> package is required for scaffolding. Although the app won't use SQL Server, the scaffolding tool needs the SQL Server package.</p>
</li>
<li><p>Create a <em>Pages/Students</em> folder.</p>
</li>
<li><p>Run the following command to install the <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/tools/dotnet-aspnet-codegenerator?view=aspnetcore-9.0" data-linktype="relative-path">aspnet-codegenerator scaffolding tool</a>.</p>
<pre><code class="lang-dotnetcli">dotnet tool install --global dotnet-aspnet-codegenerator

</code></pre>
</li>
<li><p>Run the following command to scaffold Student pages.</p>
<p><strong>On Windows</strong></p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator razorpage -m Student -dc ContosoUniversity.Data.SchoolContext -udl -outDir Pages\Students --referenceScriptLibraries -sqlite  
</code></pre>
<p><strong>On macOS or Linux</strong></p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator razorpage -m Student -dc ContosoUniversity.Data.SchoolContext -udl -outDir Pages/Students --referenceScriptLibraries -dbProvider sqlite
</code></pre>
</li>
</ul>
</section>
</div>

<p>If the preceding step fails, build the project and retry the scaffold step.</p>
<p>The scaffolding process:</p>
<ul>
<li>Creates Razor pages in the <em>Pages/Students</em> folder:
<ul>
<li><code>Create.cshtml</code> and <code>Create.cshtml.cs</code></li>
<li><code>Delete.cshtml</code> and <code>Delete.cshtml.cs</code></li>
<li><code>Details.cshtml</code> and <code>Details.cshtml.cs</code></li>
<li><code>Edit.cshtml</code> and <code>Edit.cshtml.cs</code></li>
<li><code>Index.cshtml</code> and <code>Index.cshtml.cs</code></li>
</ul>
</li>
<li>Creates <code>Data/SchoolContext.cs</code>.</li>
<li>Adds the context to dependency injection in <code>Program.cs</code>.</li>
<li>Adds a database connection string to <code>appsettings.json</code>.</li>
</ul>
<h2 id="database-connection-string">Database connection string</h2>
<p>The scaffolding tool generates a connection string in the <code>appsettings.json</code> file.</p>
<div class="tabGroup" id="tabgroup_5">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_5_visual-studio" role="tab" aria-controls="tabpanel_5_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_5_visual-studio-code" role="tab" aria-controls="tabpanel_5_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_5_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>The connection string specifies <a href="https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/sql-server-2016-express-localdb" data-linktype="absolute-path">SQL Server LocalDB</a>:</p>
<pre><code class="lang-json" name="Main" highlight-lines="10">{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*",
  "ConnectionStrings": {
    "SchoolContext": "Server=(localdb)\\mssqllocaldb;Database=SchoolContext-0e9;Trusted_Connection=True;MultipleActiveResultSets=true"
  }
}
</code></pre>
<p>LocalDB is a lightweight version of the SQL Server Express Database Engine and is intended for app development, not production use. By default, LocalDB creates <em>.mdf</em> files in the <code>C:/Users/&lt;user&gt;</code> directory.</p>
</section>
<section id="tabpanel_5_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<p>Rename the connection string key to <code>SchoolContextSQLite</code> and shorten value to <code>CU.db</code>:</p>
<pre><code class="lang-json" name="Main" highlight-lines="10">{
  "DetailedErrors": true,
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "ConnectionStrings": {
    "SchoolContextSQLite": "Data Source=CU.db"
  },
  "MyMaxModelBindingCollectionSize": "3"
}
</code></pre>
<p>Don't change the directory without making sure it's valid.</p>
<p>Renaming the connection string key to <code>SchoolContextSQLite</code> helps the author maintain one sample that supports both the SQLlite and SQL Server.</p>
</section>
</div>
<h2 id="update-the-database-context-class">Update the database context class</h2>
<p>The main class that coordinates EF Core functionality for a given data model is the database context class. The context is derived from <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.dbcontext" class="no-loc" data-linktype="absolute-path">Microsoft.EntityFrameworkCore.DbContext</a>. The context specifies which entities are included in the data model. In this project, the class is named <code>SchoolContext</code>.</p>
<p>Update <code>Data/SchoolContext.cs</code> with the following code:</p>
<pre><code class="lang-csharp" name="Main" highlight-lines="13-22">using Microsoft.EntityFrameworkCore;
using ContosoUniversity.Models;

namespace ContosoUniversity.Data
{
    public class SchoolContext : DbContext
    {
        public SchoolContext (DbContextOptions&lt;SchoolContext&gt; options)
            : base(options)
        {
        }

        public DbSet&lt;Student&gt; Students { get; set; }
        public DbSet&lt;Enrollment&gt; Enrollments { get; set; }
        public DbSet&lt;Course&gt; Courses { get; set; }

        protected override void OnModelCreating(ModelBuilder modelBuilder)
        {
            modelBuilder.Entity&lt;Course&gt;().ToTable("Course");
            modelBuilder.Entity&lt;Enrollment&gt;().ToTable("Enrollment");
            modelBuilder.Entity&lt;Student&gt;().ToTable("Student");
        }
    }
}
</code></pre>
<p>The preceding code changes from the singular <code>DbSet&lt;Student&gt; Student</code> to the  plural <code>DbSet&lt;Student&gt; Students</code>. To make the Razor Pages code match the new <code>DBSet</code> name, make a global change from:
<code>_context.Student.</code>
to:
<code>_context.Students.</code></p>
<p>There are 8 occurrences.</p>
<p>Because an entity set contains multiple entities, many developers prefer the <code>DBSet</code> property names should be plural.</p>
<p>The highlighted code:</p>
<ul>
<li>Creates a <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.dbset-1" class="no-loc" data-linktype="absolute-path">DbSet&lt;TEntity&gt;</a> property for each entity set. In EF Core terminology:
<ul>
<li>An entity set typically corresponds to a database table.</li>
<li>An entity corresponds to a row in the table.</li>
</ul>
</li>
<li>Calls <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.dbcontext.onmodelcreating" class="no-loc" data-linktype="absolute-path">OnModelCreating</a>. <code>OnModelCreating</code>:
<ul>
<li>Is called when <code>SchoolContext</code> has been initialized but before the model has been secured and used to initialize the context.</li>
<li>Is required because later in the tutorial the <code>Student</code> entity will have references to the other entities.</li>
</ul>
<!-- Review, OnModelCreating needs review -->
</li>
</ul>
<p>We hope to <a href="https://github.com/dotnet/Scaffolding/issues/1594" data-linktype="external">fix this issue</a> in a future release.</p>
<h2 id="programcs">Program.cs</h2>
<p>ASP.NET Core is built with <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-9.0" data-linktype="relative-path">dependency injection</a>. Services such as the <code>SchoolContext</code> are registered with dependency injection during app startup. Components that require these services, such as Razor Pages, are provided these services via constructor parameters. The constructor code that gets a database context instance is shown later in the tutorial.</p>
<p>The scaffolding tool automatically registered the context class with the dependency injection container.</p>
<div class="tabGroup" id="tabgroup_6">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_6_visual-studio" role="tab" aria-controls="tabpanel_6_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_6_visual-studio-code" role="tab" aria-controls="tabpanel_6_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_6_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>The following highlighted lines were added by the scaffolder:</p>
<pre><code class="lang-csharp" name="Main" highlight-lines="1-2,7-8">using ContosoUniversity.Data;
using Microsoft.EntityFrameworkCore;
var builder = WebApplication.CreateBuilder(args);

builder.Services.AddRazorPages();

builder.Services.AddDbContext&lt;SchoolContext&gt;(options =&gt;
  options.UseSqlServer(builder.Configuration.GetConnectionString("SchoolContext")));
</code></pre></section>
<section id="tabpanel_6_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<p>Verify the code added by the scaffolder calls <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.sqlitedbcontextoptionsbuilderextensions.usesqlite" class="no-loc" data-linktype="absolute-path">UseSqlite</a>.</p>
<pre><code class="lang-csharp" name="Main" highlight-lines="1-2,7-8">using Microsoft.EntityFrameworkCore;
using ContosoUniversity.Data;
var builder = WebApplication.CreateBuilder(args);

builder.Services.AddRazorPages();

builder.Services.AddDbContext&lt;SchoolContext&gt;(options =&gt;
    options.UseSqlite(builder.Configuration.GetConnectionString("SchoolContextSQLite")));
</code></pre>
<p>See <a href="https://learn.microsoft.com/en-us/aspnet/core/tutorials/razor-pages/model?view=aspnetcore-9.0&amp;tabs=visual-studio-code#sqlite-ss-6" data-linktype="relative-path">Use SQLite for development, SQL Server for production</a> for information on using a production database.</p>
</section>
</div>

<p>The name of the connection string is passed in to the context by calling a method on a <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.dbcontextoptions" class="no-loc" data-linktype="absolute-path">DbContextOptions</a> object. For local development, the <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/configuration/?view=aspnetcore-9.0" data-linktype="relative-path">ASP.NET Core configuration system</a> reads the connection string from the <code>appsettings.json</code> or the <code>appsettings.Development.json</code> file.</p>
<p><a name="dbx"></a></p>
<h3 id="add-the-database-exception-filter">Add the database exception filter</h3>
<p>Add <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.extensions.dependencyinjection.databasedeveloperpageexceptionfilterserviceextensions.adddatabasedeveloperpageexceptionfilter" class="no-loc" data-linktype="absolute-path">AddDatabaseDeveloperPageExceptionFilter</a> and <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.builder.migrationsendpointextensions.usemigrationsendpoint" class="no-loc" data-linktype="absolute-path">UseMigrationsEndPoint</a> as shown in the following code:</p>
<div class="tabGroup" id="tabgroup_7">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_7_visual-studio" role="tab" aria-controls="tabpanel_7_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_7_visual-studio-code" role="tab" aria-controls="tabpanel_7_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_7_visual-studio" role="tabpanel" data-tab="visual-studio">
<pre><code class="lang-csharp" name="Main" highlight-lines="10,18-23">using ContosoUniversity.Data;
using Microsoft.EntityFrameworkCore;
var builder = WebApplication.CreateBuilder(args);

builder.Services.AddRazorPages();

builder.Services.AddDbContext&lt;SchoolContext&gt;(options =&gt;
  options.UseSqlServer(builder.Configuration.GetConnectionString("SchoolContext")));

builder.Services.AddDatabaseDeveloperPageExceptionFilter();

var app = builder.Build();

if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Error");
    app.UseHsts();
}
else
{
    app.UseDeveloperExceptionPage();
    app.UseMigrationsEndPoint();
}
</code></pre>
<p>Add the <a href="https://www.nuget.org/packages/Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore" data-linktype="external">Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore</a> NuGet package.</p>
<p>In the Package Manager Console, enter the following to add the NuGet package:</p>
<pre><code class="lang-powershell">Install-Package Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore
</code></pre>
</section>
<section id="tabpanel_7_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">
<pre><code class="lang-csharp" name="Main" highlight-lines="10,18-23">using Microsoft.EntityFrameworkCore;
using ContosoUniversity.Data;
var builder = WebApplication.CreateBuilder(args);

builder.Services.AddRazorPages();

builder.Services.AddDbContext&lt;SchoolContext&gt;(options =&gt;
    options.UseSqlite(builder.Configuration.GetConnectionString("SchoolContextSQLite")));

builder.Services.AddDatabaseDeveloperPageExceptionFilter();

var app = builder.Build();

if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Error");
    app.UseHsts();
}
else
{
    app.UseDeveloperExceptionPage();
    app.UseMigrationsEndPoint();
}
</code></pre></section>
</div>

<p>The <code>Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore</code> NuGet package provides ASP.NET Core middleware for Entity Framework Core error pages. This middleware helps to detect and diagnose errors with Entity Framework Core migrations.</p>
<p>The <code>AddDatabaseDeveloperPageExceptionFilter</code> provides helpful error information in the <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/environments?view=aspnetcore-9.0" data-linktype="relative-path">development environment</a> for EF migrations errors.</p>
<h2 id="create-the-database">Create the database</h2>
<p>Update <code>Program.cs</code> to create the database if it doesn't exist:</p>
<div class="tabGroup" id="tabgroup_8">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_8_visual-studio" role="tab" aria-controls="tabpanel_8_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_8_visual-studio-code" role="tab" aria-controls="tabpanel_8_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_8_visual-studio" role="tabpanel" data-tab="visual-studio">
<!-- make a copy of Program.cs to ProgramEnsure.cs with // DbInitializer.Initialize(context); commented out -->
<pre><code class="lang-csharp" name="Main" highlight-lines="25-32">using ContosoUniversity.Data;
using Microsoft.EntityFrameworkCore;
var builder = WebApplication.CreateBuilder(args);

builder.Services.AddRazorPages();

builder.Services.AddDbContext&lt;SchoolContext&gt;(options =&gt;
  options.UseSqlServer(builder.Configuration.GetConnectionString("SchoolContext")));

builder.Services.AddDatabaseDeveloperPageExceptionFilter();

var app = builder.Build();

if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Error");
    app.UseHsts();
}
else
{
    app.UseDeveloperExceptionPage();
    app.UseMigrationsEndPoint();
}

using (var scope = app.Services.CreateScope())
{
    var services = scope.ServiceProvider;

    var context = services.GetRequiredService&lt;SchoolContext&gt;();
    context.Database.EnsureCreated();
    // DbInitializer.Initialize(context);
}

app.UseHttpsRedirection();
app.UseStaticFiles();

app.UseRouting();

app.UseAuthorization();

app.MapRazorPages();

app.Run();
</code></pre></section>
<section id="tabpanel_8_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">
<pre><code class="lang-csharp" name="Main" highlight-lines="25-32">using Microsoft.EntityFrameworkCore;
using ContosoUniversity.Data;
var builder = WebApplication.CreateBuilder(args);

builder.Services.AddRazorPages();

builder.Services.AddDbContext&lt;SchoolContext&gt;(options =&gt;
    options.UseSqlite(builder.Configuration.GetConnectionString("SchoolContextSQLite")));

builder.Services.AddDatabaseDeveloperPageExceptionFilter();

var app = builder.Build();

if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Error");
    app.UseHsts();
}
else
{
    app.UseDeveloperExceptionPage();
    app.UseMigrationsEndPoint();
}

using (var scope = app.Services.CreateScope())
{
    var services = scope.ServiceProvider;

    var context = services.GetRequiredService&lt;SchoolContext&gt;();
    context.Database.EnsureCreated();
    // DbInitializer.Initialize(context);
}

app.UseHttpsRedirection();
app.UseStaticFiles();

app.UseRouting();

app.UseAuthorization();

app.MapRazorPages();

app.Run();
</code></pre></section>
</div>

<p>The <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.infrastructure.databasefacade.ensurecreated" class="no-loc" data-linktype="absolute-path">EnsureCreated</a> method takes no action if a database for the context exists. If no database exists, it creates the database and schema. <code>EnsureCreated</code> enables the following workflow for handling data model changes:</p>
<ul>
<li>Delete the database. Any existing data is lost.</li>
<li>Change the data model. For example, add an <code>EmailAddress</code> field.</li>
<li>Run the app.</li>
<li><code>EnsureCreated</code> creates a database with the new schema.</li>
</ul>
<p>This workflow works early in development when the schema is rapidly evolving, as long as data doesn't need to be preserved. The situation is different when data that has been entered into the database needs to be preserved. When that is the case, use migrations.</p>
<p>Later in the tutorial series, the database is deleted that was created by <code>EnsureCreated</code> and migrations is used. A database that is created by <code>EnsureCreated</code> can't be updated by using migrations.</p>
<h3 id="test-the-app">Test the app</h3>
<ul>
<li>Run the app.</li>
<li>Select the <strong>Students</strong> link and then <strong>Create New</strong>.</li>
<li>Test the Edit, Details, and Delete links.</li>
</ul>
<h2 id="seed-the-database">Seed the database</h2>
<p>The <code>EnsureCreated</code> method creates an empty database. This section adds code that populates the database with test data.</p>
<p>Create <code>Data/DbInitializer.cs</code> with the following code:</p>
<pre><code class="lang-csharp" name="Main">using ContosoUniversity.Models;

namespace ContosoUniversity.Data
{
    public static class DbInitializer
    {
        public static void Initialize(SchoolContext context)
        {
            // Look for any students.
            if (context.Students.Any())
            {
                return;   // DB has been seeded
            }

            var students = new Student[]
            {
                new Student{FirstMidName="Carson",LastName="Alexander",EnrollmentDate=DateTime.Parse("2019-09-01")},
                new Student{FirstMidName="Meredith",LastName="Alonso",EnrollmentDate=DateTime.Parse("2017-09-01")},
                new Student{FirstMidName="Arturo",LastName="Anand",EnrollmentDate=DateTime.Parse("2018-09-01")},
                new Student{FirstMidName="Gytis",LastName="Barzdukas",EnrollmentDate=DateTime.Parse("2017-09-01")},
                new Student{FirstMidName="Yan",LastName="Li",EnrollmentDate=DateTime.Parse("2017-09-01")},
                new Student{FirstMidName="Peggy",LastName="Justice",EnrollmentDate=DateTime.Parse("2016-09-01")},
                new Student{FirstMidName="Laura",LastName="Norman",EnrollmentDate=DateTime.Parse("2018-09-01")},
                new Student{FirstMidName="Nino",LastName="Olivetto",EnrollmentDate=DateTime.Parse("2019-09-01")}
            };

            context.Students.AddRange(students);
            context.SaveChanges();

            var courses = new Course[]
            {
                new Course{CourseID=1050,Title="Chemistry",Credits=3},
                new Course{CourseID=4022,Title="Microeconomics",Credits=3},
                new Course{CourseID=4041,Title="Macroeconomics",Credits=3},
                new Course{CourseID=1045,Title="Calculus",Credits=4},
                new Course{CourseID=3141,Title="Trigonometry",Credits=4},
                new Course{CourseID=2021,Title="Composition",Credits=3},
                new Course{CourseID=2042,Title="Literature",Credits=4}
            };

            context.Courses.AddRange(courses);
            context.SaveChanges();

            var enrollments = new Enrollment[]
            {
                new Enrollment{StudentID=1,CourseID=1050,Grade=Grade.A},
                new Enrollment{StudentID=1,CourseID=4022,Grade=Grade.C},
                new Enrollment{StudentID=1,CourseID=4041,Grade=Grade.B},
                new Enrollment{StudentID=2,CourseID=1045,Grade=Grade.B},
                new Enrollment{StudentID=2,CourseID=3141,Grade=Grade.F},
                new Enrollment{StudentID=2,CourseID=2021,Grade=Grade.F},
                new Enrollment{StudentID=3,CourseID=1050},
                new Enrollment{StudentID=4,CourseID=1050},
                new Enrollment{StudentID=4,CourseID=4022,Grade=Grade.F},
                new Enrollment{StudentID=5,CourseID=4041,Grade=Grade.C},
                new Enrollment{StudentID=6,CourseID=1045},
                new Enrollment{StudentID=7,CourseID=3141,Grade=Grade.A},
            };

            context.Enrollments.AddRange(enrollments);
            context.SaveChanges();
        }
    }
}
</code></pre>
<p>The code checks if there are any students in the database. If there are no students, it adds test data to the database. It creates the test data in arrays rather than <code>List&lt;T&gt;</code> collections to optimize performance.</p>
<ul>
<li>In <code>Program.cs</code>, remove <code>//</code> from the <code>DbInitializer.Initialize</code> line:</li>
</ul>
<pre><code class="lang-csharp" name="Main" highlight-lines="7">using (var scope = app.Services.CreateScope())
{
    var services = scope.ServiceProvider;

    var context = services.GetRequiredService&lt;SchoolContext&gt;();
    context.Database.EnsureCreated();
    DbInitializer.Initialize(context);
}
</code></pre><div class="tabGroup" id="tabgroup_9">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_9_visual-studio" role="tab" aria-controls="tabpanel_9_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_9_visual-studio-code" role="tab" aria-controls="tabpanel_9_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_9_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li><p>Stop the app if it's running, and run the following command in the <strong>Package Manager Console</strong> (PMC):</p>
<pre><code class="lang-powershell">Drop-Database -Confirm

</code></pre>
</li>
<li><p>Respond with <code>Y</code> to delete the database.</p>
</li>
</ul>
</section>
<section id="tabpanel_9_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<ul>
<li>Stop the app if it's running, and delete the <code>CU.db</code> file.</li>
</ul>
</section>
</div>

<ul>
<li>Restart the app.</li>
<li>Select the Students page to see the seeded data.</li>
</ul>
<h2 id="view-the-database">View the database</h2>
<div class="tabGroup" id="tabgroup_10">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_10_visual-studio" role="tab" aria-controls="tabpanel_10_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_10_visual-studio-code" role="tab" aria-controls="tabpanel_10_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_10_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>Open <strong>SQL Server Object Explorer</strong> (SSOX) from the <strong>View</strong> menu in Visual Studio.</li>
<li>In SSOX, select <strong>(localdb)\MSSQLLocalDB &gt; Databases &gt; SchoolContext-{GUID}</strong>. The database name is generated from the context name provided earlier plus a dash and a GUID.</li>
<li>Expand the <strong>Tables</strong> node.</li>
<li>Right-click the <strong>Student</strong> table and click <strong>View Data</strong> to see the columns created and the rows inserted into the table.</li>
<li>Right-click the <strong>Student</strong> table and click <strong>View Code</strong> to see how the <code>Student</code> model maps to the <code>Student</code> table schema.</li>
</ul>
</section>
<section id="tabpanel_10_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<p>Use a SQLite tool to view the database schema and seeded data. The database file is named <code>CU.db</code> and is located in the project folder.</p>
</section>
</div>
<h2 id="asynchronous-ef-methods-in-aspnet-core-web-apps">Asynchronous EF methods in ASP.NET Core web apps</h2>
<p>Asynchronous programming is the default mode for ASP.NET Core and EF Core.</p>
<p>A web server has a limited number of threads available, and in high load situations all of the available threads might be in use. When that happens, the server can't process new requests until the threads are freed up. With synchronous code, many threads may be tied up while they aren't doing work because they're waiting for I/O to complete. With asynchronous code, when a process is waiting for I/O to complete, its thread is freed up for the server to use for processing other requests. As a result, asynchronous code enables server resources to be used more efficiently, and the server can handle more traffic without delays.</p>
<p>Asynchronous code does introduce a small amount of overhead at run time. For low traffic situations, the performance hit is negligible, while for high traffic situations, the potential performance improvement is substantial.</p>
<p>In the following code, the <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/async" data-linktype="absolute-path">async</a> keyword, <code>Task</code> return value, <code>await</code> keyword, and <code>ToListAsync</code> method make the code execute asynchronously.</p>
<pre><code class="lang-csharp">public async Task OnGetAsync()
{
    Students = await _context.Students.ToListAsync();
}
</code></pre>
<ul>
<li>The <code>async</code> keyword tells the compiler to:
<ul>
<li>Generate callbacks for parts of the method body.</li>
<li>Create the <a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/async/async-return-types#BKMK_TaskReturnType" data-linktype="absolute-path">Task</a> object that's returned.</li>
</ul>
</li>
<li>The <code>Task</code> return type represents ongoing work.</li>
<li>The <code>await</code> keyword causes the compiler to split the method into two parts. The first part ends with the operation that's started asynchronously. The second part is put into a callback method that's called when the operation completes.</li>
<li><code>ToListAsync</code> is the asynchronous version of the <code>ToList</code> extension method.</li>
</ul>
<p>Some things to be aware of when writing asynchronous code that uses EF Core:</p>
<ul>
<li>Only statements that cause queries or commands to be sent to the database are executed asynchronously. That includes <code>ToListAsync</code>, <code>SingleOrDefaultAsync</code>, <code>FirstOrDefaultAsync</code>, and <code>SaveChangesAsync</code>. It doesn't include statements that just change an <code>IQueryable</code>, such as <code>var students = context.Students.Where(s =&gt; s.LastName == "Davolio")</code>.</li>
<li>An EF Core context isn't thread safe: don't try to do multiple operations in parallel.</li>
<li>To take advantage of the performance benefits of async code, verify that library packages (such as for paging) use async if they call EF Core methods that send queries to the database.</li>
</ul>
<p>For more information about asynchronous programming in .NET, see <a href="https://learn.microsoft.com/en-us/dotnet/standard/async" data-linktype="absolute-path">Async Overview</a> and <a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/async/" data-linktype="absolute-path">Asynchronous programming with async and await</a>.</p>
<div class="WARNING">
<p>Warning</p>
<p>The async implementation of <a href="https://github.com/dotnet/SqlClient" data-linktype="external">Microsoft.Data.SqlClient</a> has some known issues (<a href="https://github.com/dotnet/SqlClient/issues/593" data-linktype="external">#593</a>, <a href="https://github.com/dotnet/SqlClient/issues/601" data-linktype="external">#601</a>, and others). If you're seeing unexpected performance problems, try using sync command execution instead, especially when dealing with large text or binary values.</p>
</div>
<!-- Review: See https://github.com/dotnet/AspNetCore.Docs/issues/14528 -->
<h2 id="performance-considerations">Performance considerations</h2>
<p>In general, a web page shouldn't be loading an arbitrary number of rows. A query should use paging or a limiting approach. For example, the preceding query could use <code>Take</code> to limit the rows returned:</p>
<pre><code class="lang-csharp" name="Main">public async Task OnGetAsync()
{
    Student = await _context.Students.Take(10).ToListAsync();
}
</code></pre>
<p>Enumerating a large table in a view could return a partially constructed HTTP 200 response if a database exception occurs part way through the enumeration.</p>
<p>Paging is covered later in the tutorial.</p>
<p>For more information, see <a href="https://learn.microsoft.com/en-us/ef/core/performance" data-linktype="absolute-path">Performance considerations (EF)</a>.</p>
<h2 id="next-steps">Next steps</h2>
<p><a href="https://learn.microsoft.com/en-us/aspnet/core/tutorials/razor-pages/model?view=aspnetcore-9.0&amp;tabs=visual-studio-code#use-sqlite-for-development-sql-server-for-production" data-linktype="relative-path">Use SQLite for development, SQL Server for production</a></p>
<div class="step-by-step">
<p><a href="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/crud?view=aspnetcore-9.0" data-linktype="relative-path">Next tutorial</a></p>
</div>
</div>
<div data-moniker="aspnetcore-5.0">
<p>This is the first in a series of tutorials that show how to use Entity Framework (EF) Core in an <a href="../../razor-pages/index553c.html?view=aspnetcore-9.0" data-linktype="relative-path">ASP.NET Core Razor Pages</a> app. The tutorials build a web site for a fictional Contoso University. The site includes functionality such as student admission, course creation, and instructor assignments. The tutorial uses the code first approach. For information on following this tutorial using the database first approach, see <a href="https://github.com/dotnet/AspNetCore.Docs/issues/16897" data-linktype="external">this Github issue</a>.</p>
<p><a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/data/ef-rp/intro/samples/cu50" data-linktype="external">Download or view the completed app.</a> <a href="../../overview553c.html?view=aspnetcore-9.0#how-to-download-a-sample" data-linktype="relative-path">Download instructions</a>.</p>
<h2 id="prerequisites-1">Prerequisites</h2>
<ul>
<li>If you're new to Razor Pages, go through the <a href="../../tutorials/razor-pages/razor-pages-start553c.html?view=aspnetcore-9.0" data-linktype="relative-path">Get started with Razor Pages</a> tutorial series before starting this one.</li>
</ul>
<div class="tabGroup" id="tabgroup_11">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_11_visual-studio" role="tab" aria-controls="tabpanel_11_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_11_visual-studio-code" role="tab" aria-controls="tabpanel_11_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_11_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li><p><a href="https://visualstudio.microsoft.com/downloads/" data-linktype="external">Visual Studio 2022</a> with the <strong>ASP.NET and web development</strong> workload.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/tutorials/min-web-api/_static/asp-net-web-dev.png?view=aspnetcore-9.0" alt="VS22 installer workloads" data-linktype="relative-path"></p>
</li>
</ul>
<h3 id="database-engines-2">Database engines</h3>
<p>The Visual Studio instructions use <a href="https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/sql-server-2016-express-localdb" data-linktype="absolute-path">SQL Server LocalDB</a>, a version of SQL Server Express that runs only on Windows.</p>
</section>
<section id="tabpanel_11_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<ul>
<li><a href="https://code.visualstudio.com/download" data-linktype="external">Visual Studio Code</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=ms-dotnettools.csdevkit" data-linktype="external">C# Dev Kit for Visual Studio Code</a></li>
<li><a href="https://dotnet.microsoft.com/download/dotnet-core" data-linktype="external">Latest released .NET Core SDK</a></li>
</ul>
<p>You can follow the Visual Studio Code instructions on macOS, Linux, or Windows. Changes may be required if you use an integrated development environment (IDE) other than Visual Studio Code.</p>
<p>Consider downloading and installing a third-party tool for managing and viewing a SQLite database, such as <a href="https://sqlitebrowser.org/" data-linktype="external">DB Browser for SQLite</a>.</p>
<h3 id="database-engines-3">Database engines</h3>
<p>The Visual Studio Code tab use <a href="https://www.sqlite.org/" data-linktype="external">SQLite</a>, a cross-platform database engine.</p>
</section>
</div>
<h3 id="troubleshooting-1">Troubleshooting</h3>
<p>If you run into a problem you can't resolve, compare your code to the <a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/data/ef-rp/intro/samples" data-linktype="external">completed project</a>. A good way to get help is by posting a question to StackOverflow.com, using the <a href="https://stackoverflow.com/questions/tagged/asp.net-core" data-linktype="external">ASP.NET Core tag</a> or the <a href="https://stackoverflow.com/questions/tagged/entity-framework-core" data-linktype="external">EF Core tag</a>.</p>
<h3 id="the-sample-app-1">The sample app</h3>
<p>The app built in these tutorials is a basic university web site. Users can view and update student, course, and instructor information. Here are a few of the screens created in the tutorial.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/students-index30.png?view=aspnetcore-9.0" alt="Students Index page" data-linktype="relative-path"></p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/student-edit30.png?view=aspnetcore-9.0" alt="Students Edit page" data-linktype="relative-path"></p>
<p>The UI style of this site is based on the built-in project templates. The tutorial's focus is on how to use EF Core with ASP.NET Core, not how to customize the UI.</p>
<p><a name="build"></a></p>
<h3 id="optional-build-the-sample-download-1">Optional: Build the sample download</h3>
<p>This step is optional. Building the completed app is recommended when you have problems you can't solve. If you run into a problem you can't resolve, compare your code to the <a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/data/ef-rp/intro/samples/cu50" data-linktype="external">completed project</a>. <a href="../../overview553c.html?view=aspnetcore-9.0#how-to-download-a-sample" data-linktype="relative-path">Download instructions</a>.</p>
<div class="tabGroup" id="tabgroup_12">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_12_visual-studio" role="tab" aria-controls="tabpanel_12_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_12_visual-studio-code" role="tab" aria-controls="tabpanel_12_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_12_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>Select <code>ContosoUniversity.csproj</code> to open the project.</p>
<ul>
<li>Build the project.</li>
<li>In Package Manager Console (PMC) run the following command:</li>
</ul>
<pre><code class="lang-powershell">Update-Database
</code></pre>
</section>
<section id="tabpanel_12_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<ul>
<li><p>Remove the comments from the <code>ContosoUniversity.csproj</code> file so <code>SQLiteVersion</code> is defined:</p>
<pre><code class="lang-xml">&lt;PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|AnyCPU'"&gt;
  &lt;DefineConstants&gt;TRACE;SQLiteVersion&lt;/DefineConstants&gt;
&lt;/PropertyGroup&gt;
</code></pre>
</li>
<li><p>In a command window, update the database:</p>
<pre><code class="lang-dotnetcli">dotnet tool install --global dotnet-ef
dotnet ef database update

</code></pre>
</li>
</ul>
<!-- prerelease versions require
  dotnet tool uninstall --global dotnet-ef
-->
</section>
</div>

<p>Run the project to seed the database.</p>
<h2 id="create-the-web-app-project-1">Create the web app project</h2>
<div class="tabGroup" id="tabgroup_13">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_13_visual-studio" role="tab" aria-controls="tabpanel_13_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_13_visual-studio-code" role="tab" aria-controls="tabpanel_13_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_13_visual-studio" role="tabpanel" data-tab="visual-studio">

<ol>
<li>Start Visual Studio and select <strong>Create a new project</strong>.</li>
<li>In the <strong>Create a new project</strong> dialog, select <strong>ASP.NET Core Web Application</strong> &gt; <strong>Next</strong>.</li>
<li>In the <strong>Configure your new project</strong> dialog, enter <code>ContosoUniversity</code> for <strong>Project name</strong>. It's important to use this exact name including capitalization, so each <code>namespace</code> matches when code is copied.</li>
<li>Select <strong>Create</strong>.</li>
<li>In the <strong>Create a new ASP.NET Core web application</strong> dialog, select:
<ol>
<li><strong>.NET Core</strong> and <strong>ASP.NET Core 5.0</strong> in the dropdowns.</li>
<li><strong>ASP.NET Core Web App</strong>.</li>
<li><strong>Create</strong>
<img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/new-aspnet5.png?view=aspnetcore-9.0" alt="New ASP.NET Core Project dialog" data-linktype="relative-path"></li>
</ol>
</li>
</ol>
</section>
<section id="tabpanel_13_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<ul>
<li><p>In a terminal, navigate to the folder in which the project folder should be created.</p>
</li>
<li><p>Run the following commands to create a Razor Pages project and <code>cd</code> into the new project folder:</p>
<pre><code class="lang-dotnetcli">dotnet new webapp -o ContosoUniversity
cd ContosoUniversity  
</code></pre>
</li>
</ul>
</section>
</div>
<h2 id="set-up-the-site-style-1">Set up the site style</h2>
<p>Copy and paste the following code into the <code>Pages/Shared/_Layout.cshtml</code> file:</p>
<pre><code class="lang-cshtml" name="Main" highlight-lines="6,14,21-35,49">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
    &lt;title&gt;@ViewData["Title"] - Contoso University&lt;/title&gt;
    &lt;link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.css" /&gt;
    &lt;link rel="stylesheet" href="~/css/site.css" /&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;header&gt;
        &lt;nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3"&gt;
            &lt;div class="container"&gt;
                &lt;a class="navbar-brand" asp-area="" asp-page="/Index"&gt;Contoso University&lt;/a&gt;
                &lt;button class="navbar-toggler" type="button" data-toggle="collapse" data-target=".navbar-collapse" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation"&gt;
                    &lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;
                &lt;/button&gt;
                &lt;div class="navbar-collapse collapse d-sm-inline-flex flex-sm-row-reverse"&gt;
                    &lt;ul class="navbar-nav flex-grow-1"&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" asp-area="" asp-page="/About"&gt;About&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" asp-area="" asp-page="/Students/Index"&gt;Students&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" asp-area="" asp-page="/Courses/Index"&gt;Courses&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" asp-area="" asp-page="/Instructors/Index"&gt;Instructors&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" asp-area="" asp-page="/Departments/Index"&gt;Departments&lt;/a&gt;
                        &lt;/li&gt;
                    &lt;/ul&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/nav&gt;
    &lt;/header&gt;
    &lt;div class="container"&gt;
        &lt;main role="main" class="pb-3"&gt;
            @RenderBody()
        &lt;/main&gt;
    &lt;/div&gt;

    &lt;footer class="border-top footer text-muted"&gt;
        &lt;div class="container"&gt;
            &amp;copy; 2021 - Contoso University - &lt;a asp-area="" asp-page="/Privacy"&gt;Privacy&lt;/a&gt;
        &lt;/div&gt;
    &lt;/footer&gt;

    &lt;script src="~/lib/jquery/dist/jquery.js"&gt;&lt;/script&gt;
    &lt;script src="~/lib/bootstrap/dist/js/bootstrap.bundle.js"&gt;&lt;/script&gt;
    &lt;script src="~/js/site.js" asp-append-version="true"&gt;&lt;/script&gt;

    @RenderSection("Scripts", required: false)
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>The layout file sets the site header, footer, and menu. The preceding code makes the following changes:</p>
<ul>
<li>Each occurrence of "ContosoUniversity" to "Contoso University". There are three occurrences.</li>
<li>The <strong>Home</strong> and <strong>Privacy</strong> menu entries are deleted.</li>
<li>Entries are added for <strong>About</strong>, <strong>Students</strong>, <strong>Courses</strong>, <strong>Instructors</strong>, and <strong>Departments</strong>.</li>
</ul>
<p>In <code>Pages/Index.cshtml</code>, replace the contents of the file with the following code:</p>
<pre><code class="lang-cshtml" name="Main">@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

&lt;div class="row mb-auto"&gt;
    &lt;div class="col-md-4"&gt;
        &lt;div class="row no-gutters border mb-4"&gt;
            &lt;div class="col p-4 mb-4 "&gt;
                &lt;p class="card-text"&gt;
                    Contoso University is a sample application that
                    demonstrates how to use Entity Framework Core in an
                    ASP.NET Core Razor Pages web app.
                &lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="col-md-4"&gt;
        &lt;div class="row no-gutters border mb-4"&gt;
            &lt;div class="col p-4 d-flex flex-column position-static"&gt;
                &lt;p class="card-text mb-auto"&gt;
                    You can build the application by following the steps in a series of tutorials.
                &lt;/p&gt;
                &lt;p&gt;
                    &lt;a href="https://docs.microsoft.com/aspnet/core/data/ef-rp/intro" class="stretched-link"&gt;See the tutorial&lt;/a&gt;
                &lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="col-md-4"&gt;
        &lt;div class="row no-gutters border mb-4"&gt;
            &lt;div class="col p-4 d-flex flex-column"&gt;
                &lt;p class="card-text mb-auto"&gt;
                    You can download the completed project from GitHub.
                &lt;/p&gt;
                &lt;p&gt;
                    &lt;a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/data/ef-rp/intro/samples" class="stretched-link"&gt;See project source code&lt;/a&gt;
                &lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

</code></pre>
<p>The preceding code replaces the text about ASP.NET Core with text about this app.</p>
<p>Run the app to verify that the home page appears.</p>
<h2 id="the-data-model-1">The data model</h2>
<p>The following sections create a data model:</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/data-model-diagram.png?view=aspnetcore-9.0" alt="Course-Enrollment-Student data model diagram" data-linktype="relative-path"></p>
<p>A student can enroll in any number of courses, and a course can have any number of students enrolled in it.</p>
<h2 id="the-student-entity-1">The Student entity</h2>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/student-entity.png?view=aspnetcore-9.0" alt="Student entity diagram" data-linktype="relative-path"></p>
<ul>
<li><p>Create a <em>Models</em> folder in the project folder.</p>
</li>
<li><p>Create <code>Models/Student.cs</code> with the following code:</p>
<pre><code class="lang-csharp" name="Main">using System;
using System.Collections.Generic;

namespace ContosoUniversity.Models
{
    public class Student
    {
        public int ID { get; set; }
        public string LastName { get; set; }
        public string FirstMidName { get; set; }
        public DateTime EnrollmentDate { get; set; }

        public ICollection&lt;Enrollment&gt; Enrollments { get; set; }
    }
}
</code></pre></li>
</ul>
<p>The <code>ID</code> property becomes the primary key column of the database table that corresponds to this class. By default, EF Core interprets a property that's named <code>ID</code> or <code>classnameID</code> as the primary key. So the alternative automatically recognized name for the <code>Student</code> class primary key is <code>StudentID</code>. For more information, see <a href="https://learn.microsoft.com/en-us/ef/core/modeling/keys?tabs=data-annotations" data-linktype="absolute-path">EF Core - Keys</a>.</p>
<p>The <code>Enrollments</code> property is a <a href="https://learn.microsoft.com/en-us/ef/core/modeling/relationships" data-linktype="absolute-path">navigation property</a>. Navigation properties hold other entities that are related to this entity. In this case, the <code>Enrollments</code> property of a <code>Student</code> entity holds all of the <code>Enrollment</code> entities that are related to that Student. For example, if a Student row in the database has two related Enrollment rows, the <code>Enrollments</code> navigation property contains those two Enrollment entities.</p>
<p>In the database, an Enrollment row is related to a Student row if its <code>StudentID</code> column contains the student's ID value. For example, suppose a Student row has ID=1. Related Enrollment rows will have <code>StudentID</code> = 1. <code>StudentID</code> is a <em>foreign key</em> in the Enrollment table.</p>
<p>The <code>Enrollments</code> property is defined as <code>ICollection&lt;Enrollment&gt;</code> because there may be multiple related Enrollment entities. Other collection types can be used, such as <code>List&lt;Enrollment&gt;</code> or <code>HashSet&lt;Enrollment&gt;</code>. When <code>ICollection&lt;Enrollment&gt;</code> is used, EF Core creates a <code>HashSet&lt;Enrollment&gt;</code> collection by default.</p>
<h2 id="the-enrollment-entity-1">The Enrollment entity</h2>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/enrollment-entity.png?view=aspnetcore-9.0" alt="Enrollment entity diagram" data-linktype="relative-path"></p>
<p>Create <code>Models/Enrollment.cs</code> with the following code:</p>
<pre><code class="lang-csharp">using System.ComponentModel.DataAnnotations;

namespace ContosoUniversity.Models
{
    public enum Grade
    {
        A, B, C, D, F
    }

    public class Enrollment
    {
        public int EnrollmentID { get; set; }
        public int CourseID { get; set; }
        public int StudentID { get; set; }
        [DisplayFormat(NullDisplayText = "No grade")]
        public Grade? Grade { get; set; }

        public Course Course { get; set; }
        public Student Student { get; set; }
    }
}
</code></pre>
<p>The <code>EnrollmentID</code> property is the primary key; this entity uses the <code>classnameID</code> pattern instead of <code>ID</code> by itself. For a production data model, many developers choose one pattern and use it consistently. This tutorial uses both just to illustrate that both work. Using <code>ID</code> without <code>classname</code> makes it easier to implement some kinds of data model changes.</p>
<p>The <code>Grade</code> property is an <code>enum</code>. The question mark after the <code>Grade</code> type declaration indicates that the <code>Grade</code> property is <a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/nullable-types/" data-linktype="absolute-path">nullable</a>. A grade that's null is different from a zero grade—null means a grade isn't known or hasn't been assigned yet.</p>
<p>The <code>StudentID</code> property is a foreign key, and the corresponding navigation property is <code>Student</code>. An <code>Enrollment</code> entity is associated with one <code>Student</code> entity, so the property contains a single <code>Student</code> entity.</p>
<p>The <code>CourseID</code> property is a foreign key, and the corresponding navigation property is <code>Course</code>. An <code>Enrollment</code> entity is associated with one <code>Course</code> entity.</p>
<p>EF Core interprets a property as a foreign key if it's named <code>&lt;navigation property name&gt;&lt;primary key property name&gt;</code>. For example,<code>StudentID</code> is the foreign key for the <code>Student</code> navigation property, since the <code>Student</code> entity's primary key is <code>ID</code>. Foreign key properties can also be named <code>&lt;primary key property name&gt;</code>. For example, <code>CourseID</code> since the <code>Course</code> entity's primary key is <code>CourseID</code>.</p>
<h2 id="the-course-entity-1">The Course entity</h2>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/course-entity.png?view=aspnetcore-9.0" alt="Course entity diagram" data-linktype="relative-path"></p>
<p>Create <code>Models/Course.cs</code> with the following code:</p>
<pre><code class="lang-csharp" name="Main">using System.Collections.Generic;
using System.ComponentModel.DataAnnotations.Schema;

namespace ContosoUniversity.Models
{
    public class Course
    {
        [DatabaseGenerated(DatabaseGeneratedOption.None)]
        public int CourseID { get; set; }
        public string Title { get; set; }
        public int Credits { get; set; }

        public ICollection&lt;Enrollment&gt; Enrollments { get; set; }
    }
}
</code></pre>
<p>The <code>Enrollments</code> property is a navigation property. A <code>Course</code> entity can be related to any number of <code>Enrollment</code> entities.</p>
<p>The <code>DatabaseGenerated</code> attribute allows the app to specify the primary key rather than having the database generate it.</p>
<p>Build the project to validate that there are no compiler errors.</p>
<h2 id="scaffold-student-pages-1">Scaffold Student pages</h2>
<p>In this section, the ASP.NET Core scaffolding tool is used to generate:</p>
<ul>
<li>An EF Core <code>DbContext</code> class. The context is the main class that coordinates Entity Framework functionality for a given data model. It derives from the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.dbcontext" class="no-loc" data-linktype="absolute-path">Microsoft.EntityFrameworkCore.DbContext</a> class.</li>
<li>Razor pages that handle Create, Read, Update, and Delete (CRUD) operations for the <code>Student</code> entity.</li>
</ul>
<div class="tabGroup" id="tabgroup_14">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_14_visual-studio" role="tab" aria-controls="tabpanel_14_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_14_visual-studio-code" role="tab" aria-controls="tabpanel_14_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_14_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>Create a <em>Pages/Students</em> folder.</li>
<li>In <strong>Solution Explorer</strong>, right-click the <em>Pages/Students</em> folder and select <strong>Add</strong> &gt; <strong>New Scaffolded Item</strong>.</li>
<li>In the <strong>Add New Scaffold Item</strong> dialog:
<ul>
<li>In the left tab, select <strong>Installed &gt; Common &gt; Razor Pages</strong></li>
<li>Select <strong>Razor Pages using Entity Framework (CRUD)</strong> &gt; <strong>ADD</strong>.</li>
</ul>
</li>
<li>In the <strong>Add Razor Pages using Entity Framework (CRUD)</strong> dialog:
<ul>
<li>In the <strong>Model class</strong> drop-down, select <strong>Student (ContosoUniversity.Models)</strong>.</li>
<li>In the <strong>Data context class</strong> row, select the <strong>+</strong> (plus) sign.
<ul>
<li>Change the data context name to end in <code>SchoolContext</code> rather than <code>ContosoUniversityContext</code>. The updated context name: <code>ContosoUniversity.Data.SchoolContext</code></li>
<li>Select <strong>Add</strong> to finish adding the data context class.</li>
<li>Select <strong>Add</strong> to finish the <strong>Add Razor Pages</strong> dialog.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>If scaffolding fails with the error <code>'Install the package Microsoft.VisualStudio.Web.CodeGeneration.Design and try again.'</code>, run the scaffold tool again or see <a href="https://github.com/dotnet/Scaffolding/issues/1540" data-linktype="external">this GitHub issue</a>.</p>
<p>The following packages are automatically installed:</p>
<ul>
<li><code>Microsoft.EntityFrameworkCore.SqlServer</code></li>
<li><code>Microsoft.EntityFrameworkCore.Tools</code></li>
<li><code>Microsoft.VisualStudio.Web.CodeGeneration.Design</code></li>
</ul>
</section>
<section id="tabpanel_14_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<ul>
<li><p>Run the following .NET CLI commands to install required NuGet packages:</p>
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.EntityFrameworkCore.SQLite -v 5.0.0-*
dotnet add package Microsoft.EntityFrameworkCore.SqlServer -v 5.0.0-*
dotnet add package Microsoft.EntityFrameworkCore.Design -v 5.0.0-*
dotnet add package Microsoft.EntityFrameworkCore.Tools -v 5.0.0-*
dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design -v 5.0.0-*
dotnet add package Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore -v 5.0.0-*  
</code></pre>
<p>The <code>Microsoft.VisualStudio.Web.CodeGeneration.Design</code> package is required for scaffolding. Although the app won't use SQL Server, the scaffolding tool needs the SQL Server package.</p>
</li>
<li><p>Create a <em>Pages/Students</em> folder.</p>
</li>
<li><p>Run the following command to install the <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/tools/dotnet-aspnet-codegenerator?view=aspnetcore-9.0" data-linktype="relative-path">aspnet-codegenerator scaffolding tool</a>.</p>
<pre><code class="lang-dotnetcli">dotnet tool install --global dotnet-aspnet-codegenerator

</code></pre>
</li>
<li><p>Run the following command to scaffold Student pages.</p>
<p><strong>On Windows</strong></p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator razorpage -m Student -dc ContosoUniversity.Data.SchoolContext -udl -outDir Pages\Students --referenceScriptLibraries -sqlite  
</code></pre>
<p><strong>On macOS or Linux</strong></p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator razorpage -m Student -dc ContosoUniversity.Data.SchoolContext -udl -outDir Pages/Students --referenceScriptLibraries -dbProvider sqlite 
</code></pre>
</li>
</ul>
</section>
</div>

<p>If the preceding step fails, build the project and retry the scaffold step.</p>
<p>The scaffolding process:</p>
<ul>
<li>Creates Razor pages in the <em>Pages/Students</em> folder:
<ul>
<li><code>Create.cshtml</code> and <code>Create.cshtml.cs</code></li>
<li><code>Delete.cshtml</code> and <code>Delete.cshtml.cs</code></li>
<li><code>Details.cshtml</code> and <code>Details.cshtml.cs</code></li>
<li><code>Edit.cshtml</code> and <code>Edit.cshtml.cs</code></li>
<li><code>Index.cshtml</code> and <code>Index.cshtml.cs</code></li>
</ul>
</li>
<li>Creates <code>Data/SchoolContext.cs</code>.</li>
<li>Adds the context to dependency injection in <code>Startup.cs</code>.</li>
<li>Adds a database connection string to <code>appsettings.json</code>.</li>
</ul>
<h2 id="database-connection-string-1">Database connection string</h2>
<p>The scaffolding tool generates a connection string in the <code>appsettings.json</code> file.</p>
<div class="tabGroup" id="tabgroup_15">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_15_visual-studio" role="tab" aria-controls="tabpanel_15_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_15_visual-studio-code" role="tab" aria-controls="tabpanel_15_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_15_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>The connection string specifies <a href="https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/sql-server-2016-express-localdb" data-linktype="absolute-path">SQL Server LocalDB</a>:</p>
<pre><code class="lang-json" name="Main" highlight-lines="11">{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information"
    }
  },
  "AllowedHosts": "*",
  "ConnectionStrings": {
    "SchoolContext": "Server=(localdb)\\mssqllocaldb;Database=CU-1;Trusted_Connection=True;MultipleActiveResultSets=true"
  }
}
</code></pre>
<p>LocalDB is a lightweight version of the SQL Server Express Database Engine and is intended for app development, not production use. By default, LocalDB creates <em>.mdf</em> files in the <code>C:/Users/&lt;user&gt;</code> directory.</p>
</section>
<section id="tabpanel_15_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<p>Shorten the SQLite connection string to <code>CU.db</code>:</p>
<pre><code class="lang-json" name="Main" highlight-lines="11">{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information"
    }
  },
  "AllowedHosts": "*",
  "ConnectionStrings": {
    "SchoolContext": "Data Source=CU.db"
  }
}
</code></pre>
<p>Don't change the directory without making sure it's valid.</p>
</section>
</div>
<h2 id="update-the-database-context-class-1">Update the database context class</h2>
<p>The main class that coordinates EF Core functionality for a given data model is the database context class. The context is derived from <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.dbcontext" class="no-loc" data-linktype="absolute-path">Microsoft.EntityFrameworkCore.DbContext</a>. The context specifies which entities are included in the data model. In this project, the class is named <code>SchoolContext</code>.</p>
<p>Update <code>Data/SchoolContext.cs</code> with the following code:</p>
<pre><code class="lang-csharp" name="Main" highlight-lines="13-22">using Microsoft.EntityFrameworkCore;
using ContosoUniversity.Models;

namespace ContosoUniversity.Data
{
    public class SchoolContext : DbContext
    {
        public SchoolContext (DbContextOptions&lt;SchoolContext&gt; options)
            : base(options)
        {
        }

        public DbSet&lt;Student&gt; Students { get; set; }
        public DbSet&lt;Enrollment&gt; Enrollments { get; set; }
        public DbSet&lt;Course&gt; Courses { get; set; }

        protected override void OnModelCreating(ModelBuilder modelBuilder)
        {
            modelBuilder.Entity&lt;Course&gt;().ToTable("Course");
            modelBuilder.Entity&lt;Enrollment&gt;().ToTable("Enrollment");
            modelBuilder.Entity&lt;Student&gt;().ToTable("Student");
        }
    }
}
</code></pre>
<p>The preceding code changes from the singular <code>DbSet&lt;Student&gt; Student</code> to the  plural <code>DbSet&lt;Student&gt; Students</code>. To make the Razor Pages code match the new <code>DBSet</code> name, make a global change from:
<code>_context.Student.</code>
to:
<code>_context.Students.</code></p>
<p>There are 8 occurrences.</p>
<p>Because an entity set contains multiple entities, many developers prefer the <code>DBSet</code> property names should be plural.</p>
<p>The highlighted code:</p>
<ul>
<li>Creates a <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.dbset-1" class="no-loc" data-linktype="absolute-path">DbSet&lt;TEntity&gt;</a> property for each entity set. In EF Core terminology:
<ul>
<li>An entity set typically corresponds to a database table.</li>
<li>An entity corresponds to a row in the table.</li>
</ul>
</li>
<li>Calls <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.dbcontext.onmodelcreating" class="no-loc" data-linktype="absolute-path">OnModelCreating</a>. <code>OnModelCreating</code>:
<ul>
<li>Is called when <code>SchoolContext</code> has been initialized but before the model has been secured and used to initialize the context.</li>
<li>Is required because later in the tutorial the <code>Student</code> entity will have references to the other entities.</li>
</ul>
<!-- Review, OnModelCreating needs review -->
</li>
</ul>
<p>Build the project to verify there are no compiler errors.</p>
<h2 id="startupcs">Startup.cs</h2>
<p>ASP.NET Core is built with <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-9.0" data-linktype="relative-path">dependency injection</a>. Services such as the <code>SchoolContext</code> are registered with dependency injection during app startup. Components that require these services, such as Razor Pages, are provided these services via constructor parameters. The constructor code that gets a database context instance is shown later in the tutorial.</p>
<p>The scaffolding tool automatically registered the context class with the dependency injection container.</p>
<div class="tabGroup" id="tabgroup_16">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_16_visual-studio" role="tab" aria-controls="tabpanel_16_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_16_visual-studio-code" role="tab" aria-controls="tabpanel_16_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_16_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>The following highlighted lines were added by the scaffolder:</p>
<pre><code class="lang-csharp" name="Main" highlight-lines="5-6">public void ConfigureServices(IServiceCollection services)
{
    services.AddRazorPages();

    services.AddDbContext&lt;SchoolContext&gt;(options =&gt;
            options.UseSqlServer(Configuration.GetConnectionString("SchoolContext")));
}
</code></pre></section>
<section id="tabpanel_16_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<p>Verify the code added by the scaffolder calls <code>UseSqlite</code>.</p>
<pre><code class="lang-csharp" name="Main" highlight-lines="5-6">public void ConfigureServices(IServiceCollection services)
{
    services.AddRazorPages();

    services.AddDbContext&lt;SchoolContext&gt;(options =&gt;
         options.UseSqlite(Configuration.GetConnectionString("SchoolContext")));
}
</code></pre>
<p>See <a href="https://learn.microsoft.com/en-us/aspnet/core/tutorials/razor-pages/model?view=aspnetcore-9.0&amp;tabs=visual-studio-code#use-sqlite-for-development-sql-server-for-production" data-linktype="relative-path">Use SQLite for development, SQL Server for production</a> for information on using a production database.</p>
</section>
</div>

<p>The name of the connection string is passed in to the context by calling a method on a <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.dbcontextoptions" class="no-loc" data-linktype="absolute-path">DbContextOptions</a> object. For local development, the <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/configuration/?view=aspnetcore-9.0" data-linktype="relative-path">ASP.NET Core configuration system</a> reads the connection string from the <code>appsettings.json</code> file.</p>
<p><a name="dbx"></a></p>
<h3 id="add-the-database-exception-filter-1">Add the database exception filter</h3>
<p>Add <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.extensions.dependencyinjection.databasedeveloperpageexceptionfilterserviceextensions.adddatabasedeveloperpageexceptionfilter" class="no-loc" data-linktype="absolute-path">AddDatabaseDeveloperPageExceptionFilter</a> and <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.builder.migrationsendpointextensions.usemigrationsendpoint" class="no-loc" data-linktype="absolute-path">UseMigrationsEndPoint</a> as shown in the following code:</p>
<div class="tabGroup" id="tabgroup_17">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_17_visual-studio" role="tab" aria-controls="tabpanel_17_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_17_visual-studio-code" role="tab" aria-controls="tabpanel_17_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_17_visual-studio" role="tabpanel" data-tab="visual-studio">
<pre><code class="lang-csharp" name="Main" highlight-lines="8,15-16">public void ConfigureServices(IServiceCollection services)
{
    services.AddRazorPages();

    services.AddDbContext&lt;SchoolContext&gt;(options =&gt;
       options.UseSqlServer(Configuration.GetConnectionString("SchoolContext")));

    services.AddDatabaseDeveloperPageExceptionFilter();
}

public void Configure(IApplicationBuilder app, IWebHostEnvironment env)
{
    if (env.IsDevelopment())
    {
        app.UseDeveloperExceptionPage();
        app.UseMigrationsEndPoint();
    }
    else
    {
        app.UseExceptionHandler("/Error");
        app.UseHsts();
    }

    app.UseHttpsRedirection();
    app.UseStaticFiles();

    app.UseRouting();

    app.UseAuthorization();

    app.UseEndpoints(endpoints =&gt;
    {
        endpoints.MapRazorPages();
    });
}
</code></pre>
<p>Add the <a href="https://www.nuget.org/packages/Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore" data-linktype="external">Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore</a> NuGet package.</p>
<p>In the Package Manager Console, enter the following to add the NuGet package:</p>
<pre><code class="lang-powershell">Install-Package Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore
</code></pre>
</section>
<section id="tabpanel_17_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">
<pre><code class="lang-csharp" name="Main" highlight-lines="8,16">public void ConfigureServices(IServiceCollection services)
{
    services.AddRazorPages();

    services.AddDbContext&lt;SchoolContext&gt;(options =&gt;
       options.UseSqlite(Configuration.GetConnectionString("SchoolContext")));

    services.AddDatabaseDeveloperPageExceptionFilter();
}

public void Configure(IApplicationBuilder app, IWebHostEnvironment env)
{
    if (env.IsDevelopment())
    {
        app.UseDeveloperExceptionPage();
        app.UseMigrationsEndPoint();
    }
    else
    {
        app.UseExceptionHandler("/Error");
        app.UseHsts();
    }

    app.UseHttpsRedirection();
    app.UseStaticFiles();

    app.UseRouting();

    app.UseAuthorization();

    app.UseEndpoints(endpoints =&gt;
    {
        endpoints.MapRazorPages();
    });
}
</code></pre></section>
</div>

<p>The <code>Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore</code> NuGet package provides ASP.NET Core middleware for Entity Framework Core error pages. This middleware helps to detect and diagnose errors with Entity Framework Core migrations.</p>
<p>The <code>AddDatabaseDeveloperPageExceptionFilter</code> provides helpful error information in the <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/environments?view=aspnetcore-9.0" data-linktype="relative-path">development environment</a> for EF migrations errors.</p>
<h2 id="create-the-database-1">Create the database</h2>
<p>Update <code>Program.cs</code> to create the database if it doesn't exist:</p>
<pre><code class="lang-csharp" name="Main" highlight-lines="1-2,14-18,21-38">using ContosoUniversity.Data;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.AspNetCore.Hosting;
using Microsoft.Extensions.Hosting;
using Microsoft.Extensions.Logging;
using System;

namespace ContosoUniversity
{
    public class Program
    {
        public static void Main(string[] args)
        {
            var host = CreateHostBuilder(args).Build();

            CreateDbIfNotExists(host);

            host.Run();
        }

        private static void CreateDbIfNotExists(IHost host)
        {
            using (var scope = host.Services.CreateScope())
            {
                var services = scope.ServiceProvider;
                try
                {
                    var context = services.GetRequiredService&lt;SchoolContext&gt;();
                    context.Database.EnsureCreated();
                    // DbInitializer.Initialize(context);
                }
                catch (Exception ex)
                {
                    var logger = services.GetRequiredService&lt;ILogger&lt;Program&gt;&gt;();
                    logger.LogError(ex, "An error occurred creating the DB.");
                }
            }
        }

        public static IHostBuilder CreateHostBuilder(string[] args) =&gt;
            Host.CreateDefaultBuilder(args)
                .ConfigureWebHostDefaults(webBuilder =&gt;
                {
                    webBuilder.UseStartup&lt;Startup&gt;();
                });
    }
}
</code></pre>
<p>The <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.infrastructure.databasefacade.ensurecreated" class="no-loc" data-linktype="absolute-path">EnsureCreated</a> method takes no action if a database for the context exists. If no database exists, it creates the database and schema. <code>EnsureCreated</code> enables the following workflow for handling data model changes:</p>
<ul>
<li>Delete the database. Any existing data is lost.</li>
<li>Change the data model. For example, add an <code>EmailAddress</code> field.</li>
<li>Run the app.</li>
<li><code>EnsureCreated</code> creates a database with the new schema.</li>
</ul>
<p>This workflow works early in development when the schema is rapidly evolving, as long as data doesn't need to be preserved. The situation is different when data that has been entered into the database needs to be preserved. When that is the case, use migrations.</p>
<p>Later in the tutorial series, the database is deleted that was created by <code>EnsureCreated</code> and migrations is used. A database that is created by <code>EnsureCreated</code> can't be updated by using migrations.</p>
<h3 id="test-the-app-1">Test the app</h3>
<ul>
<li>Run the app.</li>
<li>Select the <strong>Students</strong> link and then <strong>Create New</strong>.</li>
<li>Test the Edit, Details, and Delete links.</li>
</ul>
<h2 id="seed-the-database-1">Seed the database</h2>
<p>The <code>EnsureCreated</code> method creates an empty database. This section adds code that populates the database with test data.</p>
<p>Create <code>Data/DbInitializer.cs</code> with the following code:</p>
<pre><code class="lang-csharp" name="Main">using ContosoUniversity.Models;
using System;
using System.Linq;

namespace ContosoUniversity.Data
{
    public static class DbInitializer
    {
        public static void Initialize(SchoolContext context)
        {
            // Look for any students.
            if (context.Students.Any())
            {
                return;   // DB has been seeded
            }

            var students = new Student[]
            {
                new Student{FirstMidName="Carson",LastName="Alexander",EnrollmentDate=DateTime.Parse("2019-09-01")},
                new Student{FirstMidName="Meredith",LastName="Alonso",EnrollmentDate=DateTime.Parse("2017-09-01")},
                new Student{FirstMidName="Arturo",LastName="Anand",EnrollmentDate=DateTime.Parse("2018-09-01")},
                new Student{FirstMidName="Gytis",LastName="Barzdukas",EnrollmentDate=DateTime.Parse("2017-09-01")},
                new Student{FirstMidName="Yan",LastName="Li",EnrollmentDate=DateTime.Parse("2017-09-01")},
                new Student{FirstMidName="Peggy",LastName="Justice",EnrollmentDate=DateTime.Parse("2016-09-01")},
                new Student{FirstMidName="Laura",LastName="Norman",EnrollmentDate=DateTime.Parse("2018-09-01")},
                new Student{FirstMidName="Nino",LastName="Olivetto",EnrollmentDate=DateTime.Parse("2019-09-01")}
            };

            context.Students.AddRange(students);
            context.SaveChanges();

            var courses = new Course[]
            {
                new Course{CourseID=1050,Title="Chemistry",Credits=3},
                new Course{CourseID=4022,Title="Microeconomics",Credits=3},
                new Course{CourseID=4041,Title="Macroeconomics",Credits=3},
                new Course{CourseID=1045,Title="Calculus",Credits=4},
                new Course{CourseID=3141,Title="Trigonometry",Credits=4},
                new Course{CourseID=2021,Title="Composition",Credits=3},
                new Course{CourseID=2042,Title="Literature",Credits=4}
            };

            context.Courses.AddRange(courses);
            context.SaveChanges();

            var enrollments = new Enrollment[]
            {
                new Enrollment{StudentID=1,CourseID=1050,Grade=Grade.A},
                new Enrollment{StudentID=1,CourseID=4022,Grade=Grade.C},
                new Enrollment{StudentID=1,CourseID=4041,Grade=Grade.B},
                new Enrollment{StudentID=2,CourseID=1045,Grade=Grade.B},
                new Enrollment{StudentID=2,CourseID=3141,Grade=Grade.F},
                new Enrollment{StudentID=2,CourseID=2021,Grade=Grade.F},
                new Enrollment{StudentID=3,CourseID=1050},
                new Enrollment{StudentID=4,CourseID=1050},
                new Enrollment{StudentID=4,CourseID=4022,Grade=Grade.F},
                new Enrollment{StudentID=5,CourseID=4041,Grade=Grade.C},
                new Enrollment{StudentID=6,CourseID=1045},
                new Enrollment{StudentID=7,CourseID=3141,Grade=Grade.A},
            };

            context.Enrollments.AddRange(enrollments);
            context.SaveChanges();
        }
    }
}
</code></pre>
<p>The code checks if there are any students in the database. If there are no students, it adds test data to the database. It creates the test data in arrays rather than <code>List&lt;T&gt;</code> collections to optimize performance.</p>
<ul>
<li><p>In <code>Program.cs</code>, remove <code>//</code> from the <code>DbInitializer.Initialize</code> line:</p>
<pre><code class="lang-csharp">  context.Database.EnsureCreated();
  DbInitializer.Initialize(context);
</code></pre>
</li>
</ul>
<div class="tabGroup" id="tabgroup_18">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_18_visual-studio" role="tab" aria-controls="tabpanel_18_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_18_visual-studio-code" role="tab" aria-controls="tabpanel_18_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_18_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li><p>Stop the app if it's running, and run the following command in the <strong>Package Manager Console</strong> (PMC):</p>
<pre><code class="lang-powershell">Drop-Database -Confirm

</code></pre>
</li>
<li><p>Respond with <code>Y</code> to delete the database.</p>
</li>
</ul>
</section>
<section id="tabpanel_18_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<ul>
<li>Stop the app if it's running, and delete the <code>CU.db</code> file.</li>
</ul>
</section>
</div>

<ul>
<li>Restart the app.</li>
<li>Select the Students page to see the seeded data.</li>
</ul>
<h2 id="view-the-database-1">View the database</h2>
<div class="tabGroup" id="tabgroup_19">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_19_visual-studio" role="tab" aria-controls="tabpanel_19_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_19_visual-studio-code" role="tab" aria-controls="tabpanel_19_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_19_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>Open <strong>SQL Server Object Explorer</strong> (SSOX) from the <strong>View</strong> menu in Visual Studio.</li>
<li>In SSOX, select <strong>(localdb)\MSSQLLocalDB &gt; Databases &gt; SchoolContext-{GUID}</strong>. The database name is generated from the context name provided earlier plus a dash and a GUID.</li>
<li>Expand the <strong>Tables</strong> node.</li>
<li>Right-click the <strong>Student</strong> table and click <strong>View Data</strong> to see the columns created and the rows inserted into the table.</li>
<li>Right-click the <strong>Student</strong> table and click <strong>View Code</strong> to see how the <code>Student</code> model maps to the <code>Student</code> table schema.</li>
</ul>
</section>
<section id="tabpanel_19_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<p>Use a SQLite tool to view the database schema and seeded data. The database file is named <code>CU.db</code> and is located in the project folder.</p>
</section>
</div>
<h2 id="asynchronous-code">Asynchronous code</h2>
<p>Asynchronous programming is the default mode for ASP.NET Core and EF Core.</p>
<p>A web server has a limited number of threads available, and in high load situations all of the available threads might be in use. When that happens, the server can't process new requests until the threads are freed up. With synchronous code, many threads may be tied up while they aren't doing work because they're waiting for I/O to complete. With asynchronous code, when a process is waiting for I/O to complete, its thread is freed up for the server to use for processing other requests. As a result, asynchronous code enables server resources to be used more efficiently, and the server can handle more traffic without delays.</p>
<p>Asynchronous code does introduce a small amount of overhead at run time. For low traffic situations, the performance hit is negligible, while for high traffic situations, the potential performance improvement is substantial.</p>
<p>In the following code, the <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/async" data-linktype="absolute-path">async</a> keyword, <code>Task</code> return value, <code>await</code> keyword, and <code>ToListAsync</code> method make the code execute asynchronously.</p>
<pre><code class="lang-csharp">public async Task OnGetAsync()
{
    Students = await _context.Students.ToListAsync();
}
</code></pre>
<ul>
<li>The <code>async</code> keyword tells the compiler to:
<ul>
<li>Generate callbacks for parts of the method body.</li>
<li>Create the <a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/async/async-return-types#BKMK_TaskReturnType" data-linktype="absolute-path">Task</a> object that's returned.</li>
</ul>
</li>
<li>The <code>Task</code> return type represents ongoing work.</li>
<li>The <code>await</code> keyword causes the compiler to split the method into two parts. The first part ends with the operation that's started asynchronously. The second part is put into a callback method that's called when the operation completes.</li>
<li><code>ToListAsync</code> is the asynchronous version of the <code>ToList</code> extension method.</li>
</ul>
<p>Some things to be aware of when writing asynchronous code that uses EF Core:</p>
<ul>
<li>Only statements that cause queries or commands to be sent to the database are executed asynchronously. That includes <code>ToListAsync</code>, <code>SingleOrDefaultAsync</code>, <code>FirstOrDefaultAsync</code>, and <code>SaveChangesAsync</code>. It doesn't include statements that just change an <code>IQueryable</code>, such as <code>var students = context.Students.Where(s =&gt; s.LastName == "Davolio")</code>.</li>
<li>An EF Core context isn't thread safe: don't try to do multiple operations in parallel.</li>
<li>To take advantage of the performance benefits of async code, verify that library packages (such as for paging) use async if they call EF Core methods that send queries to the database.</li>
</ul>
<p>For more information about asynchronous programming in .NET, see <a href="https://learn.microsoft.com/en-us/dotnet/standard/async" data-linktype="absolute-path">Async Overview</a> and <a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/async/" data-linktype="absolute-path">Asynchronous programming with async and await</a>.</p>
<!-- Review: See https://github.com/dotnet/AspNetCore.Docs/issues/14528 -->
<h2 id="performance-considerations-1">Performance considerations</h2>
<p>In general, a web page shouldn't be loading an arbitrary number of rows. A query should use paging or a limiting approach. For example, the preceding query could use <code>Take</code> to limit the rows returned:</p>
<pre><code class="lang-csharp" name="Main">public async Task OnGetAsync()
{
    Student = await _context.Students.Take(10).ToListAsync();
}
</code></pre>
<p>Enumerating a large table in a view could return a partially constructed HTTP 200 response if a database exception occurs part way through the enumeration.</p>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.mvcoptions.maxmodelbindingcollectionsize#microsoft-aspnetcore-mvc-mvcoptions-maxmodelbindingcollectionsize" class="no-loc" data-linktype="absolute-path">MaxModelBindingCollectionSize</a> defaults to 1024. The following code sets <code>MaxModelBindingCollectionSize</code>:</p>
<pre><code class="lang-csharp" name="Main">public void ConfigureServices(IServiceCollection services)
{
    var myMaxModelBindingCollectionSize = Convert.ToInt32(
                Configuration["MyMaxModelBindingCollectionSize"] ?? "100");

    services.Configure&lt;MvcOptions&gt;(options =&gt;
           options.MaxModelBindingCollectionSize = myMaxModelBindingCollectionSize);

    services.AddRazorPages();

    services.AddDbContext&lt;SchoolContext&gt;(options =&gt;
          options.UseSqlServer(Configuration.GetConnectionString("SchoolContext")));

    services.AddDatabaseDeveloperPageExceptionFilter();
}
</code></pre>
<p>See <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/configuration/?view=aspnetcore-9.0" data-linktype="relative-path">Configuration</a> for information on configuration settings like <code>MyMaxModelBindingCollectionSize</code>.</p>
<p>Paging is covered later in the tutorial.</p>
<p>For more information, see <a href="https://learn.microsoft.com/en-us/dotnet/framework/data/adonet/ef/performance-considerations" data-linktype="absolute-path">Performance considerations (EF)</a>.</p>
<h2 id="sql-logging-of-entity-framework-core">SQL Logging of Entity Framework Core</h2>
<p>Logging configuration is commonly provided by the <code>Logging</code> section of <code>appsettings.{Environment}.json</code> files. To log SQL statements, add <code>"Microsoft.EntityFrameworkCore.Database.Command": "Information"</code> to the <code>appsettings.Development.json</code> file:</p>
<pre><code class="lang-json" highlight-lines="10">{
  "ConnectionStrings": {
    "DefaultConnection": "Server=(localdb)\\mssqllocaldb;Database=MyDB-2;Trusted_Connection=True;MultipleActiveResultSets=true"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information"
     ,"Microsoft.EntityFrameworkCore.Database.Command": "Information"
    }
  },
  "AllowedHosts": "*"
}
</code></pre>
<p>With the preceding JSON, SQL statements are displayed on the command line and in the Visual Studio output window.</p>
<p>For more information, see <a href="../../fundamentals/logging/index553c.html?view=aspnetcore-9.0#configure-logging" data-linktype="relative-path">Logging in .NET and ASP.NET Core</a> and this <a href="https://github.com/dotnet/aspnetcore/issues/32977" data-linktype="external">GitHub issue</a>.</p>
<h2 id="next-steps-1">Next steps</h2>
<p><a href="https://learn.microsoft.com/en-us/aspnet/core/tutorials/razor-pages/model?view=aspnetcore-9.0&amp;tabs=visual-studio-code#use-sqlite-for-development-sql-server-for-production" data-linktype="relative-path">Use SQLite for development, SQL Server for production</a></p>
<div class="step-by-step">
<p><a href="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/crud?view=aspnetcore-9.0" data-linktype="relative-path">Next tutorial</a></p>
</div>
</div>
<div data-moniker="aspnetcore-3.1">
<p>This is the first in a series of tutorials that show how to use Entity Framework (EF) Core in an <a href="../../razor-pages/index553c.html?view=aspnetcore-9.0" data-linktype="relative-path">ASP.NET Core Razor Pages</a> app. The tutorials build a web site for a fictional Contoso University. The site includes functionality such as student admission, course creation, and instructor assignments. The tutorial uses the code first approach. For information on following this tutorial using the database first approach, see <a href="https://github.com/dotnet/AspNetCore.Docs/issues/16897" data-linktype="external">this Github issue</a>.</p>
<p><a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/data/ef-rp/intro/samples" data-linktype="external">Download or view the completed app.</a> <a href="../../overview553c.html?view=aspnetcore-9.0#how-to-download-a-sample" data-linktype="relative-path">Download instructions</a>.</p>
<h2 id="prerequisites-2">Prerequisites</h2>
<ul>
<li>If you're new to Razor Pages, go through the <a href="../../tutorials/razor-pages/razor-pages-start553c.html?view=aspnetcore-9.0" data-linktype="relative-path">Get started with Razor Pages</a> tutorial series before starting this one.</li>
</ul>
<div class="tabGroup" id="tabgroup_20">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_20_visual-studio" role="tab" aria-controls="tabpanel_20_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_20_visual-studio-code" role="tab" aria-controls="tabpanel_20_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_20_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li><p><a href="https://visualstudio.microsoft.com/downloads/" data-linktype="external">Visual Studio 2022</a> with the <strong>ASP.NET and web development</strong> workload.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/tutorials/min-web-api/_static/asp-net-web-dev.png?view=aspnetcore-9.0" alt="VS22 installer workloads" data-linktype="relative-path"></p>
</li>
</ul>
</section>
<section id="tabpanel_20_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<ul>
<li><a href="https://code.visualstudio.com/download" data-linktype="external">Visual Studio Code</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=ms-dotnettools.csdevkit" data-linktype="external">C# Dev Kit for Visual Studio Code</a></li>
<li><a href="https://dotnet.microsoft.com/download/dotnet-core" data-linktype="external">Latest released .NET Core SDK</a></li>
</ul>
<p>You can follow the Visual Studio Code instructions on macOS, Linux, or Windows. Changes may be required if you use an integrated development environment (IDE) other than Visual Studio Code.</p>
</section>
</div>
<h2 id="database-engines-4">Database engines</h2>
<p>The Visual Studio instructions use <a href="https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/sql-server-2016-express-localdb" data-linktype="absolute-path">SQL Server LocalDB</a>, a version of SQL Server Express that runs only on Windows.</p>
<p>The Visual Studio Code instructions use <a href="https://www.sqlite.org/" data-linktype="external">SQLite</a>, a cross-platform database engine.</p>
<p>If you choose to use SQLite, download and install a third-party tool for managing and viewing a SQLite database, such as <a href="https://sqlitebrowser.org/" data-linktype="external">DB Browser for SQLite</a>.</p>
<h2 id="troubleshooting-2">Troubleshooting</h2>
<p>If you run into a problem you can't resolve, compare your code to the <a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/data/ef-rp/intro/samples" data-linktype="external">completed project</a>. A good way to get help is by posting a question to StackOverflow.com, using the <a href="https://stackoverflow.com/questions/tagged/asp.net-core" data-linktype="external">ASP.NET Core tag</a> or the <a href="https://stackoverflow.com/questions/tagged/entity-framework-core" data-linktype="external">EF Core tag</a>.</p>
<h2 id="the-sample-app-2">The sample app</h2>
<p>The app built in these tutorials is a basic university web site. Users can view and update student, course, and instructor information. Here are a few of the screens created in the tutorial.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/students-index30.png?view=aspnetcore-9.0" alt="Students Index page" data-linktype="relative-path"></p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/student-edit30.png?view=aspnetcore-9.0" alt="Students Edit page" data-linktype="relative-path"></p>
<p>The UI style of this site is based on the built-in project templates. The tutorial's focus is on how to use EF Core, not how to customize the UI.</p>
<p>Follow the link at the top of the page to get the source code for the completed project. The <em>cu30</em> folder has the code for the ASP.NET Core 3.0 version of the tutorial. Files that reflect the state of the code for tutorials 1-7 can be found in the <em>cu30snapshots</em> folder.</p>
<div class="tabGroup" id="tabgroup_21">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_21_visual-studio" role="tab" aria-controls="tabpanel_21_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_21_visual-studio-code" role="tab" aria-controls="tabpanel_21_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_21_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>To run the app after downloading the completed project:</p>
<ul>
<li><p>Build the project.</p>
</li>
<li><p>In Package Manager Console (PMC) run the following command:</p>
<pre><code class="lang-powershell">Update-Database
</code></pre>
</li>
<li><p>Run the project to seed the database.</p>
</li>
</ul>
</section>
<section id="tabpanel_21_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<p>To run the app after downloading the completed project:</p>
<ul>
<li><p>Delete <code>ContosoUniversity.csproj</code>, and rename <code>ContosoUniversitySQLite.csproj</code> to <code>ContosoUniversity.csproj</code>.</p>
</li>
<li><p>In <code>Program.cs</code>, comment out <code>#define Startup</code> so <code>StartupSQLite</code> is used.</p>
</li>
<li><p>Delete <code>appsettings.json</code>, and rename <code>appSettingsSQLite.json</code> to <code>appsettings.json</code>.</p>
</li>
<li><p>Delete the <em>Migrations</em> folder, and rename <em>MigrationsSQL</em> to <em>Migrations</em>.</p>
</li>
<li><p>Do a global search for <code>#if SQLiteVersion</code> and remove <code>#if SQLiteVersion</code> and the associated <code>#endif</code> statement.</p>
</li>
<li><p>Build the project.</p>
</li>
<li><p>At a command prompt in the project folder, run the following commands:</p>
<pre><code class="lang-dotnetcli">dotnet tool uninstall --global dotnet-ef
dotnet tool install --global dotnet-ef --version 5.0.0-*
dotnet ef database update
</code></pre>
</li>
<li><p>In your SQLite tool, run the following SQL statement:</p>
<pre><code class="lang-sql">UPDATE Department SET RowVersion = randomblob(8)
</code></pre>
</li>
<li><p>Run the project to seed the database.</p>
</li>
</ul>
</section>
</div>
<h2 id="create-the-web-app-project-2">Create the web app project</h2>
<div class="tabGroup" id="tabgroup_22">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_22_visual-studio" role="tab" aria-controls="tabpanel_22_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_22_visual-studio-code" role="tab" aria-controls="tabpanel_22_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_22_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>From the Visual Studio <strong>File</strong> menu, select <strong>New</strong> &gt; <strong>Project</strong>.</li>
<li>Select <strong>ASP.NET Core Web Application</strong>.</li>
<li>Name the project <em>ContosoUniversity</em>. It's important to use this exact name including capitalization, so the namespaces match when code is copied and pasted.</li>
<li>Select <strong>.NET Core</strong> and <strong>ASP.NET Core 3.0</strong> in the dropdowns, and then select <strong>Web Application</strong>.</li>
</ul>
</section>
<section id="tabpanel_22_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<ul>
<li><p>In a terminal, navigate to the folder in which the project folder should be created.</p>
</li>
<li><p>Run the following commands to create a Razor Pages project and <code>cd</code> into the new project folder:</p>
<pre><code class="lang-dotnetcli">dotnet new webapp -o ContosoUniversity
cd ContosoUniversity
</code></pre>
</li>
</ul>
</section>
</div>
<h2 id="set-up-the-site-style-2">Set up the site style</h2>
<p>Set up the site header, footer, and menu by updating <code>Pages/Shared/_Layout.cshtml</code>:</p>
<ul>
<li><p>Change each occurrence of "ContosoUniversity" to "Contoso University". There are three occurrences.</p>
</li>
<li><p>Delete the <strong>Home</strong> and <strong>Privacy</strong> menu entries, and add entries for <strong>About</strong>, <strong>Students</strong>, <strong>Courses</strong>, <strong>Instructors</strong>, and <strong>Departments</strong>.</p>
</li>
</ul>
<p>The changes are highlighted.</p>
<pre><code class="lang-cshtml" name="Main" highlight-lines="6,14,21-35,49">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
    &lt;title&gt;@ViewData["Title"] - Contoso University&lt;/title&gt;
    &lt;link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.css" /&gt;
    &lt;link rel="stylesheet" href="~/css/site.css" /&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;header&gt;
        &lt;nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3"&gt;
            &lt;div class="container"&gt;
                &lt;a class="navbar-brand" asp-area="" asp-page="/Index"&gt;Contoso University&lt;/a&gt;
                &lt;button class="navbar-toggler" type="button" data-toggle="collapse" data-target=".navbar-collapse" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation"&gt;
                    &lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;
                &lt;/button&gt;
                &lt;div class="navbar-collapse collapse d-sm-inline-flex flex-sm-row-reverse"&gt;
                    &lt;ul class="navbar-nav flex-grow-1"&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" asp-area="" asp-page="/About"&gt;About&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" asp-area="" asp-page="/Students/Index"&gt;Students&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" asp-area="" asp-page="/Courses/Index"&gt;Courses&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" asp-area="" asp-page="/Instructors/Index"&gt;Instructors&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" asp-area="" asp-page="/Departments/Index"&gt;Departments&lt;/a&gt;
                        &lt;/li&gt;
                    &lt;/ul&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/nav&gt;
    &lt;/header&gt;
    &lt;div class="container"&gt;
        &lt;main role="main" class="pb-3"&gt;
            @RenderBody()
        &lt;/main&gt;
    &lt;/div&gt;

    &lt;footer class="border-top footer text-muted"&gt;
        &lt;div class="container"&gt;
            &amp;copy; 2019 - Contoso University - &lt;a asp-area="" asp-page="/Privacy"&gt;Privacy&lt;/a&gt;
        &lt;/div&gt;
    &lt;/footer&gt;

    &lt;script src="~/lib/jquery/dist/jquery.js"&gt;&lt;/script&gt;
    &lt;script src="~/lib/bootstrap/dist/js/bootstrap.bundle.js"&gt;&lt;/script&gt;
    &lt;script src="~/js/site.js" asp-append-version="true"&gt;&lt;/script&gt;

    @RenderSection("Scripts", required: false)
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>In <code>Pages/Index.cshtml</code>, replace the contents of the file with the following code to replace the text about ASP.NET Core with text about this app:</p>
<pre><code class="lang-cshtml" name="Main">@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

&lt;div class="row mb-auto"&gt;
    &lt;div class="col-md-4"&gt;
        &lt;div class="row no-gutters border mb-4"&gt;
            &lt;div class="col p-4 mb-4 "&gt;
                &lt;p class="card-text"&gt;
                    Contoso University is a sample application that
                    demonstrates how to use Entity Framework Core in an
                    ASP.NET Core Razor Pages web app.
                &lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="col-md-4"&gt;
        &lt;div class="row no-gutters border mb-4"&gt;
            &lt;div class="col p-4 d-flex flex-column position-static"&gt;
                &lt;p class="card-text mb-auto"&gt;
                    You can build the application by following the steps in a series of tutorials.
                &lt;/p&gt;
                &lt;p&gt;
                    &lt;a href="https://docs.microsoft.com/aspnet/core/data/ef-rp/intro" class="stretched-link"&gt;See the tutorial&lt;/a&gt;
                &lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="col-md-4"&gt;
        &lt;div class="row no-gutters border mb-4"&gt;
            &lt;div class="col p-4 d-flex flex-column"&gt;
                &lt;p class="card-text mb-auto"&gt;
                    You can download the completed project from GitHub.
                &lt;/p&gt;
                &lt;p&gt;
                    &lt;a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/data/ef-rp/intro/samples" class="stretched-link"&gt;See project source code&lt;/a&gt;
                &lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

</code></pre>
<p>Run the app to verify that the home page appears.</p>
<h2 id="the-data-model-2">The data model</h2>
<p>The following sections create a data model:</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/data-model-diagram.png?view=aspnetcore-9.0" alt="Course-Enrollment-Student data model diagram" data-linktype="relative-path"></p>
<p>A student can enroll in any number of courses, and a course can have any number of students enrolled in it.</p>
<h2 id="the-student-entity-2">The Student entity</h2>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/student-entity.png?view=aspnetcore-9.0" alt="Student entity diagram" data-linktype="relative-path"></p>
<ul>
<li><p>Create a <em>Models</em> folder in the project folder.</p>
</li>
<li><p>Create <code>Models/Student.cs</code> with the following code:</p>
<pre><code class="lang-csharp" name="Main">using System;
using System.Collections.Generic;

namespace ContosoUniversity.Models
{
    public class Student
    {
        public int ID { get; set; }
        public string LastName { get; set; }
        public string FirstMidName { get; set; }
        public DateTime EnrollmentDate { get; set; }

        public ICollection&lt;Enrollment&gt; Enrollments { get; set; }
    }
}
</code></pre></li>
</ul>
<p>The <code>ID</code> property becomes the primary key column of the database table that corresponds to this class. By default, EF Core interprets a property that's named <code>ID</code> or <code>classnameID</code> as the primary key. So the alternative automatically recognized name for the <code>Student</code> class primary key is <code>StudentID</code>. For more information, see <a href="https://learn.microsoft.com/en-us/ef/core/modeling/keys?tabs=data-annotations" data-linktype="absolute-path">EF Core - Keys</a>.</p>
<p>The <code>Enrollments</code> property is a <a href="https://learn.microsoft.com/en-us/ef/core/modeling/relationships" data-linktype="absolute-path">navigation property</a>. Navigation properties hold other entities that are related to this entity. In this case, the <code>Enrollments</code> property of a <code>Student</code> entity holds all of the <code>Enrollment</code> entities that are related to that Student. For example, if a Student row in the database has two related Enrollment rows, the <code>Enrollments</code> navigation property contains those two Enrollment entities.</p>
<p>In the database, an Enrollment row is related to a Student row if its StudentID column contains the student's ID value. For example, suppose a Student row has ID=1. Related Enrollment rows will have StudentID = 1. StudentID is a <em>foreign key</em> in the Enrollment table.</p>
<p>The <code>Enrollments</code> property is defined as <code>ICollection&lt;Enrollment&gt;</code> because there may be multiple related Enrollment entities. You can use other collection types, such as <code>List&lt;Enrollment&gt;</code> or <code>HashSet&lt;Enrollment&gt;</code>. When <code>ICollection&lt;Enrollment&gt;</code> is used, EF Core creates a <code>HashSet&lt;Enrollment&gt;</code> collection by default.</p>
<h2 id="the-enrollment-entity-2">The Enrollment entity</h2>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/enrollment-entity.png?view=aspnetcore-9.0" alt="Enrollment entity diagram" data-linktype="relative-path"></p>
<p>Create <code>Models/Enrollment.cs</code> with the following code:</p>
<pre><code class="lang-csharp" name="Main">namespace ContosoUniversity.Models
{
    public enum Grade
    {
        A, B, C, D, F
    }

    public class Enrollment
    {
        public int EnrollmentID { get; set; }
        public int CourseID { get; set; }
        public int StudentID { get; set; }
        public Grade? Grade { get; set; }

        public Course Course { get; set; }
        public Student Student { get; set; }
    }
}
</code></pre>
<p>The <code>EnrollmentID</code> property is the primary key; this entity uses the <code>classnameID</code> pattern instead of <code>ID</code> by itself. For a production data model, choose one pattern and use it consistently. This tutorial uses both just to illustrate that both work. Using <code>ID</code> without <code>classname</code> makes it easier to implement some kinds of data model changes.</p>
<p>The <code>Grade</code> property is an <code>enum</code>. The question mark after the <code>Grade</code> type declaration indicates that the <code>Grade</code> property is <a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/nullable-types/" data-linktype="absolute-path">nullable</a>. A grade that's null is different from a zero grade—null means a grade isn't known or hasn't been assigned yet.</p>
<p>The <code>StudentID</code> property is a foreign key, and the corresponding navigation property is <code>Student</code>. An <code>Enrollment</code> entity is associated with one <code>Student</code> entity, so the property contains a single <code>Student</code> entity.</p>
<p>The <code>CourseID</code> property is a foreign key, and the corresponding navigation property is <code>Course</code>. An <code>Enrollment</code> entity is associated with one <code>Course</code> entity.</p>
<p>EF Core interprets a property as a foreign key if it's named <code>&lt;navigation property name&gt;&lt;primary key property name&gt;</code>. For example,<code>StudentID</code> is the foreign key for the <code>Student</code> navigation property, since the <code>Student</code> entity's primary key is <code>ID</code>. Foreign key properties can also be named <code>&lt;primary key property name&gt;</code>. For example, <code>CourseID</code> since the <code>Course</code> entity's primary key is <code>CourseID</code>.</p>
<h2 id="the-course-entity-2">The Course entity</h2>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro/_static/course-entity.png?view=aspnetcore-9.0" alt="Course entity diagram" data-linktype="relative-path"></p>
<p>Create <code>Models/Course.cs</code> with the following code:</p>
<pre><code class="lang-csharp" name="Main">using System.Collections.Generic;
using System.ComponentModel.DataAnnotations.Schema;

namespace ContosoUniversity.Models
{
    public class Course
    {
        [DatabaseGenerated(DatabaseGeneratedOption.None)]
        public int CourseID { get; set; }
        public string Title { get; set; }
        public int Credits { get; set; }

        public ICollection&lt;Enrollment&gt; Enrollments { get; set; }
    }
}
</code></pre>
<p>The <code>Enrollments</code> property is a navigation property. A <code>Course</code> entity can be related to any number of <code>Enrollment</code> entities.</p>
<p>The <code>DatabaseGenerated</code> attribute allows the app to specify the primary key rather than having the database generate it.</p>
<p>Build the project to validate that there are no compiler errors.</p>
<h2 id="scaffold-student-pages-2">Scaffold Student pages</h2>
<p>In this section, you use the ASP.NET Core scaffolding tool to generate:</p>
<ul>
<li>An EF Core <em>context</em> class. The context is the main class that coordinates Entity Framework functionality for a given data model. It derives from the <code>Microsoft.EntityFrameworkCore.DbContext</code> class.</li>
<li>Razor pages that handle Create, Read, Update, and Delete (CRUD) operations for the <code>Student</code> entity.</li>
</ul>
<div class="tabGroup" id="tabgroup_23">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_23_visual-studio" role="tab" aria-controls="tabpanel_23_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_23_visual-studio-code" role="tab" aria-controls="tabpanel_23_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_23_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>Create a <em>Students</em> folder in the <em>Pages</em> folder.</li>
<li>In <strong>Solution Explorer</strong>, right-click the <em>Pages/Students</em> folder and select <strong>Add</strong> &gt; <strong>New Scaffolded Item</strong>.</li>
<li>In the <strong>Add Scaffold</strong> dialog, select <strong>Razor Pages using Entity Framework (CRUD)</strong> &gt; <strong>ADD</strong>.</li>
<li>In the <strong>Add Razor Pages using Entity Framework (CRUD)</strong> dialog:
<ul>
<li>In the <strong>Model class</strong> drop-down, select <strong>Student (ContosoUniversity.Models)</strong>.</li>
<li>In the <strong>Data context class</strong> row, select the <strong>+</strong> (plus) sign.</li>
<li>Change the data context name from <em>ContosoUniversity.Models.ContosoUniversityContext</em> to <em>ContosoUniversity.Data.SchoolContext</em>.</li>
<li>Select <strong>Add</strong>.</li>
</ul>
</li>
</ul>
<p>The following packages are automatically installed:</p>
<ul>
<li><code>Microsoft.VisualStudio.Web.CodeGeneration.Design</code></li>
<li><code>Microsoft.EntityFrameworkCore.SqlServer</code></li>
<li><code>Microsoft.Extensions.Logging.Debug</code></li>
<li><code>Microsoft.EntityFrameworkCore.Tools</code></li>
</ul>
</section>
<section id="tabpanel_23_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<ul>
<li>Run the following .NET CLI commands to install required NuGet packages:</li>
</ul>
<!-- TO DO  After testing, Replace with
[!INCLUDE[](~/includes/includes/add-EF-NuGet-SQLite-CLI.md)]
remove dotnet tool install --global  below
 -->
<pre><code class="lang-dotnetcli">dotnet add package Microsoft.EntityFrameworkCore.SQLite
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Design
dotnet add package Microsoft.EntityFrameworkCore.Tools
dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.Extensions.Logging.Debug
</code></pre>
<p>The Microsoft.VisualStudio.Web.CodeGeneration.Design package is required for scaffolding. Although the app won't use SQL Server, the scaffolding tool needs the SQL Server package.</p>
<ul>
<li><p>Create a <em>Pages/Students</em> folder.</p>
</li>
<li><p>Run the following command to install the <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/tools/dotnet-aspnet-codegenerator?view=aspnetcore-9.0" data-linktype="relative-path">aspnet-codegenerator scaffolding tool</a>.</p>
<pre><code class="lang-dotnetcli">dotnet tool install --global dotnet-aspnet-codegenerator
</code></pre>
</li>
<li><p>Run the following command to scaffold Student pages.</p>
<p><strong>On Windows</strong></p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator razorpage -m Student -dc ContosoUniversity.Data.SchoolContext -udl -outDir Pages\Students --referenceScriptLibraries
</code></pre>
<p><strong>On macOS or Linux</strong></p>
<pre><code class="lang-dotnetcli">dotnet aspnet-codegenerator razorpage -m Student -dc ContosoUniversity.Data.SchoolContext -udl -outDir Pages/Students --referenceScriptLibraries
</code></pre>
</li>
</ul>
</section>
</div>

<p>If you have a problem with the preceding step, build the project and retry the scaffold step.</p>
<p>The scaffolding process:</p>
<ul>
<li>Creates Razor pages in the <em>Pages/Students</em> folder:
<ul>
<li><code>Create.cshtml</code> and <code>Create.cshtml.cs</code></li>
<li><code>Delete.cshtml</code> and <code>Delete.cshtml.cs</code></li>
<li><code>Details.cshtml</code> and <code>Details.cshtml.cs</code></li>
<li><code>Edit.cshtml</code> and <code>Edit.cshtml.cs</code></li>
<li><code>Index.cshtml</code> and <code>Index.cshtml.cs</code></li>
</ul>
</li>
<li>Creates <code>Data/SchoolContext.cs</code>.</li>
<li>Adds the context to dependency injection in <code>Startup.cs</code>.</li>
<li>Adds a database connection string to <code>appsettings.json</code>.</li>
</ul>
<h2 id="database-connection-string-2">Database connection string</h2>
<div class="tabGroup" id="tabgroup_24">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_24_visual-studio" role="tab" aria-controls="tabpanel_24_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_24_visual-studio-code" role="tab" aria-controls="tabpanel_24_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_24_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>The <code>appsettings.json</code> file specifies the connection string <a href="https://learn.microsoft.com/en-us/sql/database-engine/configure-windows/sql-server-2016-express-localdb" data-linktype="absolute-path">SQL Server LocalDB</a>.</p>
<pre><code class="lang-json" name="Main" highlight-lines="11">{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information"
    }
  },
  "AllowedHosts": "*",
  "ConnectionStrings": {
    "SchoolContext": "Server=(localdb)\\mssqllocaldb;Database=SchoolContext6;Trusted_Connection=True;MultipleActiveResultSets=true"
  }
}
</code></pre>
<p>LocalDB is a lightweight version of the SQL Server Express Database Engine and is intended for app development, not production use. By default, LocalDB creates <em>.mdf</em> files in the <code>C:/Users/&lt;user&gt;</code> directory.</p>
</section>
<section id="tabpanel_24_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<p>Change the connection string to point to a SQLite database file named <code>CU.db</code>:</p>
<pre><code class="lang-json" name="Main" highlight-lines="11">{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information"
    }
  },
  "AllowedHosts": "*",
  "ConnectionStrings": {
    "SchoolContext": "Data Source=CU.db"
  }
}
</code></pre></section>
</div>
<h2 id="update-the-database-context-class-2">Update the database context class</h2>
<p>The main class that coordinates EF Core functionality for a given data model is the database context class. The context is derived from <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.dbcontext" class="no-loc" data-linktype="absolute-path">Microsoft.EntityFrameworkCore.DbContext</a>. The context specifies which entities are included in the data model. In this project, the class is named <code>SchoolContext</code>.</p>
<p>Update <code>Data/SchoolContext.cs</code> with the following code:</p>
<pre><code class="lang-csharp" name="Main" highlight-lines="13-22">using Microsoft.EntityFrameworkCore;
using ContosoUniversity.Models;

namespace ContosoUniversity.Data
{
    public class SchoolContext : DbContext
    {
        public SchoolContext (DbContextOptions&lt;SchoolContext&gt; options)
            : base(options)
        {
        }

        public DbSet&lt;Student&gt; Students { get; set; }
        public DbSet&lt;Enrollment&gt; Enrollments { get; set; }
        public DbSet&lt;Course&gt; Courses { get; set; }

        protected override void OnModelCreating(ModelBuilder modelBuilder)
        {
            modelBuilder.Entity&lt;Course&gt;().ToTable("Course");
            modelBuilder.Entity&lt;Enrollment&gt;().ToTable("Enrollment");
            modelBuilder.Entity&lt;Student&gt;().ToTable("Student");
        }
    }
}
</code></pre>
<p>The highlighted code creates a <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.dbset-1" class="no-loc" data-linktype="absolute-path">DbSet&lt;TEntity&gt;</a> property for each entity set. In EF Core terminology:</p>
<ul>
<li>An entity set typically corresponds to a database table.</li>
<li>An entity corresponds to a row in the table.</li>
</ul>
<p>Since an entity set contains multiple entities, the DBSet properties should be plural names. Since the scaffolding tool created a<code>Student</code> DBSet, this step changes it to plural <code>Students</code>.</p>
<p>To make the Razor Pages code match the new DBSet name, make a global change across the whole project of <code>_context.Student</code> to <code>_context.Students</code>.  There are 8 occurrences.</p>
<p>Build the project to verify there are no compiler errors.</p>
<h2 id="startupcs-1">Startup.cs</h2>
<p>ASP.NET Core is built with <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-9.0" data-linktype="relative-path">dependency injection</a>. Services (such as the EF Core database context) are registered with dependency injection during application startup. Components that require these services (such as Razor Pages) are provided these services via constructor parameters. The constructor code that gets a database context instance is shown later in the tutorial.</p>
<p>The scaffolding tool automatically registered the context class with the dependency injection container.</p>
<div class="tabGroup" id="tabgroup_25">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_25_visual-studio" role="tab" aria-controls="tabpanel_25_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_25_visual-studio-code" role="tab" aria-controls="tabpanel_25_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_25_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li><p>In <code>ConfigureServices</code>, the highlighted lines were added by the scaffolder:</p>
<pre><code class="lang-csharp" name="Main" highlight-lines="5-6">public void ConfigureServices(IServiceCollection services)
{
    services.AddRazorPages();

    services.AddDbContext&lt;SchoolContext&gt;(options =&gt;
            options.UseSqlServer(Configuration.GetConnectionString("SchoolContext")));
}
</code></pre></li>
</ul>
</section>
<section id="tabpanel_25_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<ul>
<li><p>In <code>ConfigureServices</code>, make sure the code added by the scaffolder calls <code>UseSqlite</code>.</p>
<pre><code class="lang-csharp" name="Main" highlight-lines="5-6">public void ConfigureServices(IServiceCollection services)
{
    services.AddRazorPages();

    services.AddDbContext&lt;SchoolContext&gt;(options =&gt;
         options.UseSqlite(Configuration.GetConnectionString("SchoolContext")));
}
</code></pre></li>
</ul>
</section>
</div>

<p>The name of the connection string is passed in to the context by calling a method on a <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.dbcontextoptions" class="no-loc" data-linktype="absolute-path">DbContextOptions</a> object. For local development, the <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/configuration/?view=aspnetcore-9.0" data-linktype="relative-path">ASP.NET Core configuration system</a> reads the connection string from the <code>appsettings.json</code> file.</p>
<h2 id="create-the-database-2">Create the database</h2>
<p>Update <code>Program.cs</code> to create the database if it doesn't exist:</p>
<pre><code class="lang-csharp" name="Main" highlight-lines="1-2,14-18,21-38">using ContosoUniversity.Data;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.AspNetCore.Hosting;
using Microsoft.Extensions.Hosting;
using Microsoft.Extensions.Logging;
using System;

namespace ContosoUniversity
{
    public class Program
    {
        public static void Main(string[] args)
        {
            var host = CreateHostBuilder(args).Build();

            CreateDbIfNotExists(host);

            host.Run();
        }

        private static void CreateDbIfNotExists(IHost host)
        {
            using (var scope = host.Services.CreateScope())
            {
                var services = scope.ServiceProvider;
                try
                {
                    var context = services.GetRequiredService&lt;SchoolContext&gt;();
                    context.Database.EnsureCreated();
                    // DbInitializer.Initialize(context);
                }
                catch (Exception ex)
                {
                    var logger = services.GetRequiredService&lt;ILogger&lt;Program&gt;&gt;();
                    logger.LogError(ex, "An error occurred creating the DB.");
                }
            }
        }

        public static IHostBuilder CreateHostBuilder(string[] args) =&gt;
            Host.CreateDefaultBuilder(args)
                .ConfigureWebHostDefaults(webBuilder =&gt;
                {
                    webBuilder.UseStartup&lt;Startup&gt;();
                });
    }
}
</code></pre>
<p>The <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.infrastructure.databasefacade.ensurecreated" class="no-loc" data-linktype="absolute-path">EnsureCreated</a> method takes no action if a database for the context exists. If no database exists, it creates the database and schema. <code>EnsureCreated</code> enables the following workflow for handling data model changes:</p>
<ul>
<li>Delete the database. Any existing data is lost.</li>
<li>Change the data model. For example, add an <code>EmailAddress</code> field.</li>
<li>Run the app.</li>
<li><code>EnsureCreated</code> creates a database with the new schema.</li>
</ul>
<p>This workflow works well early in development when the schema is rapidly evolving, as long as you don't need to preserve data. The situation is different when data that has been entered into the database needs to be preserved. When that is the case, use migrations.</p>
<p>Later in the tutorial series, you delete the database that was created by <code>EnsureCreated</code> and use migrations instead. A database that is created by <code>EnsureCreated</code> can't be updated by using migrations.</p>
<h3 id="test-the-app-2">Test the app</h3>
<ul>
<li>Run the app.</li>
<li>Select the <strong>Students</strong> link and then <strong>Create New</strong>.</li>
<li>Test the Edit, Details, and Delete links.</li>
</ul>
<h2 id="seed-the-database-2">Seed the database</h2>
<p>The <code>EnsureCreated</code> method creates an empty database. This section adds code that populates the database with test data.</p>
<p>Create <code>Data/DbInitializer.cs</code> with the following code:</p>
<!-- next update, keep this file in the project and surround with #if -->
<pre><code class="lang-csharp" name="Main">using ContosoUniversity.Data;
using ContosoUniversity.Models;
using System;
using System.Linq;

namespace ContosoUniversity.Data
{
    public static class DbInitializer
    {
        public static void Initialize(SchoolContext context)
        {
            context.Database.EnsureCreated();

            // Look for any students.
            if (context.Students.Any())
            {
                return;   // DB has been seeded
            }

            var students = new Student[]
            {
                new Student{FirstMidName="Carson",LastName="Alexander",EnrollmentDate=DateTime.Parse("2019-09-01")},
                new Student{FirstMidName="Meredith",LastName="Alonso",EnrollmentDate=DateTime.Parse("2017-09-01")},
                new Student{FirstMidName="Arturo",LastName="Anand",EnrollmentDate=DateTime.Parse("2018-09-01")},
                new Student{FirstMidName="Gytis",LastName="Barzdukas",EnrollmentDate=DateTime.Parse("2017-09-01")},
                new Student{FirstMidName="Yan",LastName="Li",EnrollmentDate=DateTime.Parse("2017-09-01")},
                new Student{FirstMidName="Peggy",LastName="Justice",EnrollmentDate=DateTime.Parse("2016-09-01")},
                new Student{FirstMidName="Laura",LastName="Norman",EnrollmentDate=DateTime.Parse("2018-09-01")},
                new Student{FirstMidName="Nino",LastName="Olivetto",EnrollmentDate=DateTime.Parse("2019-09-01")}
            };

            context.Students.AddRange(students);
            context.SaveChanges();

            var courses = new Course[]
            {
                new Course{CourseID=1050,Title="Chemistry",Credits=3},
                new Course{CourseID=4022,Title="Microeconomics",Credits=3},
                new Course{CourseID=4041,Title="Macroeconomics",Credits=3},
                new Course{CourseID=1045,Title="Calculus",Credits=4},
                new Course{CourseID=3141,Title="Trigonometry",Credits=4},
                new Course{CourseID=2021,Title="Composition",Credits=3},
                new Course{CourseID=2042,Title="Literature",Credits=4}
            };

            context.Courses.AddRange(courses);
            context.SaveChanges();

            var enrollments = new Enrollment[]
            {
                new Enrollment{StudentID=1,CourseID=1050,Grade=Grade.A},
                new Enrollment{StudentID=1,CourseID=4022,Grade=Grade.C},
                new Enrollment{StudentID=1,CourseID=4041,Grade=Grade.B},
                new Enrollment{StudentID=2,CourseID=1045,Grade=Grade.B},
                new Enrollment{StudentID=2,CourseID=3141,Grade=Grade.F},
                new Enrollment{StudentID=2,CourseID=2021,Grade=Grade.F},
                new Enrollment{StudentID=3,CourseID=1050},
                new Enrollment{StudentID=4,CourseID=1050},
                new Enrollment{StudentID=4,CourseID=4022,Grade=Grade.F},
                new Enrollment{StudentID=5,CourseID=4041,Grade=Grade.C},
                new Enrollment{StudentID=6,CourseID=1045},
                new Enrollment{StudentID=7,CourseID=3141,Grade=Grade.A},
            };

            context.Enrollments.AddRange(enrollments);
            context.SaveChanges();
        }
    }
}
</code></pre>
<p>The code checks if there are any students in the database. If there are no students, it adds test data to the database. It creates the test data in arrays rather than <code>List&lt;T&gt;</code> collections to optimize performance.</p>
<ul>
<li><p>In <code>Program.cs</code>, replace the <code>EnsureCreated</code> call with a <code>DbInitializer.Initialize</code> call:</p>
<pre><code class="lang-csharp">// context.Database.EnsureCreated();
DbInitializer.Initialize(context);
</code></pre>
</li>
</ul>
<div class="tabGroup" id="tabgroup_26">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_26_visual-studio" role="tab" aria-controls="tabpanel_26_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_26_visual-studio-code" role="tab" aria-controls="tabpanel_26_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_26_visual-studio" role="tabpanel" data-tab="visual-studio">

<p>Stop the app if it's running, and run the following command in the <strong>Package Manager Console</strong> (PMC):</p>
<pre><code class="lang-powershell">Drop-Database
</code></pre>
</section>
<section id="tabpanel_26_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<ul>
<li>Stop the app if it's running, and delete the <code>CU.db</code> file.</li>
</ul>
</section>
</div>

<ul>
<li><p>Restart the app.</p>
</li>
<li><p>Select the Students page to see the seeded data.</p>
</li>
</ul>
<h2 id="view-the-database-2">View the database</h2>
<div class="tabGroup" id="tabgroup_27">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_27_visual-studio" role="tab" aria-controls="tabpanel_27_visual-studio" data-tab="visual-studio" tabindex="0" aria-selected="true" data-linktype="self-bookmark">Visual Studio</a>
</li>
<li role="presentation">
<a href="#tabpanel_27_visual-studio-code" role="tab" aria-controls="tabpanel_27_visual-studio-code" data-tab="visual-studio-code" tabindex="-1" data-linktype="self-bookmark">Visual Studio Code</a>
</li>
</ul>
<section id="tabpanel_27_visual-studio" role="tabpanel" data-tab="visual-studio">

<ul>
<li>Open <strong>SQL Server Object Explorer</strong> (SSOX) from the <strong>View</strong> menu in Visual Studio.</li>
<li>In SSOX, select <strong>(localdb)\MSSQLLocalDB &gt; Databases &gt; SchoolContext-{GUID}</strong>. The database name is generated from the context name you provided earlier plus a dash and a GUID.</li>
<li>Expand the <strong>Tables</strong> node.</li>
<li>Right-click the <strong>Student</strong> table and click <strong>View Data</strong> to see the columns created and the rows inserted into the table.</li>
<li>Right-click the <strong>Student</strong> table and click <strong>View Code</strong> to see how the <code>Student</code> model maps to the <code>Student</code> table schema.</li>
</ul>
</section>
<section id="tabpanel_27_visual-studio-code" role="tabpanel" data-tab="visual-studio-code" aria-hidden="true" hidden="hidden">

<p>Use your SQLite tool to view the database schema and seeded data. The database file is named <code>CU.db</code> and is located in the project folder.</p>
</section>
</div>
<h2 id="asynchronous-code-1">Asynchronous code</h2>
<p>Asynchronous programming is the default mode for ASP.NET Core and EF Core.</p>
<p>A web server has a limited number of threads available, and in high load situations all of the available threads might be in use. When that happens, the server can't process new requests until the threads are freed up. With synchronous code, many threads may be tied up while they aren't actually doing any work because they're waiting for I/O to complete. With asynchronous code, when a process is waiting for I/O to complete, its thread is freed up for the server to use for processing other requests. As a result, asynchronous code enables server resources to be used more efficiently, and the server can handle more traffic without delays.</p>
<p>Asynchronous code does introduce a small amount of overhead at run time. For low traffic situations, the performance hit is negligible, while for high traffic situations, the potential performance improvement is substantial.</p>
<p>In the following code, the <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/async" data-linktype="absolute-path">async</a> keyword, <code>Task&lt;T&gt;</code> return value, <code>await</code> keyword, and <code>ToListAsync</code> method make the code execute asynchronously.</p>
<pre><code class="lang-csharp">public async Task OnGetAsync()
{
    Students = await _context.Students.ToListAsync();
}
</code></pre>
<ul>
<li>The <code>async</code> keyword tells the compiler to:
<ul>
<li>Generate callbacks for parts of the method body.</li>
<li>Create the <a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/async/async-return-types#BKMK_TaskReturnType" data-linktype="absolute-path">Task</a> object that's returned.</li>
</ul>
</li>
<li>The <code>Task&lt;T&gt;</code> return type represents ongoing work.</li>
<li>The <code>await</code> keyword causes the compiler to split the method into two parts. The first part ends with the operation that's started asynchronously. The second part is put into a callback method that's called when the operation completes.</li>
<li><code>ToListAsync</code> is the asynchronous version of the <code>ToList</code> extension method.</li>
</ul>
<p>Some things to be aware of when writing asynchronous code that uses EF Core:</p>
<ul>
<li>Only statements that cause queries or commands to be sent to the database are executed asynchronously. That includes <code>ToListAsync</code>, <code>SingleOrDefaultAsync</code>, <code>FirstOrDefaultAsync</code>, and <code>SaveChangesAsync</code>. It doesn't include statements that just change an <code>IQueryable</code>, such as <code>var students = context.Students.Where(s =&gt; s.LastName == "Davolio")</code>.</li>
<li>An EF Core context isn't thread safe: don't try to do multiple operations in parallel.</li>
<li>To take advantage of the performance benefits of async code, verify that library packages (such as for paging) use async if they call EF Core methods that send queries to the database.</li>
</ul>
<p>For more information about asynchronous programming in .NET, see <a href="https://learn.microsoft.com/en-us/dotnet/standard/async" data-linktype="absolute-path">Async Overview</a> and <a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/async/" data-linktype="absolute-path">Asynchronous programming with async and await</a>.</p>
<h2 id="next-steps-2">Next steps</h2>
<div class="step-by-step">
<p><a href="https://learn.microsoft.com/en-us/aspnet/core/data/ef-rp/crud?view=aspnetcore-9.0" data-linktype="relative-path">Next tutorial</a></p>
</div>
</div>
</div>
					
		<div
			id="ms--inline-notifications"
			class="margin-block-xs"
			data-bi-name="inline-notification"
		></div>
	 
		<div
			id="assertive-live-region"
			role="alert"
			aria-live="assertive"
			class="visually-hidden"
			aria-relevant="additions"
			aria-atomic="true"
		></div>
		<div
			id="polite-live-region"
			role="status"
			aria-live="polite"
			class="visually-hidden"
			aria-relevant="additions"
			aria-atomic="true"
		></div>
	
					
			
		<!-- feedback section -->
		<section
			class="feedback-section position-relative margin-top-lg border border-radius padding-xxs display-none-print"
			data-bi-name="open-source-feedback-section"
			data-open-source-feedback-section
			hidden
		>
			<div class="display-flex flex-direction-column flex-direction-row-tablet">
				<div
					class="width-450-tablet padding-inline-xs padding-inline-xs-tablet padding-top-xs padding-bottom-sm padding-top-xs-tablet background-color-body-medium"
				>
					<div class="display-flex flex-direction-column">
						<div class="padding-bottom-xxs">
							<span class="icon margin-right-xxs" aria-hidden="true">
								<span class="docon docon-brand-github"></span>
							</span>
							<span class="font-weight-semibold">
								Collaborate with us on GitHub
							</span>
						</div>
						<span class="line-height-normal">
							The source for this content can be found on GitHub, where you can also create and review issues and pull requests. For more information, see <a href="https://learn.microsoft.com/contribute/content/dotnet/dotnet-contribute">our contributor guide</a>.
						</span>
					</div>
				</div>
				<div
					class="display-flex gap-xs width-full-tablet flex-direction-column padding-xs justify-content-space-evenly"
				>
					<div class="media">
						
					<div class="media-left">
						<div class="image image-36x36" hidden data-open-source-image-container>
							<img
								class="theme-display is-light"
								src="https://learn.microsoft.com/media/logos/logo_net.svg"
								aria-hidden="true"
								data-open-source-image-light
							/>
							<img
								class="theme-display is-dark is-high-contrast"
								src="https://learn.microsoft.com/media/logos/logo_net.svg"
								aria-hidden="true"
								data-open-source-image-dark
							/>
						</div>
					</div>
			  

						<div class="media-content">
							<p
								class="font-size-xl font-weight-semibold margin-bottom-xxs"
								data-open-source-product-title
							>
								ASP.NET Core
							</p>
							<div class="display-flex gap-xs flex-direction-column">
								<p class="line-height-normal" data-open-source-product-description></p>
								<div class="display-flex gap-xs flex-direction-column">
									<a href="#" data-github-link>
										<span class="icon margin-right-xxs" aria-hidden="true">
											<span class="docon docon-bug"></span>
										</span>
										<span>Open a documentation issue</span>
									</a>
									<a
										href="https://github.com/dotnet/aspnetcore/blob/main/CONTRIBUTING.md"
										class="display-block margin-top-auto font-size-md"
										data-feedback-product-url
									>
										<span class="icon margin-right-xxs" aria-hidden="true">
											<span class="docon docon-feedback"></span>
										</span>
										<span>Provide product feedback</span>
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!-- end feedback section -->
	
			
		<!-- feedback section -->
		<section
			id="site-user-feedback-footer"
			class="font-size-sm margin-top-md display-none-print display-none-desktop"
			data-test-id="site-user-feedback-footer"
			data-bi-name="site-feedback-section"
		>
			<hr class="hr" />
			<h2 id="ms--feedback" class="title is-3">Feedback</h2>
			<div class="display-flex flex-wrap-wrap align-items-center">
				<p class="font-weight-semibold margin-xxs margin-left-none">
					Was this page helpful?
				</p>
				<div class="buttons">
					<button
						class="thumb-rating-button like button button-primary button-sm"
						data-test-id="footer-rating-yes"
						data-binary-rating-response="rating-yes"
						type="button"
						title="This article is helpful"
						data-bi-name="button-rating-yes"
						aria-pressed="false"
					>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-like"></span>
						</span>
						<span>Yes</span>
					</button>
					<button
						class="thumb-rating-button dislike button button-primary button-sm"
						data-test-id="footer-rating-no"
						data-binary-rating-response="rating-no"
						type="button"
						title="This article is not helpful"
						data-bi-name="button-rating-no"
						aria-pressed="false"
					>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-dislike"></span>
						</span>
						<span>No</span>
					</button>
				</div>
			</div>
		</section>
		<!-- end feedback section -->
	
		
				</div>
				
		<div id="ms--additional-resources-mobile" class="display-none-print">
			<hr class="hr" hidden />
			<h2 id="ms--additional-resources-mobile-heading" class="title is-3" hidden>
				Additional resources
			</h2>
			
		<section
			id="right-rail-recommendations-mobile"
			class=""
			data-bi-name="recommendations"
			hidden
		></section>
	 
		<section
			id="right-rail-training-mobile"
			class=""
			data-bi-name="learning-resource-card"
			hidden
		></section>
	 
		<section
			id="right-rail-events-mobile"
			class=""
			data-bi-name="events-card"
			hidden
		></section>
	 
		<section
			id="right-rail-qna-mobile"
			class="margin-top-xxs"
			data-bi-name="qna-link-card"
			hidden
		></section>
	
		</div>
	
			</div>
			
		<div
			id="action-panel"
			role="region"
			aria-label="Action Panel"
			class="action-panel"
			tabindex="-1"
		></div>
	
		
				</main>
				<aside
					id="layout-body-aside"
					class="layout-body-aside "
					data-bi-name="aside"
			  >
					
		<div
			id="ms--additional-resources"
			class="right-container padding-sm display-none display-block-desktop height-full"
			data-bi-name="pageactions"
			role="complementary"
			aria-label="Additional resources"
		>
			<div id="affixed-right-container" data-bi-name="right-column">
				
		<nav
			id="side-doc-outline"
			class="doc-outline border-bottom padding-bottom-xs margin-bottom-xs"
			data-bi-name="intopic toc"
			aria-label="In this article"
		>
			<h3>In this article</h3>
		</nav>
	
				<!-- Feedback -->
				
		<section
			id="ms--site-user-feedback-right-rail"
			class="font-size-sm display-none-print"
			data-test-id="site-user-feedback-right-rail"
			data-bi-name="site-feedback-right-rail"
		>
			<p class="font-weight-semibold margin-bottom-xs">Was this page helpful?</p>
			<div class="buttons">
				<button
					class="thumb-rating-button like button button-primary button-sm"
					data-test-id="right-rail-rating-yes"
					data-binary-rating-response="rating-yes"
					type="button"
					title="This article is helpful"
					data-bi-name="button-rating-yes"
					aria-pressed="false"
				>
					<span class="icon" aria-hidden="true">
						<span class="docon docon-like"></span>
					</span>
					<span>Yes</span>
				</button>
				<button
					class="thumb-rating-button dislike button button-primary button-sm"
					data-test-id="right-rail-rating-no"
					data-binary-rating-response="rating-no"
					type="button"
					title="This article is not helpful"
					data-bi-name="button-rating-no"
					aria-pressed="false"
				>
					<span class="icon" aria-hidden="true">
						<span class="docon docon-dislike"></span>
					</span>
					<span>No</span>
				</button>
			</div>
		</section>
	
			</div>
		</div>
	
			  </aside> <section
					id="layout-body-flyout"
					class="layout-body-flyout "
					data-bi-name="flyout"
			  >
					 <div
	class="height-full border-left background-color-body-medium"
	id="ask-learn-flyout"
></div>
			  </section> <div class="layout-body-footer " data-bi-name="layout-footer">
		<footer
			id="footer"
			data-test-id="footer"
			data-bi-name="footer"
			class="footer-layout has-padding has-default-focus border-top  uhf-container"
			role="contentinfo"
		>
			<div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop">
				
		<a
			data-mscc-ic="false"
			href="#"
			data-bi-name="select-locale"
			class="locale-selector-link flex-shrink-0 button button-sm button-clear external-link-indicator"
			id=""
			title=""
			><span class="icon" aria-hidden="true"
				><span class="docon docon-world"></span></span
			><span class="local-selector-link-text">en-us</span></a
		>
	
				<div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
		
		<a
			data-mscc-ic="false"
			href="https://aka.ms/yourcaliforniaprivacychoices"
			data-bi-name="your-privacy-choices"
			class="button button-sm button-clear flex-shrink-0 external-link-indicator"
			id=""
			title=""
			>
		<svg
			xmlns="http://www.w3.org/2000/svg"
			viewBox="0 0 30 14"
			xml:space="preserve"
			height="16"
			width="43"
			aria-hidden="true"
			focusable="false"
		>
			<path
				d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z"
				style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"
			></path>
			<path
				d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z"
				style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"
			></path>
			<path
				d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z"
				style="fill:#fff"
			></path>
			<path
				d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z"
				style="fill:#06f"
			></path>
		</svg>
	
			<span>Your Privacy Choices</span></a
		>
	
	</div>
				<div class="flex-shrink-0">
		<div class="dropdown has-caret-up">
			<button
				data-test-id="theme-selector-button"
				class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
				aria-controls="{{ themeMenuId }}"
				aria-expanded="false"
				title="Theme"
				data-bi-name="theme"
			>
				<span class="icon">
					<span class="docon docon-sun" aria-hidden="true"></span>
				</span>
				<span>Theme</span>
				<span class="icon expanded-indicator" aria-hidden="true">
					<span class="docon docon-chevron-down-light"></span>
				</span>
			</button>
			<div class="dropdown-menu" id="{{ themeMenuId }}" role="menu">
				<ul class="theme-selector padding-xxs" data-test-id="theme-dropdown-menu">
					<li class="theme display-block">
						<button
							class="button button-clear button-sm theme-control button-block justify-content-flex-start text-align-left"
							data-theme-to="light"
						>
							<span class="theme-light margin-right-xxs">
								<span
									class="theme-selector-icon border display-inline-block has-body-background"
									aria-hidden="true"
								>
									<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
										<rect width="22" height="14" class="has-fill-body-background" />
										<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
										<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
										<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
										<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
										<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
									</svg>
								</span>
							</span>
							<span role="menuitem"> Light </span>
						</button>
					</li>
					<li class="theme display-block">
						<button
							class="button button-clear button-sm theme-control button-block justify-content-flex-start text-align-left"
							data-theme-to="dark"
						>
							<span class="theme-dark margin-right-xxs">
								<span
									class="border theme-selector-icon display-inline-block has-body-background"
									aria-hidden="true"
								>
									<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
										<rect width="22" height="14" class="has-fill-body-background" />
										<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
										<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
										<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
										<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
										<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
									</svg>
								</span>
							</span>
							<span role="menuitem"> Dark </span>
						</button>
					</li>
					<li class="theme display-block">
						<button
							class="button button-clear button-sm theme-control button-block justify-content-flex-start text-align-left"
							data-theme-to="high-contrast"
						>
							<span class="theme-high-contrast margin-right-xxs">
								<span
									class="border theme-selector-icon display-inline-block has-body-background"
									aria-hidden="true"
								>
									<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
										<rect width="22" height="14" class="has-fill-body-background" />
										<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
										<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
										<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
										<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
										<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
									</svg>
								</span>
							</span>
							<span role="menuitem"> High contrast </span>
						</button>
					</li>
				</ul>
			</div>
		</div>
	</div>
			</div>
			<ul class="links" data-bi-name="footerlinks">
				<li class="manage-cookies-holder" hidden=""></li>
				<li>
		
		<a
			data-mscc-ic="false"
			href="https://learn.microsoft.com/en-us/principles-for-ai-generated-content"
			data-bi-name="aiDisclaimer"
			class=" external-link-indicator"
			id=""
			title=""
			>AI Disclaimer</a
		>
	
	</li><li>
		
		<a
			data-mscc-ic="false"
			href="https://learn.microsoft.com/en-us/previous-versions/"
			data-bi-name="archivelink"
			class=" external-link-indicator"
			id=""
			title=""
			>Previous Versions</a
		>
	
	</li> <li>
		
		<a
			data-mscc-ic="false"
			href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog"
			data-bi-name="bloglink"
			class=" external-link-indicator"
			id=""
			title=""
			>Blog</a
		>
	
	</li> <li>
		
		<a
			data-mscc-ic="false"
			href="https://learn.microsoft.com/en-us/contribute"
			data-bi-name="contributorGuide"
			class=" external-link-indicator"
			id=""
			title=""
			>Contribute</a
		>
	
	</li><li>
		
		<a
			data-mscc-ic="false"
			href="https://go.microsoft.com/fwlink/?LinkId=521839"
			data-bi-name="privacy"
			class=" external-link-indicator"
			id=""
			title=""
			>Privacy</a
		>
	
	</li><li>
		
		<a
			data-mscc-ic="false"
			href="https://learn.microsoft.com/en-us/legal/termsofuse"
			data-bi-name="termsofuse"
			class=" external-link-indicator"
			id=""
			title=""
			>Terms of Use</a
		>
	
	</li><li>
		
		<a
			data-mscc-ic="false"
			href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/"
			data-bi-name="trademarks"
			class=" external-link-indicator"
			id=""
			title=""
			>Trademarks</a
		>
	
	</li>
				<li>&copy; Microsoft 2025</li>
			</ul>
		</footer>
	</footer>
			</body>
		
<!-- Mirrored from learn.microsoft.com/en-us/aspnet/core/data/ef-rp/intro?view=aspnetcore-9.0 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Aug 2025 14:53:03 GMT -->
</html>