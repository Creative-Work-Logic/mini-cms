 <!DOCTYPE html>
		<html
			class="layout layout-holy-grail   show-table-of-contents conceptual show-breadcrumb default-focus"
			lang="en-us"
			dir="ltr"
			data-authenticated="false"
			data-auth-status-determined="false"
			data-target="docs"
			x-ms-format-detection="none"
		>
			
		
<!-- Mirrored from learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys?view=aspnetcore-9.0 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Aug 2025 14:53:03 GMT -->
<head>
			<title>HTTP.sys web server implementation in ASP.NET Core | Microsoft Learn</title>
			<meta charset="utf-8" />
			<meta name="viewport" content="width=device-width, initial-scale=1.0" />
			<meta name="color-scheme" content="light dark" />

			<meta name="description" content="Learn about HTTP.sys, a web server for ASP.NET Core on Windows. Built on the HTTP.sys kernel-mode driver, HTTP.sys is an alternative to Kestrel that can be used for direct connection to the Internet without IIS." />
			<link rel="canonical" href="httpsys553c.html?view=aspnetcore-9.0" /> 

			<!-- Non-customizable open graph and sharing-related metadata -->
			<meta name="twitter:card" content="summary" />
			<meta name="twitter:site" content="@MicrosoftLearn" />
			<meta property="og:type" content="website" />
			<meta property="og:image:alt" content="HTTP.sys web server implementation in ASP.NET Core | Microsoft Learn" />
			<meta property="og:image" content="https://learn.microsoft.com/dotnet/media/dotnet-logo.png" />
			<!-- Page specific open graph and sharing-related metadata -->
			<meta property="og:title" content="HTTP.sys web server implementation in ASP.NET Core" />
			<meta property="og:url" content="httpsys553c.html?view=aspnetcore-9.0" />
			<meta property="og:description" content="Learn about HTTP.sys, a web server for ASP.NET Core on Windows. Built on the HTTP.sys kernel-mode driver, HTTP.sys is an alternative to Kestrel that can be used for direct connection to the Internet without IIS." />
			<meta name="platform_id" content="0493451c-698d-3fc3-be92-06b9993a413f" /> <meta name="scope" content="ASP.NET Core" />
			<meta name="locale" content="en-us" />
			 <meta name="adobe-target" content="true" />
			<meta name="uhfHeaderId" content="MSDocsHeader-AspNet" />

			<meta name="page_type" content="conceptual" />

			<!--page specific meta tags-->
			

			<!-- custom meta tags -->
			
		<meta name="breadcrumb_path" content="/aspnet/core/breadcrumb/toc.json" />
	
		<meta name="feedback_system" content="OpenSource" />
	
		<meta name="feedback_product_url" content="https://github.com/dotnet/aspnetcore/blob/main/CONTRIBUTING.md" />
	
		<meta name="ms.service" content="aspnet-core" />
	
		<meta name="ms.topic" content="conceptual" />
	
		<meta name="ms.subservice" content="fundamentals" />
	
		<meta name="author" content="tdykstra" />
	
		<meta name="monikerRange" content="&gt;= aspnetcore-2.1" />
	
		<meta name="ms.author" content="tdykstra" />
	
		<meta name="ms.custom" content="mvc" />
	
		<meta name="ms.date" content="2025-06-13T00:00:00Z" />
	
		<meta name="uid" content="fundamentals/servers/httpsys" />
	
		<meta name="document_id" content="5e347c54-6a6a-d685-4af7-39b023bf7f15" />
	
		<meta name="document_version_independent_id" content="41aa77f5-9466-6580-5ec6-b1bf97bd0f01" />
	
		<meta name="updated_at" content="2025-07-30T11:33:00Z" />
	
		<meta name="original_content_git_url" content="https://github.com/dotnet/AspNetCore.Docs/blob/live/aspnetcore/fundamentals/servers/httpsys.md" />
	
		<meta name="gitcommit" content="https://github.com/dotnet/AspNetCore.Docs/blob/879a03201958c8aea52cdfa611a1272865b09707/aspnetcore/fundamentals/servers/httpsys.md" />
	
		<meta name="git_commit_id" content="879a03201958c8aea52cdfa611a1272865b09707" />
	
		<meta name="monikers" content="aspnetcore-2.1" />
	
		<meta name="monikers" content="aspnetcore-2.2" />
	
		<meta name="monikers" content="aspnetcore-3.0" />
	
		<meta name="monikers" content="aspnetcore-3.1" />
	
		<meta name="monikers" content="aspnetcore-5.0" />
	
		<meta name="monikers" content="aspnetcore-6.0" />
	
		<meta name="monikers" content="aspnetcore-7.0" />
	
		<meta name="monikers" content="aspnetcore-8.0" />
	
		<meta name="monikers" content="aspnetcore-9.0" />
	
		<meta name="monikers" content="aspnetcore-10.0" />
	
		<meta name="default_moniker" content="aspnetcore-9.0" />
	
		<meta name="site_name" content="Docs" />
	
		<meta name="depot_name" content="MSDN.aspnet-core-conceptual" />
	
		<meta name="schema" content="Conceptual" />
	
		<meta name="toc_rel" content="../../toc.json" />
	
		<meta name="pdf_url_template" content="https://learn.microsoft.com/pdfstore/en-us/MSDN.aspnet-core-conceptual/{branchName}{pdfName}" />
	
		<meta name="feedback_help_link_type" content="" />
	
		<meta name="feedback_help_link_url" content="" />
	
		<meta name="word_count" content="9335" />
	
		<meta name="config_moniker_range" content="&gt;= aspnetcore-1.0" />
	
		<meta name="asset_id" content="fundamentals/servers/httpsys" />
	
		<meta name="moniker_range_name" content="37fa60b1fa5386966cfa742f834a698e" />
	
		<meta name="item_type" content="Content" />
	
		<meta name="source_path" content="aspnetcore/fundamentals/servers/httpsys.md" />
	
		<meta name="previous_tlsh_hash" content="2C2CD133C60DD610FF934E0A549BB61462FCC84C9AF07FC422256751B16E2EF7475E2DA7C2276B89333306D202D9A34E82D5AB6ED07C23B765B2647EC29C7441A29D3B72DE" />
	
		<meta name="github_feedback_content_git_url" content="https://github.com/dotnet/AspNetCore.Docs/blob/main/aspnetcore/fundamentals/servers/httpsys.md" />
	 
		<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/7696cda6-0510-47f6-8302-71bb5d2e28cf" data-source="generated" />
	
		<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/bcbcbad5-4208-4783-8035-8481272c98b8" data-source="generated" />
	
		<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/d452572f-6212-498f-9050-ca4a9e50a425" data-source="generated" />
	
		<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/69c76c32-967e-4c65-b89a-74cc527db725" data-source="generated" />
	
		<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/43b2e5aa-8a6d-4de2-a252-692232e5edc8" data-source="generated" />
	
		<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/a12e40b7-59a2-4437-96e2-166ce622b864" data-source="generated" />
	

			<!-- assets and js globals -->
			
			<link rel="stylesheet" href="https://learn.microsoft.com/static/assets/0.4.03137.7032-e8b681c0/styles/site-ltr.css" />
			<link rel="preconnect" href="http://mscom.demdex.net/" crossorigin />
						<link rel="dns-prefetch" href="http://target.microsoft.com/" />
						<link rel="dns-prefetch" href="http://microsoftmscompoc.tt.omtrdc.net/" />
						<link
							rel="preload"
							as="script"
							href="https://learn.microsoft.com/static/third-party/adobe-target/at-js/2.9.0/at.js"
							integrity="sha384-1/viVM50hgc33O2gOgkWz3EjiD/Fy/ld1dKYXJRUyjNYVEjSUGcSN+iPiQF7e4cu"
							crossorigin="anonymous"
							id="adobe-target-script"
							type="application/javascript"
						/>
			<script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
			<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-4.min.js"></script>
			<script src="https://learn.microsoft.com/_themes/docs.theme/master/en-us/_themes/global/deprecation.js"></script>

			<!-- msdocs global object -->
			<script id="msdocs-script">
		var msDocs = {
  "environment": {
    "accessLevel": "online",
    "azurePortalHostname": "portal.azure.com",
    "reviewFeatures": false,
    "supportLevel": "production",
    "systemContent": true,
    "siteName": "learn",
    "legacyHosting": false
  },
  "data": {
    "contentLocale": "en-us",
    "contentDir": "ltr",
    "userLocale": "en-us",
    "userDir": "ltr",
    "pageTemplate": "Conceptual",
    "brand": "",
    "context": {},
    "standardFeedback": false,
    "showFeedbackReport": false,
    "feedbackHelpLinkType": "",
    "feedbackHelpLinkUrl": "",
    "feedbackSystem": "OpenSource",
    "feedbackGitHubRepo": "dotnet/AspNetCore.Docs",
    "feedbackProductUrl": "https://github.com/dotnet/aspnetcore/blob/main/CONTRIBUTING.md",
    "extendBreadcrumb": false,
    "isEditDisplayable": true,
    "isPrivateUnauthorized": false,
    "hideViewSource": false,
    "isPermissioned": false,
    "hasRecommendations": true,
    "contributors": [
      {
        "name": "tdykstra",
        "url": "https://github.com/tdykstra"
      },
      {
        "name": "Copilot",
        "url": "https://github.com/Copilot"
      },
      {
        "name": "wadepickett",
        "url": "https://github.com/wadepickett"
      },
      {
        "name": "benhopkinstech",
        "url": "https://github.com/benhopkinstech"
      },
      {
        "name": "Rick-Anderson",
        "url": "https://github.com/Rick-Anderson"
      },
      {
        "name": "meganbradley",
        "url": "https://github.com/meganbradley"
      },
      {
        "name": "adityamandaleeka",
        "url": "https://github.com/adityamandaleeka"
      },
      {
        "name": "asbjornu",
        "url": "https://github.com/asbjornu"
      },
      {
        "name": "JamesNK",
        "url": "https://github.com/JamesNK"
      },
      {
        "name": "guardrex",
        "url": "https://github.com/guardrex"
      },
      {
        "name": "serpent5",
        "url": "https://github.com/serpent5"
      },
      {
        "name": "GitHubPang",
        "url": "https://github.com/GitHubPang"
      },
      {
        "name": "scottaddie",
        "url": "https://github.com/scottaddie"
      },
      {
        "name": "smflorentino",
        "url": "https://github.com/smflorentino"
      },
      {
        "name": "jkotalik",
        "url": "https://github.com/jkotalik"
      },
      {
        "name": "DCtheGeek",
        "url": "https://github.com/DCtheGeek"
      },
      {
        "name": "shirhatti",
        "url": "https://github.com/shirhatti"
      },
      {
        "name": "v-thepet",
        "url": "https://github.com/v-thepet"
      },
      {
        "name": "nschonni",
        "url": "https://github.com/nschonni"
      },
      {
        "name": "isaac2004",
        "url": "https://github.com/isaac2004"
      }
    ],
    "openSourceFeedbackIssueUrl": "https://github.com/dotnet/aspnetcore.docs/issues/new?template=customer-feedback.yml",
    "openSourceFeedbackIssueTitle": "",
    "openSourceFeedbackIssueLabels": "Source - Docs.ms,:watch: Not Triaged"
  },
  "functions": {}
};;
	</script>

			<!-- base scripts, msdocs global should be before this -->
			<script src="https://learn.microsoft.com/static/assets/0.4.03137.7032-e8b681c0/scripts/en-us/index-docs.js"></script>
			

			<!-- json-ld -->
			
		</head>
	
			<body
				id="body"
				data-bi-name="body"
				class="layout-body "
				lang="en-us"
				dir="ltr"
			>
				<header class="layout-body-header">
		<div class="header-holder has-default-focus">
			
		<a
			href="#main"
			
			style="z-index: 1070"
			class="outline-color-text visually-hidden-until-focused position-fixed inner-focus focus-visible top-0 left-0 right-0 padding-xs text-align-center background-color-body"
			
		>
			Skip to main content
		</a>
	
		<a
			href="#"
			data-skip-to-ask-learn
			style="z-index: 1070"
			class="outline-color-text visually-hidden-until-focused position-fixed inner-focus focus-visible top-0 left-0 right-0 padding-xs text-align-center background-color-body"
			hidden
		>
			Skip to Ask Learn chat experience
		</a>
	

			<div hidden id="cookie-consent-holder" data-test-id="cookie-consent-container"></div>
			<!-- Unsupported browser warning -->
			<div
				id="unsupported-browser"
				style="background-color: white; color: black; padding: 16px; border-bottom: 1px solid grey;"
				hidden
			>
				<div style="max-width: 800px; margin: 0 auto;">
					<p style="font-size: 24px">This browser is no longer supported.</p>
					<p style="font-size: 16px; margin-top: 16px;">
						Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.
					</p>
					<div style="margin-top: 12px;">
						<a
							href="https://go.microsoft.com/fwlink/p/?LinkID=2092881"
							style="background-color: #0078d4; border: 1px solid #0078d4; color: white; padding: 6px 12px; border-radius: 2px; display: inline-block;"
						>
							Download Microsoft Edge
						</a>
						<a
							href="https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge"
							style="background-color: white; padding: 6px 12px; border: 1px solid #505050; color: #171717; border-radius: 2px; display: inline-block;"
						>
							More info about Internet Explorer and Microsoft Edge
						</a>
					</div>
				</div>
			</div>
			<!-- site header -->
			<header
				id="ms--site-header"
				data-test-id="site-header-wrapper"
				role="banner"
				itemscope="itemscope"
				itemtype="http://schema.org/Organization"
			>
				<div
					id="ms--mobile-nav"
					class="site-header display-none-tablet padding-inline-none gap-none"
					data-bi-name="mobile-header"
					data-test-id="mobile-header"
				></div>
				<div
					id="ms--primary-nav"
					class="site-header display-none display-flex-tablet"
					data-bi-name="L1-header"
					data-test-id="primary-header"
				></div>
				<div
					id="ms--secondary-nav"
					class="site-header display-none display-flex-tablet"
					data-bi-name="L2-header"
					data-test-id="secondary-header"
				></div>
			</header>
			
		<!-- banner -->
		<div data-banner>
			<div id="disclaimer-holder"></div>
			
		</div>
		<!-- banner end -->
	
		</div>
	</header>
				 <section
					id="layout-body-menu"
					class="layout-body-menu display-flex"
					data-bi-name="menu"
			  >
					<div
		id="left-container"
		class="left-container display-none display-block-tablet padding-inline-sm padding-bottom-sm width-full"
	>
		<nav
			id="affixed-left-container"
			class="margin-top-sm-tablet position-sticky display-flex flex-direction-column"
			aria-label="Primary"
		></nav>
	</div>
			  </section>

				<main
					id="main"
					role="main"
					class="layout-body-main "
					data-bi-name="content"
					lang="en-us"
					dir="ltr"
				>
					
			<div
		id="ms--content-header"
		class="content-header default-focus border-bottom-none"
		data-bi-name="content-header"
	>
		<div class="content-header-controls margin-xxs margin-inline-sm-tablet">
			<button
				type="button"
				class="contents-button button button-sm margin-right-xxs"
				data-bi-name="contents-expand"
				aria-haspopup="true"
				data-contents-button
			>
				<span class="icon" aria-hidden="true"><span class="docon docon-menu"></span></span>
				<span class="contents-expand-title"> Table of contents </span>
			</button>
			<button
				type="button"
				class="ap-collapse-behavior ap-expanded button button-sm"
				data-bi-name="ap-collapse"
				aria-controls="action-panel"
			>
				<span class="icon" aria-hidden="true"><span class="docon docon-exit-mode"></span></span>
				<span>Exit editor mode</span>
			</button>
		</div>
	</div>
			<div data-main-column class="padding-sm padding-top-none padding-top-sm-tablet">
				<div>
					
		<div id="article-header" class="background-color-body margin-bottom-xs display-none-print">
			<div class="display-flex align-items-center justify-content-space-between">
				
		<details
			id="article-header-breadcrumbs-overflow-popover"
			class="popover"
			data-for="article-header-breadcrumbs"
		>
			<summary
				class="button button-clear button-primary button-sm inner-focus"
				aria-label="All breadcrumbs"
			>
				<span class="icon">
					<span class="docon docon-more"></span>
				</span>
			</summary>
			<div id="article-header-breadcrumbs-overflow" class="popover-content padding-none"></div>
		</details>

		<bread-crumbs
			id="article-header-breadcrumbs"
			data-test-id="article-header-breadcrumbs"
			class="overflow-hidden flex-grow-1 margin-right-sm margin-right-md-tablet margin-right-lg-desktop margin-left-negative-xxs padding-left-xxs"
		></bread-crumbs>
	 
		<div
			id="article-header-page-actions"
			class="opacity-none margin-left-auto display-flex flex-wrap-no-wrap align-items-stretch"
		>
			
		<button
			class="button button-sm border-none inner-focus display-none-tablet flex-shrink-0 "
			data-bi-name="ask-learn-assistant-entry"
			data-test-id="ask-learn-assistant-modal-entry-mobile"
			data-ask-learn-modal-entry
			type="button"
			style="min-width: max-content;"
			aria-expanded="false"
			aria-label="Ask Learn"
			hidden
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
			</span>
		</button>
		<button
			class="button button-sm display-none display-inline-flex-tablet display-none-desktop flex-shrink-0 margin-right-xxs border-color-ask-learn "
			data-bi-name="ask-learn-assistant-entry"
			data-test-id="ask-learn-assistant-modal-entry-tablet"
			data-ask-learn-modal-entry
			type="button"
			style="min-width: max-content;"
			aria-expanded="false"
			hidden
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
			</span>
			<span>Ask Learn</span>
		</button>
		<button
			class="button button-sm display-none flex-shrink-0 display-inline-flex-desktop margin-right-xxs	border-color-ask-learn "
			data-bi-name="ask-learn-assistant-entry"
			data-test-id="ask-learn-assistant-flyout-entry"
			data-ask-learn-flyout-entry
			data-flyout-button="toggle"
			type="button"
			style="min-width: max-content;"
			aria-expanded="false"
			aria-controls="ask-learn-flyout"
			hidden
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
			</span>
			<span>Ask Learn</span>
		</button>
	 
		<button
			type="button"
			id="ms--focus-mode-button"
			data-focus-mode
			data-bi-name="focus-mode-entry"
			class="button button-sm flex-shrink-0 margin-right-xxs display-none display-inline-flex-desktop"
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-glasses"></span>
			</span>
			<span>Focus mode</span>
		</button>
	 

			<details class="popover popover-right" id="article-header-page-actions-overflow">
				<summary
					class="justify-content-flex-start button button-clear button-sm button-primary inner-focus"
					aria-label="More actions"
					title="More actions"
				>
					<span class="icon" aria-hidden="true">
						<span class="docon docon-more-vertical"></span>
					</span>
				</summary>
				<div class="popover-content">
					
		<button
			data-page-action-item="overflow-mobile"
			type="button"
			class="button-block button-sm has-inner-focus button button-clear display-none-tablet justify-content-flex-start text-align-left"
			data-bi-name="contents-expand"
			data-contents-button
			data-popover-close
		>
			<span class="icon">
				<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
			</span>
			<span class="contents-expand-title">Table of contents</span>
		</button>
	 
		<a
			id="lang-link-overflow"
			class="button-sm has-inner-focus button button-clear button-block justify-content-flex-start text-align-left"
			data-bi-name="language-toggle"
			data-page-action-item="overflow-all"
			data-check-hidden="true"
			data-read-in-link
			href="#"
			hidden
		>
			<span class="icon" aria-hidden="true" data-read-in-link-icon>
				<span class="docon docon-locale-globe"></span>
			</span>
			<span data-read-in-link-text>Read in English</span>
		</a>
	 
		<button
			type="button"
			class="collection button button-clear button-sm button-block justify-content-flex-start text-align-left inner-focus"
			data-list-type="collection"
			data-bi-name="collection"
			data-page-action-item="overflow-all"
			data-check-hidden="true"
			data-popover-close
		>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-circle-addition"></span>
			</span>
			<span class="collection-status">Add</span>
		</button>
	
					
		<button
			type="button"
			class="collection button button-block button-clear button-sm justify-content-flex-start text-align-left inner-focus"
			data-list-type="plan"
			data-bi-name="plan"
			data-page-action-item="overflow-all"
			data-check-hidden="true"
			data-popover-close
			hidden
		>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-circle-addition"></span>
			</span>
			<span class="plan-status">Add to plan</span>
		</button>
	  
		<a
			data-contenteditbtn
			class="button button-clear button-block button-sm inner-focus justify-content-flex-start text-align-left text-decoration-none"
			data-bi-name="edit"
			
			href="https://github.com/dotnet/AspNetCore.Docs/blob/main/aspnetcore/fundamentals/servers/httpsys.md"
			data-original_content_git_url="https://github.com/dotnet/AspNetCore.Docs/blob/live/aspnetcore/fundamentals/servers/httpsys.md"
			data-original_content_git_url_template="{repo}/blob/{branch}/aspnetcore/fundamentals/servers/httpsys.md"
			data-pr_repo=""
			data-pr_branch=""
		>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-edit-outline"></span>
			</span>
			<span>Edit</span>
		</a>
	
					
		<hr class="margin-block-xxs" />
		<h4 class="font-size-sm padding-left-xxs">Share via</h4>
		
					<a
						class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-facebook"
						data-bi-name="facebook"
						data-page-action-item="overflow-all"
						href="#"
					>
						<span class="icon color-primary" aria-hidden="true">
							<span class="docon docon-facebook-share"></span>
						</span>
						<span>Facebook</span>
					</a>

					<a
						href="#"
						class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-twitter"
						data-bi-name="twitter"
						data-page-action-item="overflow-all"
					>
						<span class="icon color-text" aria-hidden="true">
							<span class="docon docon-xlogo-share"></span>
						</span>
						<span>x.com</span>
					</a>

					<a
						href="#"
						class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-linkedin"
						data-bi-name="linkedin"
						data-page-action-item="overflow-all"
					>
						<span class="icon color-primary" aria-hidden="true">
							<span class="docon docon-linked-in-logo"></span>
						</span>
						<span>LinkedIn</span>
					</a>
					<a
						href="#"
						class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-email"
						data-bi-name="email"
						data-page-action-item="overflow-all"
					>
						<span class="icon color-primary" aria-hidden="true">
							<span class="docon docon-mail-message"></span>
						</span>
						<span>Email</span>
					</a>
			  
	 
		<hr class="margin-block-xxs" />
		<button
			class="button button-block button-clear button-sm justify-content-flex-start text-align-left inner-focus"
			type="button"
			data-bi-name="print"
			data-page-action-item="overflow-all"
			data-popover-close
			data-print-page
			data-check-hidden="true"
		>
			<span class="icon color-primary" aria-hidden="true">
				<span class="docon docon-print"></span>
			</span>
			<span>Print</span>
		</button>
	
				</div>
			</details>
		</div>
	
			</div>
		</div>
	
					<!-- azure disclaimer -->
					
					<!-- privateUnauthorizedTemplate is hidden by default -->
					
		<div unauthorized-private-section data-bi-name="permission-content-unauthorized-private" hidden>
			<hr class="hr margin-top-xs margin-bottom-sm" />
			<div class="notification notification-info">
				<div class="notification-content">
					<p class="margin-top-none notification-title">
						<span class="icon">
							<span class="docon docon-exclamation-circle-solid" aria-hidden="true"></span>
						</span>
						<span>Note</span>
					</p>
					<p class="margin-top-none authentication-determined not-authenticated">
						Access to this page requires authorization. You can try <a class="docs-sign-in" href="#" data-bi-name="permission-content-sign-in">signing in</a> or <a  class="docs-change-directory" data-bi-name="permisson-content-change-directory">changing directories</a>.
					</p>
					<p class="margin-top-none authentication-determined authenticated">
						Access to this page requires authorization. You can try <a class="docs-change-directory" data-bi-name="permisson-content-change-directory">changing directories</a>.
					</p>
				</div>
			</div>
		</div>
	
					<div class="content"><h1 id="httpsys-web-server-implementation-in-aspnet-core">HTTP.sys web server implementation in ASP.NET Core</h1></div>
					
		<div
			id="article-metadata"
			class="page-metadata-container display-flex gap-xxs justify-content-space-between align-items-center flex-wrap-wrap"
		>
			
		<div class="margin-block-xxs">
			<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
				  <li class="visibility-hidden-visual-diff">
			<local-time
				format="twoDigitNumeric"
				datetime="2025-06-13T15:11:00.000Z"
				data-article-date-source="calculated"
				class="is-invisible"
			>
				2025-06-13
			</local-time>
		</li>  
			</ul>
		</div>
	 
				<div
					id="user-feedback"
					class="margin-block-xxs display-none display-none-print"
					hidden
					data-hide-on-archived
				>
					
		<button
			id="user-feedback-button"
			data-test-id="conceptual-feedback-button"
			class="button button-sm button-clear button-primary display-none"
			type="button"
			data-bi-name="user-feedback-button"
			data-user-feedback-button
			hidden
		>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-like"></span>
			</span>
			<span>Feedback</span>
		</button>
	
				</div>
		  
		</div>
	 
		<nav
			id="center-doc-outline"
			class="doc-outline is-hidden-desktop display-none-print margin-bottom-sm"
			data-bi-name="intopic toc"
			aria-label="In this article"
		>
			<h2 id="ms--in-this-article" class="title is-6 margin-block-xs">
				In this article
			</h2>
		</nav>
	
					<div class="content"><div data-moniker="aspnetcore-2.1 aspnetcore-2.2 aspnetcore-3.0 aspnetcore-3.1 aspnetcore-5.0 aspnetcore-6.0 aspnetcore-7.0 aspnetcore-8.0">
<div class="NOTE">
<p>Note</p>
<p>This isn't the latest version of this article. For the current release, see the <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys?view=aspnetcore-9.0&amp;preserve-view=true" data-linktype="relative-path">.NET 9 version of this article</a>.</p>
</div>
</div>
<div data-moniker="aspnetcore-3.0 aspnetcore-3.1 aspnetcore-5.0 aspnetcore-7.0">
<div class="WARNING">
<p>Warning</p>
<p>This version of ASP.NET Core is no longer supported. For more information, see the <a href="https://dotnet.microsoft.com/platform/support/policy/dotnet-core" data-linktype="external">.NET and .NET Core Support Policy</a>. For the current release, see the <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys?view=aspnetcore-9.0&amp;preserve-view=true" data-linktype="relative-path">.NET 9 version of this article</a>.</p>
</div>
</div>
<div data-moniker="aspnetcore-10.0">
<div class="IMPORTANT">
<p>Important</p>
<p>This information relates to a pre-release product that may be substantially modified before it's commercially released. Microsoft makes no warranties, express or implied, with respect to the information provided here.</p>
<p>For the current release, see the <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys?view=aspnetcore-9.0&amp;preserve-view=true" data-linktype="relative-path">.NET 9 version of this article</a>.</p>
</div>
</div>
<!--
Include either this file or 'not-latest-version-without-not-supported-content.md' at the top 
of articles.

'not-latest-version.md' (this file): Includes not-supported content.
'not-latest-version-without-not-supported-content.md': Doesn't include not-supported content.

Use this file in articles that target >=7.0. For articles that target >=8.0 prior to 9.0
reaching EOL, 'not-latest-version-without-not-supported-content.md' must be used to avoid
a zone/file moniker range mismatch error.

When a new version is released, it might be necessary to temporarily comment out the current 
version moniker range section until the new moniker is created.

Markdown to include this file:

[!INCLUDE[](~/includes/not-latest-version.md)]
-->
<p>By <a href="https://github.com/tdykstra" data-linktype="external">Tom Dykstra</a> and <a href="https://github.com/Tratcher" data-linktype="external">Chris Ross</a></p>
<div data-moniker="aspnetcore-10.0">
<p><a href="https://learn.microsoft.com/en-us/iis/get-started/introduction-to-iis/introduction-to-iis-architecture#hypertext-transfer-protocol-stack-httpsys" data-linktype="absolute-path">HTTP.sys</a> is a <a href="httpsys553c.html?view=aspnetcore-9.0" data-linktype="relative-path">web server for ASP.NET Core</a> that only runs on Windows. HTTP.sys is an alternative to <a href="kestrel553c.html?view=aspnetcore-9.0" data-linktype="relative-path">Kestrel</a> server and offers some features that Kestrel doesn't provide.</p>
<div class="IMPORTANT">
<p>Important</p>
<p>HTTP.sys isn't compatible with the <a href="https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/aspnet-core-module?view=aspnetcore-9.0" data-linktype="relative-path">ASP.NET Core Module</a> and can't be used with IIS or IIS Express.</p>
</div>
<p>HTTP.sys supports the following features:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/aspnet/core/security/authentication/windowsauth?view=aspnetcore-9.0" data-linktype="relative-path">Windows Authentication</a></li>
<li>Port sharing</li>
<li>HTTPS with SNI</li>
<li>HTTP/2 over TLS (Windows 10 or later)</li>
<li>HTTP/3 over TLS (Windows 11 or later)</li>
<li>Direct file transmission</li>
<li>Response caching</li>
<li>WebSockets (Windows 8 or later)</li>
<li>Customizable security descriptors</li>
</ul>
<p>Supported Windows versions:</p>
<ul>
<li>Windows 7 or later</li>
<li>Windows Server 2008 R2 or later</li>
</ul>
<p><a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/fundamentals/servers/httpsys/samples" data-linktype="external">View or download sample code</a> (<a href="../../overview553c.html?view=aspnetcore-9.0#how-to-download-a-sample" data-linktype="relative-path">how to download</a>)</p>
<h2 id="when-to-use-httpsys">When to use HTTP.sys</h2>
<p>HTTP.sys is useful for deployments where:</p>
<ul>
<li><p>There's a need to expose the server directly to the Internet without using IIS.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/httpsys-to-internet.png?view=aspnetcore-9.0" alt="HTTP.sys communicates directly with the Internet" data-linktype="relative-path"></p>
</li>
<li><p>An internal deployment requires a feature not available in Kestrel. For more information, see <a href="httpsys553c.html?view=aspnetcore-9.0#kestrel-vs-httpsys" data-linktype="relative-path">Kestrel vs. HTTP.sys</a></p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/httpsys-to-internal.png?view=aspnetcore-9.0" alt="HTTP.sys communicates directly with the internal network" data-linktype="relative-path"></p>
</li>
</ul>
<p>HTTP.sys is mature technology that protects against many types of attacks and provides the robustness, security, and scalability of a full-featured web server. IIS itself runs as an HTTP listener on top of HTTP.sys.</p>
<h2 id="http2-support">HTTP/2 support</h2>
<p><a href="https://httpwg.org/specs/rfc7540.html" data-linktype="external">HTTP/2</a> is enabled for ASP.NET Core apps when the following base requirements are met:</p>
<ul>
<li>Windows Server 2016/Windows 10 or later</li>
<li><a href="https://tools.ietf.org/html/rfc7301#section-3" data-linktype="external">Application-Layer Protocol Negotiation (ALPN)</a> connection</li>
<li>TLS 1.2 or later connection</li>
</ul>
<p>If an HTTP/2 connection is established, <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.http.httprequest.protocol" data-linktype="absolute-path">HttpRequest.Protocol</a> reports <code>HTTP/2</code>.</p>
<p>HTTP/2 is enabled by default. If an HTTP/2 connection isn't established, the connection falls back to HTTP/1.1. In a future release of Windows, HTTP/2 configuration flags will be available, including the ability to disable HTTP/2 with HTTP.sys.</p>
<h2 id="http3-support">HTTP/3 support</h2>
<p><a href="https://datatracker.ietf.org/doc/rfc9114/" data-linktype="external">HTTP/3</a> is enabled for ASP.NET Core apps when the following base requirements are met:</p>
<ul>
<li>Windows Server 2022/Windows 11 or later</li>
<li>An <code>https</code> url binding is used.</li>
<li>The <a href="https://techcommunity.microsoft.com/t5/networking-blog/enabling-http-3-support-on-windows-server-2022/ba-p/2676880" data-linktype="external">EnableHttp3 registry key</a> is set.</li>
</ul>
<p>The preceding Windows 11 Build versions may require the use of a <a href="https://www.microsoft.com/en-us/windowsinsider/" data-linktype="external">Windows Insider</a> build.</p>
<p>HTTP/3 is discovered as an upgrade from HTTP/1.1 or HTTP/2 via the <code>alt-svc</code> header. That means the first request will normally use HTTP/1.1 or HTTP/2 before switching to HTTP/3. Http.Sys doesn't automatically add the <code>alt-svc</code> header, it must be added by the application. The following code is a middleware example that adds the <code>alt-svc</code> response header.</p>
<pre><code class="lang-csharp">app.Use((context, next) =&gt;
{
    context.Response.Headers.AltSvc = "h3=\":443\"";
    return next(context);
});
</code></pre>
<p>Place the preceding code early in the request pipeline.</p>
<p>Http.Sys also supports sending an AltSvc HTTP/2 protocol message rather than a response header to notify the client that HTTP/3 is available. See the <a href="https://techcommunity.microsoft.com/t5/networking-blog/enabling-http-3-support-on-windows-server-2022/ba-p/2676880" data-linktype="external">EnableAltSvc registry key</a>. This requires netsh sslcert bindings that use host names rather than IP addresses.</p>
<h2 id="kernel-mode-authentication-with-kerberos">Kernel mode authentication with Kerberos</h2>
<p>HTTP.sys delegates to kernel mode authentication with the Kerberos authentication protocol. User mode authentication isn't supported with Kerberos and HTTP.sys. The machine account must be used to decrypt the Kerberos token/ticket that's obtained from Active Directory and forwarded by the client to the server to authenticate the user. Register the Service Principal Name (SPN) for the host, not the user of the app.</p>
<h3 id="support-for-kernel-mode-response-buffering">Support for kernel-mode response buffering</h3>
<p>In some scenarios, high volumes of small writes with high latency can cause significant performance impact to <code>HTTP.sys</code>. This impact is due to the lack of a <a href="https://learn.microsoft.com/en-us/dotnet/api/system.io.pipelines.pipe" class="no-loc" data-linktype="absolute-path">Pipe</a> buffer in the <code>HTTP.sys</code> implementation. To improve performance in these scenarios, support for response buffering is included in <code>HTTP.sys</code>. Enable buffering by setting <a href="https://github.com/dotnet/aspnetcore/blob/main/src/Servers/HttpSys/src/HttpSysOptions.cs#L120" data-linktype="external">HttpSysOptions.EnableKernelResponseBuffering</a> to <code>true</code>.
Response buffering should be enabled by an app that does synchronous I/O, or asynchronous I/O with no more than one outstanding write at a time. In these scenarios, response buffering can significantly improve throughput over high-latency connections.</p>
<p>Apps that use asynchronous I/O and that may have more than one write outstanding at a time should <strong><em>not</em></strong> use this flag. Enabling this flag can result in higher CPU and memory usage by HTTP.Sys.</p>
<h2 id="how-to-use-httpsys">How to use HTTP.sys</h2>
<h3 id="configure-the-aspnet-core-app-to-use-httpsys">Configure the ASP.NET Core app to use HTTP.sys</h3>
<p>Call the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.hosting.webhostbuilderhttpsysextensions.usehttpsys" class="no-loc" data-linktype="absolute-path">UseHttpSys</a> extension method when building the host, specifying any required <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions" class="no-loc" data-linktype="absolute-path">HttpSysOptions</a>. The following example sets options to their default values:</p>
<pre><code class="lang-csharp" highlight-lines="8-16">using Microsoft.AspNetCore.Hosting.Server;
using Microsoft.AspNetCore.Hosting.Server.Features;
using Microsoft.AspNetCore.Http.Features;
using Microsoft.AspNetCore.Server.HttpSys;

var builder = WebApplication.CreateBuilder(args);

builder.WebHost.UseHttpSys(options =&gt;
{
    options.AllowSynchronousIO = false;
    options.Authentication.Schemes = AuthenticationSchemes.None;
    options.Authentication.AllowAnonymous = true;
    options.MaxConnections = null;
    options.MaxRequestBodySize = 30_000_000;
    options.UrlPrefixes.Add("http://localhost:5005");
});

builder.Services.AddRazorPages();

var app = builder.Build();
</code></pre>
<p>Additional HTTP.sys configuration is handled through <a href="https://support.microsoft.com/help/820129/http-sys-registry-settings-for-windows" data-linktype="external">registry settings</a>.</p>
<p>For more information about HTTP.sys options, see <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions" class="no-loc" data-linktype="absolute-path">HttpSysOptions</a>.</p>
<h3 id="customize-security-descriptors">Customize security descriptors</h3>
<p>A <em>request queue</em> in HTTP.sys is a kernel-level structure that temporarily stores incoming HTTP requests until your application is ready to process them. Manage access to the request queue by using the <a href="https://source.dot.net/#Microsoft.AspNetCore.Server.HttpSys/HttpSysOptions.cs,a556950881fd2d87" data-linktype="external">RequestQueueSecurityDescriptor</a> property on <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions" class="no-loc" data-linktype="absolute-path">HttpSysOptions</a>. Set it to a <a href="https://learn.microsoft.com/en-us/dotnet/api/system.security.accesscontrol.genericsecuritydescriptor" class="no-loc" data-linktype="absolute-path">GenericSecurityDescriptor</a> instance when configuring your HTTP.sys server.</p>
<p>By customizing the security descriptor, you can allow or deny specific users or groups access to the request queue. This is useful in scenarios where you want to restrict or delegate HTTP.sys request handling at the operating system level.</p>
<p>For example, the following code allows all authenticated users but denies guests:</p>
<pre><code class="lang-csharp">using System.Security.AccessControl;
using System.Security.Principal;
using Microsoft.AspNetCore.Server.HttpSys;

// Create a new security descriptor
var securityDescriptor = new CommonSecurityDescriptor(isContainer: false, isDS: false, sddlForm: string.Empty);

// Create a discretionary access control list (DACL)
var dacl = new DiscretionaryAcl(isContainer: false, isDS: false, capacity: 2);
dacl.AddAccess(
    AccessControlType.Allow,
    new SecurityIdentifier(WellKnownSidType.BuiltinUsersSid, null),
    -1,
    InheritanceFlags.None,
    PropagationFlags.None
);
dacl.AddAccess(
    AccessControlType.Deny,
    new SecurityIdentifier(WellKnownSidType.BuiltinGuestsSid, null),
    -1,
    InheritanceFlags.None,
    PropagationFlags.None
);

// Assign the DACL to the security descriptor
securityDescriptor.DiscretionaryAcl = dacl;

// Configure HTTP.sys options
var builder = WebApplication.CreateBuilder();
builder.WebHost.UseHttpSys(options =&gt;
{
    options.RequestQueueSecurityDescriptor = securityDescriptor;
});
</code></pre>
<p>The <code>RequestQueueSecurityDescriptor</code> property applies only when creating a new request queue. The property doesn't affect existing request queues.</p>
<p><a name="maxrequestbodysize"></a></p>
<p><strong>MaxRequestBodySize</strong></p>
<p>The maximum allowed size of any request body in bytes. When set to <code>null</code>, the maximum request body size is unlimited. This limit has no effect on upgraded connections, which are always unlimited.</p>
<p>The recommended method to override the limit in an ASP.NET Core MVC app for a single <code>IActionResult</code> is to use the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.requestsizelimitattribute" class="no-loc" data-linktype="absolute-path">RequestSizeLimitAttribute</a> attribute on an action method:</p>
<pre><code class="lang-csharp">[RequestSizeLimit(100000000)]
public IActionResult MyActionMethod()
</code></pre>
<p>An exception is thrown if the app attempts to configure the limit on a request after the app has started reading the request. An <code>IsReadOnly</code> property can be used to indicate if the <code>MaxRequestBodySize</code> property is in a read-only state, meaning it's too late to configure the limit.</p>
<p>If the app should override <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.maxrequestbodysize#microsoft-aspnetcore-server-httpsys-httpsysoptions-maxrequestbodysize" class="no-loc" data-linktype="absolute-path">MaxRequestBodySize</a> per-request, use the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.http.features.ihttpmaxrequestbodysizefeature" class="no-loc" data-linktype="absolute-path">IHttpMaxRequestBodySizeFeature</a>:</p>
<pre><code class="lang-csharp" highlight-lines="3-4">app.Use((context, next) =&gt;
{
    context.Features.GetRequiredFeature&lt;IHttpMaxRequestBodySizeFeature&gt;()
                                             .MaxRequestBodySize = 10 * 1024;

    var server = context.RequestServices
        .GetRequiredService&lt;IServer&gt;();
    var serverAddressesFeature = server.Features
                                 .GetRequiredFeature&lt;IServerAddressesFeature&gt;();

    var addresses = string.Join(", ", serverAddressesFeature.Addresses);

    var loggerFactory = context.RequestServices
        .GetRequiredService&lt;ILoggerFactory&gt;();
    var logger = loggerFactory.CreateLogger("Sample");

    logger.LogInformation("Addresses: {addresses}", addresses);

    return next(context);
});
</code></pre>
<p>If using Visual Studio, make sure the app isn't configured to run IIS or IIS Express.</p>
<p>In Visual Studio, the default launch profile is for IIS Express. To run the project as a console app, manually change the selected profile, as shown in the following screenshot:</p>
<p><span class="mx-imgBorder">
<img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/vs-choose-profile.png?view=aspnetcore-9.0" alt="Select console app profile" data-linktype="relative-path">
</span>
</p>
<h3 id="configure-windows-server">Configure Windows Server</h3>
<ol>
<li><p>Determine the ports to open for the app and use <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-firewall/create-an-inbound-port-rule" data-linktype="absolute-path">Windows Firewall</a> or the <a href="https://learn.microsoft.com/en-us/powershell/module/netsecurity/new-netfirewallrule" data-linktype="absolute-path">New-NetFirewallRule</a> PowerShell cmdlet to open firewall ports to allow traffic to reach HTTP.sys. In the following commands and app configuration, port 443 is used.</p>
</li>
<li><p>When deploying to an Azure VM, open the ports in the <a href="https://learn.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal" data-linktype="absolute-path">Network Security Group</a>. In the following commands and app configuration, port 443 is used.</p>
</li>
<li><p>Obtain and install X.509 certificates, if required.</p>
<p>On Windows, create self-signed certificates using the <a href="https://learn.microsoft.com/en-us/powershell/module/pki/new-selfsignedcertificate" data-linktype="absolute-path">New-SelfSignedCertificate PowerShell cmdlet</a>. For an unsupported example, see <a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/includes/make-x509-cert/UpdateIISExpressSSLForChrome.ps1" data-linktype="external">UpdateIISExpressSSLForChrome.ps1</a>.</p>
<p>Install either self-signed or CA-signed certificates in the server's <strong>Local Machine</strong> &gt; <strong>Personal</strong> store.</p>
</li>
<li><p>If the app is a <a href="https://learn.microsoft.com/en-us/dotnet/core/deploying/#framework-dependent-deployments-fdd" data-linktype="absolute-path">framework-dependent deployment</a>, install .NET, .NET Framework, or both (if the app is a .NET app targeting the .NET Framework).</p>
<ul>
<li><strong>.NET</strong>: If the app requires .NET, obtain and run the <strong>.NET Runtime</strong> installer from <a href="https://dotnet.microsoft.com/download" data-linktype="external">.NET Downloads</a>. Don't install the full SDK on the server.</li>
<li><strong>.NET Framework</strong>: If the app requires .NET Framework, see the <a href="https://learn.microsoft.com/en-us/dotnet/framework/install/" data-linktype="absolute-path">.NET Framework installation guide</a>. Install the required .NET Framework. The installer for the latest .NET Framework is available from the <a href="https://dotnet.microsoft.com/download" data-linktype="external">.NET Downloads</a> page.</li>
</ul>
<p>If the app is a <a href="https://learn.microsoft.com/en-us/dotnet/core/deploying/#self-contained-deployments-scd" data-linktype="absolute-path">self-contained deployment</a>, the app includes the runtime in its deployment. No framework installation is required on the server.</p>
</li>
<li><p>Configure URLs and ports in the app.</p>
<p>By default, ASP.NET Core binds to <code>http://localhost:5000</code>. To configure URL prefixes and ports, options include:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.hosting.hostingabstractionswebhostbuilderextensions.useurls" class="no-loc" data-linktype="absolute-path">UseUrls</a></li>
<li><code>urls</code> command-line argument</li>
<li><code>ASPNETCORE_URLS</code> environment variable</li>
<li><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.urlprefixes#microsoft-aspnetcore-server-httpsys-httpsysoptions-urlprefixes" class="no-loc" data-linktype="absolute-path">UrlPrefixes</a></li>
</ul>
<p>The following code example shows how to use <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.urlprefixes#microsoft-aspnetcore-server-httpsys-httpsysoptions-urlprefixes" class="no-loc" data-linktype="absolute-path">UrlPrefixes</a> with the server's local IP address <code>10.0.0.4</code> on port 443:</p>
<pre><code class="lang-csharp" highlight-lines="5">var builder = WebApplication.CreateBuilder(args);

builder.WebHost.UseHttpSys(options =&gt;
{
    options.UrlPrefixes.Add("https://10.0.0.4:443");
});

builder.Services.AddRazorPages();

var app = builder.Build();
</code></pre>
<p>An advantage of <code>UrlPrefixes</code> is that an error message is generated immediately for improperly formatted prefixes.</p>
<p>The settings in <code>UrlPrefixes</code> override <code>UseUrls</code>/<code>urls</code>/<code>ASPNETCORE_URLS</code> settings. Therefore, an advantage of <code>UseUrls</code>, <code>urls</code>, and the <code>ASPNETCORE_URLS</code> environment variable is that it's easier to switch between Kestrel and HTTP.sys.</p>
<p>HTTP.sys recognizes two types of wild cards in URL prefixes:</p>
<ul>
<li><code>*</code> is a <em>weak binding</em>, also known as a <em>fallback binding</em>. If the URL prefix is <code>http://*:5000</code>, and something else is bound to port 5000, this binding won't be used.</li>
<li><code>+</code> is a <em>strong binding</em>. If the URL prefix is <code>http://+:5000</code>, this binding will be used before other port 5000 bindings.</li>
</ul>
<p>For more information, see <a href="https://learn.microsoft.com/en-us/windows/win32/http/urlprefix-strings" data-linktype="absolute-path">UrlPrefix Strings</a>.</p>
<div class="WARNING">
<p>Warning</p>
<p>Top-level wildcard bindings (<code>http://*:80/</code> and <code>http://+:80</code>) should <strong>not</strong> be used. Top-level wildcard bindings create app security vulnerabilities. This applies to both strong and weak wildcards. Use explicit host names or IP addresses rather than wildcards. Subdomain wildcard binding (for example, <code>*.mysub.com</code>) isn't a security risk if you control the entire parent domain (as opposed to <code>*.com</code>, which is vulnerable). For more information, see <a href="https://www.rfc-editor.org/rfc/rfc9110#field.host" data-linktype="external">RFC 9110: Section 7.2: Host and :authority</a>.</p>
</div>
<p>Apps and containers are often given only a port to listen on, like port 80, without additional constraints like host or path. HTTP_PORTS and HTTPS_PORTS are config keys that specify the listening ports for the Kestrel and HTTP.sys servers. These keys may be specified as environment variables defined with the <code>DOTNET_</code> or <code>ASPNETCORE_</code> prefixes, or specified directly through any other config input, such as <code>appsettings.json</code>. Each is a semicolon-delimited list of port values, as shown in the following example:</p>
<pre><code>ASPNETCORE_HTTP_PORTS=80;8080
ASPNETCORE_HTTPS_PORTS=443;8081
</code></pre>
<p>The preceding example is shorthand for the following configuration, which specifies the scheme (HTTP or HTTPS) and any host or IP.</p>
<pre><code>ASPNETCORE_URLS=http://*:80/;http://*:8080/;https://*:443/;https://*:8081/
</code></pre>
<p>The HTTP_PORTS and HTTPS_PORTS configuration keys are lower priority and are overridden by URLS or values provided directly in code. Certificates still need to be configured separately via server-specific mechanics for HTTPS.</p>
<p>These configuration keys are equivalent to top-level wildcard bindings. They're convenient for development and container scenarios, but avoid wildcards when running on a machine that may also host other services.</p>
</li>
<li><p>Preregister URL prefixes on the server.</p>
<p>The built-in tool for configuring HTTP.sys is <em>netsh.exe</em>. <em>netsh.exe</em> is used to reserve URL prefixes and assign X.509 certificates. The tool requires administrator privileges.</p>
<p>Use the <em>netsh.exe</em> tool to register URLs for the app:</p>
<pre><code class="lang-console">netsh http add urlacl url=&lt;URL&gt; user=&lt;USER&gt;
</code></pre>
<ul>
<li><code>&lt;URL&gt;</code>: The fully qualified Uniform Resource Locator (URL). Don't use a wildcard binding. Use a valid hostname or local IP address. <em>The URL must include a trailing slash.</em></li>
<li><code>&lt;USER&gt;</code>: Specifies the user or user-group name.</li>
</ul>
<p>In the following example, the local IP address of the server is <code>10.0.0.4</code>:</p>
<pre><code class="lang-console">netsh http add urlacl url=https://10.0.0.4:443/ user=Users
</code></pre>
<p>When a URL is registered, the tool responds with <code>URL reservation successfully added</code>.</p>
<p>To delete a registered URL, use the <code>delete urlacl</code> command:</p>
<pre><code class="lang-console">netsh http delete urlacl url=&lt;URL&gt;
</code></pre>
</li>
<li><p>Register X.509 certificates on the server.</p>
<p>Use the <em>netsh.exe</em> tool to register certificates for the app:</p>
<pre><code class="lang-console">netsh http add sslcert ipport=&lt;IP&gt;:&lt;PORT&gt; certhash=&lt;THUMBPRINT&gt; appid="{&lt;GUID&gt;}"
</code></pre>
<ul>
<li><code>&lt;IP&gt;</code>: Specifies the local IP address for the binding. Don't use a wildcard binding. Use a valid IP address.</li>
<li><code>&lt;PORT&gt;</code>: Specifies the port for the binding.</li>
<li><code>&lt;THUMBPRINT&gt;</code>: The X.509 certificate thumbprint.</li>
<li><code>&lt;GUID&gt;</code>: A developer-generated GUID to represent the app for informational purposes.</li>
</ul>
<p>For reference purposes, store the GUID in the app as a package tag:</p>
<ul>
<li>In Visual Studio:
<ul>
<li>Open the app's project properties by right-clicking on the app in <strong>Solution Explorer</strong> and selecting <strong>Properties</strong>.</li>
<li>Select the <strong>Package</strong> tab.</li>
<li>Enter the GUID that you created in the <strong>Tags</strong> field.</li>
</ul>
</li>
<li>When not using Visual Studio:
<ul>
<li><p>Open the app's project file.</p>
</li>
<li><p>Add a <code>&lt;PackageTags&gt;</code> property to a new or existing <code>&lt;PropertyGroup&gt;</code> with the GUID that you created:</p>
<pre><code class="lang-xml">&lt;PropertyGroup&gt;
  &lt;PackageTags&gt;00001111-aaaa-2222-bbbb-3333cccc4444&lt;/PackageTags&gt;
&lt;/PropertyGroup&gt;
</code></pre>
</li>
</ul>
</li>
</ul>
<p>In the following example:</p>
<ul>
<li>The local IP address of the server is <code>10.0.0.4</code>.</li>
<li>An online random GUID generator provides the <code>appid</code> value.</li>
</ul>
<pre><code class="lang-console">netsh http add sslcert 
    ipport=10.0.0.4:443 
    certhash=b66ee04419d4ee37464ab8785ff02449980eae10 
    appid="{00001111-aaaa-2222-bbbb-3333cccc4444}"
</code></pre>
<p>When a certificate is registered, the tool responds with <code>SSL Certificate successfully added</code>.</p>
<p>To delete a certificate registration, use the <code>delete sslcert</code> command:</p>
<pre><code class="lang-console">netsh http delete sslcert ipport=&lt;IP&gt;:&lt;PORT&gt;
</code></pre>
<p>Reference documentation for <em>netsh.exe</em>:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc725882(v=ws.10)" data-linktype="absolute-path">Netsh Commands for Hypertext Transfer Protocol (HTTP)</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/http/urlprefix-strings" data-linktype="absolute-path">UrlPrefix Strings</a></li>
</ul>
</li>
<li><p>Run the app.</p>
<p>Administrator privileges aren't required to run the app when binding to localhost using HTTP (not HTTPS) with a port number greater than 1024. For other configurations (for example, using a local IP address or binding to port 443), run the app with administrator privileges.</p>
<p>The app responds at the server's public IP address. In this example, the server is reached from the Internet at its public IP address of <code>104.214.79.47</code>.</p>
<p>A development certificate is used in this example. The page loads securely after bypassing the browser's untrusted certificate warning.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/browser.png?view=aspnetcore-9.0" alt="Browser window showing the app's Index page loaded" data-linktype="relative-path"></p>
</li>
</ol>
<h2 id="proxy-server-and-load-balancer-scenarios">Proxy server and load balancer scenarios</h2>
<p>For apps hosted by HTTP.sys that interact with requests from the Internet or a corporate network, additional configuration might be required when hosting behind proxy servers and load balancers. For more information, see <a href="https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/proxy-load-balancer?view=aspnetcore-9.0" data-linktype="relative-path">Configure ASP.NET Core to work with proxy servers and load balancers</a>.</p>
<p><a name="ihsrtf8"></a></p>
<h2 id="get-detailed-timing-information-with-ihttpsysrequesttimingfeature">Get detailed timing information with IHttpSysRequestTimingFeature</h2>
<!--
<xref:Microsoft.AspNetCore.Server.HttpSys.IHttpSysRequestTimingFeature> 
-->
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.ihttpsysrequesttimingfeature" data-linktype="absolute-path">IHttpSysRequestTimingFeature</a>  provides detailed timing information for requests:</p>
<ul>
<li>Timestamps are obtained using <a href="https://learn.microsoft.com/en-us/windows/win32/api/profileapi/nf-profileapi-queryperformancecounter" data-linktype="absolute-path">QueryPerformanceCounter</a>.</li>
<li>The timestamp frequency can be obtained via <a href="https://learn.microsoft.com/en-us/windows/win32/api/profileapi/nf-profileapi-queryperformancefrequency" data-linktype="absolute-path">QueryPerformanceFrequency</a>.</li>
<li>The index of the timing can be cast to <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysrequesttimingtype" data-linktype="absolute-path">HttpSysRequestTimingType</a> to know what the timing represents.</li>
<li>The value may be 0 if the timing isn't available for the current request.</li>
<li>Requires Windows 10 version 2004, Windows Server 2022, or later.</li>
</ul>
<pre><code class="lang-csharp">using Microsoft.AspNetCore.Http.Features;
using Microsoft.AspNetCore.Server.HttpSys;

var builder = WebApplication.CreateBuilder(args);

builder.WebHost.UseHttpSys();

var app = builder.Build();

app.Use((context, next) =&gt;
{
    var feature = context.Features.GetRequiredFeature&lt;IHttpSysRequestTimingFeature&gt;();
    
    var loggerFactory = context.RequestServices.GetRequiredService&lt;ILoggerFactory&gt;();
    var logger = loggerFactory.CreateLogger("Sample");

    var timestamps = feature.Timestamps;

    for (var i = 0; i &lt; timestamps.Length; i++)
    {
        var timestamp = timestamps[i];
        var timingType = (HttpSysRequestTimingType)i;

        logger.LogInformation("Timestamp {timingType}: {timestamp}",
                                          timingType, timestamp);
    }

    return next(context);
});

app.MapGet("/", () =&gt; Results.Ok());

app.Run();
</code></pre>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.ihttpsysrequesttimingfeature.trygettimestamp" data-linktype="absolute-path">IHttpSysRequestTimingFeature.TryGetTimestamp</a> retrieves the timestamp for the provided timing type:</p>
<pre><code class="lang-csharp">using Microsoft.AspNetCore.Http.Features;
using Microsoft.AspNetCore.Server.HttpSys;
var builder = WebApplication.CreateBuilder(args);

builder.WebHost.UseHttpSys();

var app = builder.Build();

app.Use((context, next) =&gt;
{
    var feature = context.Features.GetRequiredFeature&lt;IHttpSysRequestTimingFeature&gt;();

    var loggerFactory = context.RequestServices.GetRequiredService&lt;ILoggerFactory&gt;();
    var logger = loggerFactory.CreateLogger("Sample");

    var timingType = HttpSysRequestTimingType.RequestRoutingEnd;

    if (feature.TryGetTimestamp(timingType, out var timestamp))
    {
        logger.LogInformation("Timestamp {timingType}: {timestamp}",
                                          timingType, timestamp);
    }
    else
    {
        logger.LogInformation("Timestamp {timingType}: not available for the "
                                           + "current request",    timingType);
    }

    return next(context);
});

app.MapGet("/", () =&gt; Results.Ok());

app.Run();
</code></pre>
<p>[IHttpSysRequestTimingFeature.TryGetElapsedTime](/dotnet/api/microsoft.aspnetcore.server.httpsys.ihttpsysrequesttimingfeature.trygetelapsedtime yields the elapsed time between two specified timings:</p>
<pre><code class="lang-csharp">using Microsoft.AspNetCore.Http.Features;
using Microsoft.AspNetCore.Server.HttpSys;

var builder = WebApplication.CreateBuilder(args);

builder.WebHost.UseHttpSys();

var app = builder.Build();

app.Use((context, next) =&gt;
{
    var feature = context.Features.GetRequiredFeature&lt;IHttpSysRequestTimingFeature&gt;();

    var loggerFactory = context.RequestServices.GetRequiredService&lt;ILoggerFactory&gt;();
    var logger = loggerFactory.CreateLogger("Sample");

    var startingTimingType = HttpSysRequestTimingType.RequestRoutingStart;
    var endingTimingType = HttpSysRequestTimingType.RequestRoutingEnd;

    if (feature.TryGetElapsedTime(startingTimingType, endingTimingType, out var elapsed))
    {
        logger.LogInformation(
            "Elapsed time {startingTimingType} to {endingTimingType}: {elapsed}",
            startingTimingType,
            endingTimingType,
            elapsed);
    }
    else
    {
        logger.LogInformation(
            "Elapsed time {startingTimingType} to {endingTimingType}:"
            + " not available for the current request.",
            startingTimingType,
            endingTimingType);
    }

    return next(context);
});

app.MapGet("/", () =&gt; Results.Ok());

app.Run();
</code></pre>
<h2 id="advanced-http2-features-to-support-grpc">Advanced HTTP/2 features to support gRPC</h2>
<p>Additional HTTP/2 features in HTTP.sys support gRPC, including support for response trailers and sending reset frames.</p>
<p>Requirements to run gRPC with HTTP.sys:</p>
<ul>
<li>Windows 11 Build 22000 or later, Windows Server 2022 Build 20348 or later.</li>
<li>TLS 1.2 or later connection.</li>
</ul>
<h3 id="trailers">Trailers</h3>
<p>HTTP Trailers are similar to HTTP Headers, except they are sent after the response body is sent. For IIS and HTTP.sys, only HTTP/2 response trailers are supported.</p>
<pre><code class="lang-csharp">if (httpContext.Response.SupportsTrailers())
{
    httpContext.Response.DeclareTrailer("trailername");	

    // Write body
    httpContext.Response.WriteAsync("Hello world");

    httpContext.Response.AppendTrailer("trailername", "TrailerValue");
}
</code></pre>
<p>In the preceding example code:</p>
<ul>
<li><code>SupportsTrailers</code> ensures that trailers are supported for the response.</li>
<li><code>DeclareTrailer</code> adds the given trailer name to the <code>Trailer</code> response header. Declaring a response's trailers is optional, but recommended. If <code>DeclareTrailer</code> is called, it must be before the response headers are sent.</li>
<li><code>AppendTrailer</code> appends the trailer.</li>
</ul>
<h3 id="reset">Reset</h3>
<p>Reset allows for the server to reset a HTTP/2 request with a specified error code. A reset request is considered aborted.</p>
<pre><code class="lang-csharp">var resetFeature = httpContext.Features.Get&lt;IHttpResetFeature&gt;();
resetFeature.Reset(errorCode: 2);
</code></pre>
<p><code>Reset</code> in the preceding code example specifies the <code>INTERNAL_ERROR</code> error code. For more information about HTTP/2 error codes, visit the <a href="https://tools.ietf.org/html/rfc7540#page-50" data-linktype="external">HTTP/2 specification error code section</a>.</p>
<h2 id="tracing">Tracing</h2>
<p>For information about how to get traces from HTTP.sys, see <a href="https://learn.microsoft.com/en-us/windows/win32/http/http-sys-manageability-scenarios" data-linktype="absolute-path">HTTP.sys Manageability Scenarios</a>.</p>
<h2 id="additional-resources">Additional resources</h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/aspnet/core/security/authentication/windowsauth?view=aspnetcore-9.0#httpsys" data-linktype="relative-path">Enable Windows Authentication with HTTP.sys</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/http/http-api-start-page" data-linktype="absolute-path">HTTP Server API</a></li>
<li><a href="https://github.com/aspnet/HttpSysServer/" data-linktype="external">aspnet/HttpSysServer GitHub repository (source code)</a></li>
<li><a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/?view=aspnetcore-9.0#host" data-linktype="relative-path">The host</a></li>
<li><a href="../../test/troubleshoot553c.html?view=aspnetcore-9.0" data-linktype="relative-path">Troubleshoot and debug ASP.NET Core projects</a></li>
</ul>
</div>
<div data-moniker="aspnetcore-6.0 aspnetcore-7.0">
<p><a href="https://learn.microsoft.com/en-us/iis/get-started/introduction-to-iis/introduction-to-iis-architecture#hypertext-transfer-protocol-stack-httpsys" data-linktype="absolute-path">HTTP.sys</a> is a <a href="httpsys553c.html?view=aspnetcore-9.0" data-linktype="relative-path">web server for ASP.NET Core</a> that only runs on Windows. HTTP.sys is an alternative to <a href="kestrel553c.html?view=aspnetcore-9.0" data-linktype="relative-path">Kestrel</a> server and offers some features that Kestrel doesn't provide.</p>
<div class="IMPORTANT">
<p>Important</p>
<p>HTTP.sys isn't compatible with the <a href="https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/aspnet-core-module?view=aspnetcore-9.0" data-linktype="relative-path">ASP.NET Core Module</a> and can't be used with IIS or IIS Express.</p>
</div>
<p>HTTP.sys supports the following features:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/aspnet/core/security/authentication/windowsauth?view=aspnetcore-9.0" data-linktype="relative-path">Windows Authentication</a></li>
<li>Port sharing</li>
<li>HTTPS with SNI</li>
<li>HTTP/2 over TLS (Windows 10 or later)</li>
<li>Direct file transmission</li>
<li>Response caching</li>
<li>WebSockets (Windows 8 or later)</li>
</ul>
<p>Supported Windows versions:</p>
<ul>
<li>Windows 7 or later</li>
<li>Windows Server 2008 R2 or later</li>
</ul>
<p><a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/fundamentals/servers/httpsys/samples" data-linktype="external">View or download sample code</a> (<a href="../../overview553c.html?view=aspnetcore-9.0#how-to-download-a-sample" data-linktype="relative-path">how to download</a>)</p>
<h2 id="when-to-use-httpsys">When to use HTTP.sys</h2>
<p>HTTP.sys is useful for deployments where:</p>
<ul>
<li><p>There's a need to expose the server directly to the Internet without using IIS.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/httpsys-to-internet.png?view=aspnetcore-9.0" alt="HTTP.sys communicates directly with the Internet" data-linktype="relative-path"></p>
</li>
<li><p>An internal deployment requires a feature not available in Kestrel. For more information, see <a href="httpsys553c.html?view=aspnetcore-9.0#kestrel-vs-httpsys" data-linktype="relative-path">Kestrel vs. HTTP.sys</a></p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/httpsys-to-internal.png?view=aspnetcore-9.0" alt="HTTP.sys communicates directly with the internal network" data-linktype="relative-path"></p>
</li>
</ul>
<p>HTTP.sys is mature technology that protects against many types of attacks and provides the robustness, security, and scalability of a full-featured web server. IIS itself runs as an HTTP listener on top of HTTP.sys.</p>
<h2 id="http2-support">HTTP/2 support</h2>
<p><a href="https://httpwg.org/specs/rfc7540.html" data-linktype="external">HTTP/2</a> is enabled for ASP.NET Core apps when the following base requirements are met:</p>
<ul>
<li>Windows Server 2016/Windows 10 or later</li>
<li><a href="https://tools.ietf.org/html/rfc7301#section-3" data-linktype="external">Application-Layer Protocol Negotiation (ALPN)</a> connection</li>
<li>TLS 1.2 or later connection</li>
</ul>
<p>If an HTTP/2 connection is established, <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.http.httprequest.protocol" data-linktype="absolute-path">HttpRequest.Protocol</a> reports <code>HTTP/2</code>.</p>
<p>HTTP/2 is enabled by default. If an HTTP/2 connection isn't established, the connection falls back to HTTP/1.1. In a future release of Windows, HTTP/2 configuration flags will be available, including the ability to disable HTTP/2 with HTTP.sys.</p>
<h2 id="http3-support">HTTP/3 support</h2>
<p><a href="https://datatracker.ietf.org/doc/rfc9114/" data-linktype="external">HTTP/3</a> is enabled for ASP.NET Core apps when the following base requirements are met:</p>
<ul>
<li>Windows Server 2022/Windows 11 or later</li>
<li>An <code>https</code> url binding is used.</li>
<li>The <a href="https://techcommunity.microsoft.com/t5/networking-blog/enabling-http-3-support-on-windows-server-2022/ba-p/2676880" data-linktype="external">EnableHttp3 registry key</a> is set.</li>
</ul>
<p>The preceding Windows 11 Build versions may require the use of a <a href="https://insider.windows.com/" data-linktype="external">Windows Insider</a> build.</p>
<p>HTTP/3 is discovered as an upgrade from HTTP/1.1 or HTTP/2 via the <code>alt-svc</code> header. That means the first request will normally use HTTP/1.1 or HTTP/2 before switching to HTTP/3. Http.Sys doesn't automatically add the <code>alt-svc</code> header, it must be added by the application. The following code is a middleware example that adds the <code>alt-svc</code> response header.</p>
<pre><code class="lang-csharp">app.Use((context, next) =&gt;
{
    context.Response.Headers.AltSvc = "h3=\":443\"";
    return next(context);
});
</code></pre>
<p>Place the preceding code early in the request pipeline.</p>
<p>Http.Sys also supports sending an AltSvc HTTP/2 protocol message rather than a response header to notify the client that HTTP/3 is available. See the <a href="https://techcommunity.microsoft.com/t5/networking-blog/enabling-http-3-support-on-windows-server-2022/ba-p/2676880" data-linktype="external">EnableAltSvc registry key</a>. This requires netsh sslcert bindings that use host names rather than IP addresses.</p>
<h2 id="kernel-mode-authentication-with-kerberos">Kernel mode authentication with Kerberos</h2>
<p>HTTP.sys delegates to kernel mode authentication with the Kerberos authentication protocol. User mode authentication isn't supported with Kerberos and HTTP.sys. The machine account must be used to decrypt the Kerberos token/ticket that's obtained from Active Directory and forwarded by the client to the server to authenticate the user. Register the Service Principal Name (SPN) for the host, not the user of the app.</p>
<h2 id="how-to-use-httpsys">How to use HTTP.sys</h2>
<h3 id="configure-the-aspnet-core-app-to-use-httpsys">Configure the ASP.NET Core app to use HTTP.sys</h3>
<p>Call the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.hosting.webhostbuilderhttpsysextensions.usehttpsys" class="no-loc" data-linktype="absolute-path">UseHttpSys</a> extension method when building the host, specifying any required <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions" class="no-loc" data-linktype="absolute-path">HttpSysOptions</a>. The following example sets options to their default values:</p>
<pre><code class="lang-csharp" highlight-lines="5-13">public static IHostBuilder CreateHostBuilder(string[] args) =&gt;
    Host.CreateDefaultBuilder(args)
        .ConfigureWebHostDefaults(webBuilder =&gt;
        {
            webBuilder.UseHttpSys(options =&gt;
            {
                options.AllowSynchronousIO = false;
                options.Authentication.Schemes = AuthenticationSchemes.None;
                options.Authentication.AllowAnonymous = true;
                options.MaxConnections = null;
                options.MaxRequestBodySize = 30000000;
                options.UrlPrefixes.Add("http://localhost:5005");
            });
            webBuilder.UseStartup&lt;Startup&gt;();
        });
</code></pre>
<p>Additional HTTP.sys configuration is handled through <a href="https://support.microsoft.com/help/820129/http-sys-registry-settings-for-windows" data-linktype="external">registry settings</a>.</p>
<p>For more information about HTTP.sys options, see <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions" class="no-loc" data-linktype="absolute-path">HttpSysOptions</a>.</p>
<p><a name="maxrequestbodysize"></a></p>
<p><strong>MaxRequestBodySize</strong></p>
<p>The maximum allowed size of any request body in bytes. When set to <code>null</code>, the maximum request body size is unlimited. This limit has no effect on upgraded connections, which are always unlimited.</p>
<p>The recommended method to override the limit in an ASP.NET Core MVC app for a single <code>IActionResult</code> is to use the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.requestsizelimitattribute" class="no-loc" data-linktype="absolute-path">RequestSizeLimitAttribute</a> attribute on an action method:</p>
<pre><code class="lang-csharp">[RequestSizeLimit(100000000)]
public IActionResult MyActionMethod()
</code></pre>
<p>An exception is thrown if the app attempts to configure the limit on a request after the app has started reading the request. An <code>IsReadOnly</code> property can be used to indicate if the <code>MaxRequestBodySize</code> property is in a read-only state, meaning it's too late to configure the limit.</p>
<p>If the app should override <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.maxrequestbodysize#microsoft-aspnetcore-server-httpsys-httpsysoptions-maxrequestbodysize" class="no-loc" data-linktype="absolute-path">MaxRequestBodySize</a> per-request, use the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.http.features.ihttpmaxrequestbodysizefeature" class="no-loc" data-linktype="absolute-path">IHttpMaxRequestBodySizeFeature</a>:</p>
<pre><code class="lang-csharp" highlight-lines="6-7">public void Configure(IApplicationBuilder app, IWebHostEnvironment env, 
    ILogger&lt;Startup&gt; logger, IServer server)
{
    app.Use(async (context, next) =&gt;
    {
        context.Features.Get&lt;IHttpMaxRequestBodySizeFeature&gt;()
            .MaxRequestBodySize = 10 * 1024;

        var serverAddressesFeature = 
            app.ServerFeatures.Get&lt;IServerAddressesFeature&gt;();
        var addresses = string.Join(", ", serverAddressesFeature?.Addresses);

        logger.LogInformation("Addresses: {Addresses}", addresses);

        await next.Invoke();
    });

    if (env.IsDevelopment())
    {
        app.UseDeveloperExceptionPage();
    }
    else
    {
        app.UseExceptionHandler("/Error");
    }

    app.UseStaticFiles();
    app.UseRouting();

    app.UseEndpoints(endpoints =&gt;
    {
        endpoints.MapRazorPages();
    });
}
</code></pre>
<p>If using Visual Studio, make sure the app isn't configured to run IIS or IIS Express.</p>
<p>In Visual Studio, the default launch profile is for IIS Express. To run the project as a console app, manually change the selected profile, as shown in the following screenshot:</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/vs-choose-profile.png?view=aspnetcore-9.0" alt="Select console app profile" data-linktype="relative-path"></p>
<h3 id="configure-windows-server">Configure Windows Server</h3>
<ol>
<li><p>Determine the ports to open for the app and use <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-firewall/create-an-inbound-port-rule" data-linktype="absolute-path">Windows Firewall</a> or the <a href="https://learn.microsoft.com/en-us/powershell/module/netsecurity/new-netfirewallrule" data-linktype="absolute-path">New-NetFirewallRule</a> PowerShell cmdlet to open firewall ports to allow traffic to reach HTTP.sys. In the following commands and app configuration, port 443 is used.</p>
</li>
<li><p>When deploying to an Azure VM, open the ports in the <a href="https://learn.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal" data-linktype="absolute-path">Network Security Group</a>. In the following commands and app configuration, port 443 is used.</p>
</li>
<li><p>Obtain and install X.509 certificates, if required.</p>
<p>On Windows, create self-signed certificates using the <a href="https://learn.microsoft.com/en-us/powershell/module/pki/new-selfsignedcertificate" data-linktype="absolute-path">New-SelfSignedCertificate PowerShell cmdlet</a>. For an unsupported example, see <a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/includes/make-x509-cert/UpdateIISExpressSSLForChrome.ps1" data-linktype="external">UpdateIISExpressSSLForChrome.ps1</a>.</p>
<p>Install either self-signed or CA-signed certificates in the server's <strong>Local Machine</strong> &gt; <strong>Personal</strong> store.</p>
</li>
<li><p>If the app is a <a href="https://learn.microsoft.com/en-us/dotnet/core/deploying/#framework-dependent-deployments-fdd" data-linktype="absolute-path">framework-dependent deployment</a>, install .NET, .NET Framework, or both (if the app is a .NET app targeting the .NET Framework).</p>
<ul>
<li><strong>.NET</strong>: If the app requires .NET, obtain and run the <strong>.NET Runtime</strong> installer from <a href="https://dotnet.microsoft.com/download" data-linktype="external">.NET Downloads</a>. Don't install the full SDK on the server.</li>
<li><strong>.NET Framework</strong>: If the app requires .NET Framework, see the <a href="https://learn.microsoft.com/en-us/dotnet/framework/install/" data-linktype="absolute-path">.NET Framework installation guide</a>. Install the required .NET Framework. The installer for the latest .NET Framework is available from the <a href="https://dotnet.microsoft.com/download" data-linktype="external">.NET Downloads</a> page.</li>
</ul>
<p>If the app is a <a href="https://learn.microsoft.com/en-us/dotnet/core/deploying/#self-contained-deployments-scd" data-linktype="absolute-path">self-contained deployment</a>, the app includes the runtime in its deployment. No framework installation is required on the server.</p>
</li>
<li><p>Configure URLs and ports in the app.</p>
<p>By default, ASP.NET Core binds to <code>http://localhost:5000</code>. To configure URL prefixes and ports, options include:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.hosting.hostingabstractionswebhostbuilderextensions.useurls" class="no-loc" data-linktype="absolute-path">UseUrls</a></li>
<li><code>urls</code> command-line argument</li>
<li><code>ASPNETCORE_URLS</code> environment variable</li>
<li><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.urlprefixes#microsoft-aspnetcore-server-httpsys-httpsysoptions-urlprefixes" class="no-loc" data-linktype="absolute-path">UrlPrefixes</a></li>
</ul>
<p>The following code example shows how to use <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.urlprefixes#microsoft-aspnetcore-server-httpsys-httpsysoptions-urlprefixes" class="no-loc" data-linktype="absolute-path">UrlPrefixes</a> with the server's local IP address <code>10.0.0.4</code> on port 443:</p>
<pre><code class="lang-csharp" highlight-lines="7">public static IHostBuilder CreateHostBuilder(string[] args) =&gt;
    Host.CreateDefaultBuilder(args)
        .ConfigureWebHostDefaults(webBuilder =&gt;
        {
            webBuilder.UseHttpSys(options =&gt;
            {
                options.UrlPrefixes.Add("https://10.0.0.4:443");
            });
            webBuilder.UseStartup&lt;Startup&gt;();
        });
</code></pre>
<p>An advantage of <code>UrlPrefixes</code> is that an error message is generated immediately for improperly formatted prefixes.</p>
<p>The settings in <code>UrlPrefixes</code> override <code>UseUrls</code>/<code>urls</code>/<code>ASPNETCORE_URLS</code> settings. Therefore, an advantage of <code>UseUrls</code>, <code>urls</code>, and the <code>ASPNETCORE_URLS</code> environment variable is that it's easier to switch between Kestrel and HTTP.sys.</p>
<p>HTTP.sys uses the <a href="https://learn.microsoft.com/en-us/windows/win32/http/urlprefix-strings" data-linktype="absolute-path">HTTP Server API UrlPrefix string formats</a>.</p>
<div class="WARNING">
<p>Warning</p>
<p>Top-level wildcard bindings (<code>http://*:80/</code> and <code>http://+:80</code>) should <strong>not</strong> be used. Top-level wildcard bindings create app security vulnerabilities. This applies to both strong and weak wildcards. Use explicit host names or IP addresses rather than wildcards. Subdomain wildcard binding (for example, <code>*.mysub.com</code>) isn't a security risk if you control the entire parent domain (as opposed to <code>*.com</code>, which is vulnerable). For more information, see <a href="https://www.rfc-editor.org/rfc/rfc9110#field.host" data-linktype="external">RFC 9110: Section 7.2: Host and :authority</a>.</p>
</div>
</li>
<li><p>Preregister URL prefixes on the server.</p>
<p>The built-in tool for configuring HTTP.sys is <em>netsh.exe</em>. <em>netsh.exe</em> is used to reserve URL prefixes and assign X.509 certificates. The tool requires administrator privileges.</p>
<p>Use the <em>netsh.exe</em> tool to register URLs for the app:</p>
<pre><code class="lang-console">netsh http add urlacl url=&lt;URL&gt; user=&lt;USER&gt;
</code></pre>
<ul>
<li><code>&lt;URL&gt;</code>: The fully qualified Uniform Resource Locator (URL). Don't use a wildcard binding. Use a valid hostname or local IP address. <em>The URL must include a trailing slash.</em></li>
<li><code>&lt;USER&gt;</code>: Specifies the user or user-group name.</li>
</ul>
<p>In the following example, the local IP address of the server is <code>10.0.0.4</code>:</p>
<pre><code class="lang-console">netsh http add urlacl url=https://10.0.0.4:443/ user=Users
</code></pre>
<p>When a URL is registered, the tool responds with <code>URL reservation successfully added</code>.</p>
<p>To delete a registered URL, use the <code>delete urlacl</code> command:</p>
<pre><code class="lang-console">netsh http delete urlacl url=&lt;URL&gt;
</code></pre>
</li>
<li><p>Register X.509 certificates on the server.</p>
<p>Use the <em>netsh.exe</em> tool to register certificates for the app:</p>
<pre><code class="lang-console">netsh http add sslcert ipport=&lt;IP&gt;:&lt;PORT&gt; certhash=&lt;THUMBPRINT&gt; appid="{&lt;GUID&gt;}"
</code></pre>
<ul>
<li><code>&lt;IP&gt;</code>: Specifies the local IP address for the binding. Don't use a wildcard binding. Use a valid IP address.</li>
<li><code>&lt;PORT&gt;</code>: Specifies the port for the binding.</li>
<li><code>&lt;THUMBPRINT&gt;</code>: The X.509 certificate thumbprint.</li>
<li><code>&lt;GUID&gt;</code>: A developer-generated GUID to represent the app for informational purposes.</li>
</ul>
<p>For reference purposes, store the GUID in the app as a package tag:</p>
<ul>
<li>In Visual Studio:
<ul>
<li>Open the app's project properties by right-clicking on the app in <strong>Solution Explorer</strong> and selecting <strong>Properties</strong>.</li>
<li>Select the <strong>Package</strong> tab.</li>
<li>Enter the GUID that you created in the <strong>Tags</strong> field.</li>
</ul>
</li>
<li>When not using Visual Studio:
<ul>
<li><p>Open the app's project file.</p>
</li>
<li><p>Add a <code>&lt;PackageTags&gt;</code> property to a new or existing <code>&lt;PropertyGroup&gt;</code> with the GUID that you created:</p>
<pre><code class="lang-xml">&lt;PropertyGroup&gt;
  &lt;PackageTags&gt;00001111-aaaa-2222-bbbb-3333cccc4444&lt;/PackageTags&gt;
&lt;/PropertyGroup&gt;
</code></pre>
</li>
</ul>
</li>
</ul>
<p>In the following example:</p>
<ul>
<li>The local IP address of the server is <code>10.0.0.4</code>.</li>
<li>An online random GUID generator provides the <code>appid</code> value.</li>
</ul>
<pre><code class="lang-console">netsh http add sslcert 
    ipport=10.0.0.4:443 
    certhash=b66ee04419d4ee37464ab8785ff02449980eae10 
    appid="{00001111-aaaa-2222-bbbb-3333cccc4444}"
</code></pre>
<p>When a certificate is registered, the tool responds with <code>SSL Certificate successfully added</code>.</p>
<p>To delete a certificate registration, use the <code>delete sslcert</code> command:</p>
<pre><code class="lang-console">netsh http delete sslcert ipport=&lt;IP&gt;:&lt;PORT&gt;
</code></pre>
<p>Reference documentation for <em>netsh.exe</em>:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc725882(v=ws.10)" data-linktype="absolute-path">Netsh Commands for Hypertext Transfer Protocol (HTTP)</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/http/urlprefix-strings" data-linktype="absolute-path">UrlPrefix Strings</a></li>
</ul>
</li>
<li><p>Run the app.</p>
<p>Administrator privileges aren't required to run the app when binding to localhost using HTTP (not HTTPS) with a port number greater than 1024. For other configurations (for example, using a local IP address or binding to port 443), run the app with administrator privileges.</p>
<p>The app responds at the server's public IP address. In this example, the server is reached from the Internet at its public IP address of <code>104.214.79.47</code>.</p>
<p>A development certificate is used in this example. The page loads securely after bypassing the browser's untrusted certificate warning.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/browser.png?view=aspnetcore-9.0" alt="Browser window showing the app's Index page loaded" data-linktype="relative-path"></p>
</li>
</ol>
<h2 id="proxy-server-and-load-balancer-scenarios">Proxy server and load balancer scenarios</h2>
<p>For apps hosted by HTTP.sys that interact with requests from the Internet or a corporate network, additional configuration might be required when hosting behind proxy servers and load balancers. For more information, see <a href="https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/proxy-load-balancer?view=aspnetcore-9.0" data-linktype="relative-path">Configure ASP.NET Core to work with proxy servers and load balancers</a>.</p>
<h2 id="advanced-http2-features-to-support-grpc">Advanced HTTP/2 features to support gRPC</h2>
<p>Additional HTTP/2 features in HTTP.sys support gRPC, including support for response trailers and sending reset frames.</p>
<p>Requirements to run gRPC with HTTP.sys:</p>
<ul>
<li>Windows 11 Build 22000 or later, Windows Server 2022 Build 20348 or later.</li>
<li>TLS 1.2 or later connection.</li>
</ul>
<h3 id="trailers">Trailers</h3>
<p>HTTP Trailers are similar to HTTP Headers, except they are sent after the response body is sent. For IIS and HTTP.sys, only HTTP/2 response trailers are supported.</p>
<pre><code class="lang-csharp">if (httpContext.Response.SupportsTrailers())
{
    httpContext.Response.DeclareTrailer("trailername");	

    // Write body
    httpContext.Response.WriteAsync("Hello world");

    httpContext.Response.AppendTrailer("trailername", "TrailerValue");
}
</code></pre>
<p>In the preceding example code:</p>
<ul>
<li><code>SupportsTrailers</code> ensures that trailers are supported for the response.</li>
<li><code>DeclareTrailer</code> adds the given trailer name to the <code>Trailer</code> response header. Declaring a response's trailers is optional, but recommended. If <code>DeclareTrailer</code> is called, it must be before the response headers are sent.</li>
<li><code>AppendTrailer</code> appends the trailer.</li>
</ul>
<h3 id="reset">Reset</h3>
<p>Reset allows for the server to reset a HTTP/2 request with a specified error code. A reset request is considered aborted.</p>
<pre><code class="lang-csharp">var resetFeature = httpContext.Features.Get&lt;IHttpResetFeature&gt;();
resetFeature.Reset(errorCode: 2);
</code></pre>
<p><code>Reset</code> in the preceding code example specifies the <code>INTERNAL_ERROR</code> error code. For more information about HTTP/2 error codes, visit the <a href="https://tools.ietf.org/html/rfc7540#page-50" data-linktype="external">HTTP/2 specification error code section</a>.</p>
<h2 id="additional-resources">Additional resources</h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/aspnet/core/security/authentication/windowsauth?view=aspnetcore-9.0#httpsys" data-linktype="relative-path">Enable Windows Authentication with HTTP.sys</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/http/http-api-start-page" data-linktype="absolute-path">HTTP Server API</a></li>
<li><a href="https://github.com/aspnet/HttpSysServer/" data-linktype="external">aspnet/HttpSysServer GitHub repository (source code)</a></li>
<li><a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/?view=aspnetcore-9.0#host" data-linktype="relative-path">The host</a></li>
<li><a href="../../test/troubleshoot553c.html?view=aspnetcore-9.0" data-linktype="relative-path">Troubleshoot and debug ASP.NET Core projects</a></li>
</ul>
</div>
<div data-moniker="aspnetcore-2.1 aspnetcore-2.2 aspnetcore-3.0 aspnetcore-3.1 aspnetcore-5.0">
<p><a href="https://learn.microsoft.com/en-us/iis/get-started/introduction-to-iis/introduction-to-iis-architecture#hypertext-transfer-protocol-stack-httpsys" data-linktype="absolute-path">HTTP.sys</a> is a <a href="httpsys553c.html?view=aspnetcore-9.0" data-linktype="relative-path">web server for ASP.NET Core</a> that only runs on Windows. HTTP.sys is an alternative to <a href="kestrel553c.html?view=aspnetcore-9.0" data-linktype="relative-path">Kestrel</a> server and offers some features that Kestrel doesn't provide.</p>
<div class="IMPORTANT">
<p>Important</p>
<p>HTTP.sys isn't compatible with the <a href="https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/aspnet-core-module?view=aspnetcore-9.0" data-linktype="relative-path">ASP.NET Core Module</a> and can't be used with IIS or IIS Express.</p>
</div>
<p>HTTP.sys supports the following features:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/aspnet/core/security/authentication/windowsauth?view=aspnetcore-9.0" data-linktype="relative-path">Windows Authentication</a></li>
<li>Port sharing</li>
<li>HTTPS with SNI</li>
<li>HTTP/2 over TLS (Windows 10 or later)</li>
<li>Direct file transmission</li>
<li>Response caching</li>
<li>WebSockets (Windows 8 or later)</li>
</ul>
<p>Supported Windows versions:</p>
<ul>
<li>Windows 7 or later</li>
<li>Windows Server 2008 R2 or later</li>
</ul>
<p><a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/fundamentals/servers/httpsys/samples" data-linktype="external">View or download sample code</a> (<a href="../../overview553c.html?view=aspnetcore-9.0#how-to-download-a-sample" data-linktype="relative-path">how to download</a>)</p>
<h2 id="when-to-use-httpsys-1">When to use HTTP.sys</h2>
<p>HTTP.sys is useful for deployments where:</p>
<ul>
<li><p>There's a need to expose the server directly to the Internet without using IIS.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/httpsys-to-internet.png?view=aspnetcore-9.0" alt="HTTP.sys communicates directly with the Internet" data-linktype="relative-path"></p>
</li>
<li><p>An internal deployment requires a feature not available in Kestrel. For more information, see <a href="httpsys553c.html?view=aspnetcore-9.0#kestrel-vs-httpsys" data-linktype="relative-path">Kestrel vs. HTTP.sys</a></p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/httpsys-to-internal.png?view=aspnetcore-9.0" alt="HTTP.sys communicates directly with the internal network" data-linktype="relative-path"></p>
</li>
</ul>
<p>HTTP.sys is mature technology that protects against many types of attacks and provides the robustness, security, and scalability of a full-featured web server. IIS itself runs as an HTTP listener on top of HTTP.sys.</p>
<h2 id="http2-support-1">HTTP/2 support</h2>
<p><a href="https://httpwg.org/specs/rfc7540.html" data-linktype="external">HTTP/2</a> is enabled for ASP.NET Core apps if the following base requirements are met:</p>
<ul>
<li>Windows Server 2016/Windows 10 or later</li>
<li><a href="https://tools.ietf.org/html/rfc7301#section-3" data-linktype="external">Application-Layer Protocol Negotiation (ALPN)</a> connection</li>
<li>TLS 1.2 or later connection</li>
</ul>
<p>If an HTTP/2 connection is established, <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.http.httprequest.protocol" data-linktype="absolute-path">HttpRequest.Protocol</a> reports <code>HTTP/2</code>.</p>
<p>HTTP/2 is enabled by default. If an HTTP/2 connection isn't established, the connection falls back to HTTP/1.1. In a future release of Windows, HTTP/2 configuration flags will be available, including the ability to disable HTTP/2 with HTTP.sys.</p>
<h2 id="kernel-mode-authentication-with-kerberos-1">Kernel mode authentication with Kerberos</h2>
<p>HTTP.sys delegates to kernel mode authentication with the Kerberos authentication protocol. User mode authentication isn't supported with Kerberos and HTTP.sys. The machine account must be used to decrypt the Kerberos token/ticket that's obtained from Active Directory and forwarded by the client to the server to authenticate the user. Register the Service Principal Name (SPN) for the host, not the user of the app.</p>
<h2 id="how-to-use-httpsys-1">How to use HTTP.sys</h2>
<h3 id="configure-the-aspnet-core-app-to-use-httpsys-1">Configure the ASP.NET Core app to use HTTP.sys</h3>
<p>Call the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.hosting.webhostbuilderhttpsysextensions.usehttpsys" class="no-loc" data-linktype="absolute-path">UseHttpSys</a> extension method when building the host, specifying any required <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions" class="no-loc" data-linktype="absolute-path">HttpSysOptions</a>. The following example sets options to their default values:</p>
<pre><code class="lang-csharp" highlight-lines="5-13">public static IHostBuilder CreateHostBuilder(string[] args) =&gt;
    Host.CreateDefaultBuilder(args)
        .ConfigureWebHostDefaults(webBuilder =&gt;
        {
            webBuilder.UseHttpSys(options =&gt;
            {
                options.AllowSynchronousIO = false;
                options.Authentication.Schemes = AuthenticationSchemes.None;
                options.Authentication.AllowAnonymous = true;
                options.MaxConnections = null;
                options.MaxRequestBodySize = 30000000;
                options.UrlPrefixes.Add("http://localhost:5005");
            });
            webBuilder.UseStartup&lt;Startup&gt;();
        });
</code></pre>
<p>Additional HTTP.sys configuration is handled through <a href="https://support.microsoft.com/help/820129/http-sys-registry-settings-for-windows" data-linktype="external">registry settings</a>.</p>
<p><strong>HTTP.sys options</strong></p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
<th style="text-align: center;">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.allowsynchronousio#microsoft-aspnetcore-server-httpsys-httpsysoptions-allowsynchronousio" class="no-loc" data-linktype="absolute-path">AllowSynchronousIO</a></td>
<td>Control whether synchronous input/output is allowed for the <code>HttpContext.Request.Body</code> and <code>HttpContext.Response.Body</code>.</td>
<td style="text-align: center;"><code>false</code></td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.authenticationmanager.allowanonymous#microsoft-aspnetcore-server-httpsys-authenticationmanager-allowanonymous" data-linktype="absolute-path">Authentication.AllowAnonymous</a></td>
<td>Allow anonymous requests.</td>
<td style="text-align: center;"><code>true</code></td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.authenticationmanager.schemes#microsoft-aspnetcore-server-httpsys-authenticationmanager-schemes" data-linktype="absolute-path">Authentication.Schemes</a></td>
<td>Specify the allowed authentication schemes. May be modified at any time prior to disposing the listener. Values are provided by the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.authenticationschemes" data-linktype="absolute-path">AuthenticationSchemes enum</a>: <code>Basic</code>, <code>Kerberos</code>, <code>Negotiate</code>, <code>None</code>, and <code>NTLM</code>.</td>
<td style="text-align: center;"><code>None</code></td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.enableresponsecaching#microsoft-aspnetcore-server-httpsys-httpsysoptions-enableresponsecaching" class="no-loc" data-linktype="absolute-path">EnableResponseCaching</a></td>
<td>Attempt <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/gettingstarted/user-mode-and-kernel-mode" data-linktype="absolute-path">kernel-mode</a> caching for responses with eligible headers. The response may not include <code>Set-Cookie</code>, <code>Vary</code>, or <code>Pragma</code> headers. It must include a <code>Cache-Control</code> header that's <code>public</code> and either a <code>shared-max-age</code> or <code>max-age</code> value, or an <code>Expires</code> header.</td>
<td style="text-align: center;"><code>true</code></td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.http503verbosity#microsoft-aspnetcore-server-httpsys-httpsysoptions-http503verbosity" class="no-loc" data-linktype="absolute-path">Http503Verbosity</a></td>
<td>The HTTP.sys behavior when rejecting requests due to throttling conditions.</td>
<td style="text-align: center;"><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.http503verbositylevel" data-linktype="absolute-path">Http503VerbosityLevel.<br>Basic</a></td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.maxaccepts#microsoft-aspnetcore-server-httpsys-httpsysoptions-maxaccepts" class="no-loc" data-linktype="absolute-path">MaxAccepts</a></td>
<td>The maximum number of concurrent accepts.</td>
<td style="text-align: center;">5 × <a href="https://learn.microsoft.com/en-us/dotnet/api/system.environment.processorcount#system-environment-processorcount" data-linktype="absolute-path">Environment.<br>ProcessorCount</a></td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.maxconnections#microsoft-aspnetcore-server-httpsys-httpsysoptions-maxconnections" class="no-loc" data-linktype="absolute-path">MaxConnections</a></td>
<td>The maximum number of concurrent connections to accept. Use <code>-1</code> for infinite. Use <code>null</code> to use the registry's machine-wide setting.</td>
<td style="text-align: center;"><code>null</code><br>(machine-wide<br>setting)</td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.maxrequestbodysize#microsoft-aspnetcore-server-httpsys-httpsysoptions-maxrequestbodysize" class="no-loc" data-linktype="absolute-path">MaxRequestBodySize</a></td>
<td>See the <a href="#maxrequestbodysize" data-linktype="self-bookmark">MaxRequestBodySize</a> section.</td>
<td style="text-align: center;">30000000 bytes<br>(~28.6 MB)</td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.requestqueuelimit#microsoft-aspnetcore-server-httpsys-httpsysoptions-requestqueuelimit" class="no-loc" data-linktype="absolute-path">RequestQueueLimit</a></td>
<td>The maximum number of requests that can be queued.</td>
<td style="text-align: center;">1000</td>
</tr>
<tr>
<td><code>RequestQueueMode</code></td>
<td>This indicates whether the server is responsible for creating and configuring the request queue, or if it should attach to an existing queue.<br>Most existing configuration options do not apply when attaching to an existing queue.</td>
<td style="text-align: center;"><code>RequestQueueMode.Create</code></td>
</tr>
<tr>
<td><code>RequestQueueName</code></td>
<td>The name of the HTTP.sys request queue.</td>
<td style="text-align: center;"><code>null</code> (Anonymous queue)</td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.throwwriteexceptions#microsoft-aspnetcore-server-httpsys-httpsysoptions-throwwriteexceptions" class="no-loc" data-linktype="absolute-path">ThrowWriteExceptions</a></td>
<td>Indicate if response body writes that fail due to client disconnects should throw exceptions or complete normally.</td>
<td style="text-align: center;"><code>false</code><br>(complete normally)</td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.timeouts#microsoft-aspnetcore-server-httpsys-httpsysoptions-timeouts" class="no-loc" data-linktype="absolute-path">Timeouts</a></td>
<td>Expose the HTTP.sys <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.timeoutmanager" class="no-loc" data-linktype="absolute-path">TimeoutManager</a> configuration, which may also be configured in the registry. Follow the API links to learn more about each setting, including default values:<ul><li><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.timeoutmanager.drainentitybody#microsoft-aspnetcore-server-httpsys-timeoutmanager-drainentitybody" class="no-loc" data-linktype="absolute-path">TimeoutManager.DrainEntityBody</a>: Time allowed for the HTTP Server API to drain the entity body on a Keep-Alive connection.</li><li><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.timeoutmanager.entitybody#microsoft-aspnetcore-server-httpsys-timeoutmanager-entitybody" class="no-loc" data-linktype="absolute-path">TimeoutManager.EntityBody</a>: Time allowed for the request entity body to arrive.</li><li><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.timeoutmanager.headerwait#microsoft-aspnetcore-server-httpsys-timeoutmanager-headerwait" class="no-loc" data-linktype="absolute-path">TimeoutManager.HeaderWait</a>: Time allowed for the HTTP Server API to parse the request header.</li><li><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.timeoutmanager.idleconnection#microsoft-aspnetcore-server-httpsys-timeoutmanager-idleconnection" class="no-loc" data-linktype="absolute-path">TimeoutManager.IdleConnection</a>: Time allowed for an idle connection.</li><li><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.timeoutmanager.minsendbytespersecond#microsoft-aspnetcore-server-httpsys-timeoutmanager-minsendbytespersecond" class="no-loc" data-linktype="absolute-path">TimeoutManager.MinSendBytesPerSecond</a>: The minimum send rate for the response.</li><li><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.timeoutmanager.requestqueue#microsoft-aspnetcore-server-httpsys-timeoutmanager-requestqueue" class="no-loc" data-linktype="absolute-path">TimeoutManager.RequestQueue</a>: Time allowed for the request to remain in the request queue before the app picks it up.</li></ul></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.urlprefixes#microsoft-aspnetcore-server-httpsys-httpsysoptions-urlprefixes" class="no-loc" data-linktype="absolute-path">UrlPrefixes</a></td>
<td>Specify the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.urlprefixcollection" class="no-loc" data-linktype="absolute-path">UrlPrefixCollection</a> to register with HTTP.sys. The most useful is <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.urlprefixcollection.add" class="no-loc" data-linktype="absolute-path">UrlPrefixCollection.Add</a>, which is used to add a prefix to the collection. These may be modified at any time prior to disposing the listener.</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p><a name="maxrequestbodysize"></a></p>
<p><strong>MaxRequestBodySize</strong></p>
<p>The maximum allowed size of any request body in bytes. When set to <code>null</code>, the maximum request body size is unlimited. This limit has no effect on upgraded connections, which are always unlimited.</p>
<p>The recommended method to override the limit in an ASP.NET Core MVC app for a single <code>IActionResult</code> is to use the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.requestsizelimitattribute" class="no-loc" data-linktype="absolute-path">RequestSizeLimitAttribute</a> attribute on an action method:</p>
<pre><code class="lang-csharp">[RequestSizeLimit(100000000)]
public IActionResult MyActionMethod()
</code></pre>
<p>An exception is thrown if the app attempts to configure the limit on a request after the app has started reading the request. An <code>IsReadOnly</code> property can be used to indicate if the <code>MaxRequestBodySize</code> property is in a read-only state, meaning it's too late to configure the limit.</p>
<p>If the app should override <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.maxrequestbodysize#microsoft-aspnetcore-server-httpsys-httpsysoptions-maxrequestbodysize" class="no-loc" data-linktype="absolute-path">MaxRequestBodySize</a> per-request, use the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.http.features.ihttpmaxrequestbodysizefeature" class="no-loc" data-linktype="absolute-path">IHttpMaxRequestBodySizeFeature</a>:</p>
<pre><code class="lang-csharp" highlight-lines="6-7">public void Configure(IApplicationBuilder app, IWebHostEnvironment env, 
    ILogger&lt;Startup&gt; logger, IServer server)
{
    app.Use(async (context, next) =&gt;
    {
        context.Features.Get&lt;IHttpMaxRequestBodySizeFeature&gt;()
            .MaxRequestBodySize = 10 * 1024;

        var serverAddressesFeature = 
            app.ServerFeatures.Get&lt;IServerAddressesFeature&gt;();
        var addresses = string.Join(", ", serverAddressesFeature?.Addresses);

        logger.LogInformation("Addresses: {Addresses}", addresses);

        await next.Invoke();
    });

    if (env.IsDevelopment())
    {
        app.UseDeveloperExceptionPage();
    }
    else
    {
        app.UseExceptionHandler("/Error");
    }

    app.UseStaticFiles();
    app.UseRouting();

    app.UseEndpoints(endpoints =&gt;
    {
        endpoints.MapRazorPages();
    });
}
</code></pre>
<p>If using Visual Studio, make sure the app isn't configured to run IIS or IIS Express.</p>
<p>In Visual Studio, the default launch profile is for IIS Express. To run the project as a console app, manually change the selected profile, as shown in the following screen shot:</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/vs-choose-profile.png?view=aspnetcore-9.0" alt="Select console app profile" data-linktype="relative-path"></p>
<h3 id="configure-windows-server-1">Configure Windows Server</h3>
<ol>
<li><p>Determine the ports to open for the app and use <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-firewall/create-an-inbound-port-rule" data-linktype="absolute-path">Windows Firewall</a> or the <a href="https://learn.microsoft.com/en-us/powershell/module/netsecurity/new-netfirewallrule" data-linktype="absolute-path">New-NetFirewallRule</a> PowerShell cmdlet to open firewall ports to allow traffic to reach HTTP.sys. In the following commands and app configuration, port 443 is used.</p>
</li>
<li><p>When deploying to an Azure VM, open the ports in the <a href="https://learn.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal" data-linktype="absolute-path">Network Security Group</a>. In the following commands and app configuration, port 443 is used.</p>
</li>
<li><p>Obtain and install X.509 certificates, if required.</p>
<p>On Windows, create self-signed certificates using the <a href="https://learn.microsoft.com/en-us/powershell/module/pki/new-selfsignedcertificate" data-linktype="absolute-path">New-SelfSignedCertificate PowerShell cmdlet</a>. For an unsupported example, see <a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/includes/make-x509-cert/UpdateIISExpressSSLForChrome.ps1" data-linktype="external">UpdateIISExpressSSLForChrome.ps1</a>.</p>
<p>Install either self-signed or CA-signed certificates in the server's <strong>Local Machine</strong> &gt; <strong>Personal</strong> store.</p>
</li>
<li><p>If the app is a <a href="https://learn.microsoft.com/en-us/dotnet/core/deploying/#framework-dependent-deployments-fdd" data-linktype="absolute-path">framework-dependent deployment</a>, install .NET, .NET Framework, or both (if the app is a .NET app targeting the .NET Framework).</p>
<ul>
<li><strong>.NET</strong>: If the app requires .NET, obtain and run the <strong>.NET Runtime</strong> installer from <a href="https://dotnet.microsoft.com/download" data-linktype="external">.NET Downloads</a>. Don't install the full SDK on the server.</li>
<li><strong>.NET Framework</strong>: If the app requires .NET Framework, see the <a href="https://learn.microsoft.com/en-us/dotnet/framework/install/" data-linktype="absolute-path">.NET Framework installation guide</a>. Install the required .NET Framework. The installer for the latest .NET Framework is available from the <a href="https://dotnet.microsoft.com/download" data-linktype="external">.NET Downloads</a> page.</li>
</ul>
<p>If the app is a <a href="https://learn.microsoft.com/en-us/dotnet/core/deploying/#self-contained-deployments-scd" data-linktype="absolute-path">self-contained deployment</a>, the app includes the runtime in its deployment. No framework installation is required on the server.</p>
</li>
<li><p>Configure URLs and ports in the app.</p>
<p>By default, ASP.NET Core binds to <code>http://localhost:5000</code>. To configure URL prefixes and ports, options include:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.hosting.hostingabstractionswebhostbuilderextensions.useurls" class="no-loc" data-linktype="absolute-path">UseUrls</a></li>
<li><code>urls</code> command-line argument</li>
<li><code>ASPNETCORE_URLS</code> environment variable</li>
<li><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.urlprefixes#microsoft-aspnetcore-server-httpsys-httpsysoptions-urlprefixes" class="no-loc" data-linktype="absolute-path">UrlPrefixes</a></li>
</ul>
<p>The following code example shows how to use <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.urlprefixes#microsoft-aspnetcore-server-httpsys-httpsysoptions-urlprefixes" class="no-loc" data-linktype="absolute-path">UrlPrefixes</a> with the server's local IP address <code>10.0.0.4</code> on port 443:</p>
<pre><code class="lang-csharp" highlight-lines="7">public static IHostBuilder CreateHostBuilder(string[] args) =&gt;
    Host.CreateDefaultBuilder(args)
        .ConfigureWebHostDefaults(webBuilder =&gt;
        {
            webBuilder.UseHttpSys(options =&gt;
            {
                options.UrlPrefixes.Add("https://10.0.0.4:443");
            });
            webBuilder.UseStartup&lt;Startup&gt;();
        });
</code></pre>
<p>An advantage of <code>UrlPrefixes</code> is that an error message is generated immediately for improperly formatted prefixes.</p>
<p>The settings in <code>UrlPrefixes</code> override <code>UseUrls</code>/<code>urls</code>/<code>ASPNETCORE_URLS</code> settings. Therefore, an advantage of <code>UseUrls</code>, <code>urls</code>, and the <code>ASPNETCORE_URLS</code> environment variable is that it's easier to switch between Kestrel and HTTP.sys.</p>
<p>HTTP.sys uses the <a href="https://learn.microsoft.com/en-us/windows/win32/http/urlprefix-strings" data-linktype="absolute-path">HTTP Server API UrlPrefix string formats</a>.</p>
<div class="WARNING">
<p>Warning</p>
<p>Top-level wildcard bindings (<code>http://*:80/</code> and <code>http://+:80</code>) should <strong>not</strong> be used. Top-level wildcard bindings create app security vulnerabilities. This applies to both strong and weak wildcards. Use explicit host names or IP addresses rather than wildcards. Subdomain wildcard binding (for example, <code>*.mysub.com</code>) isn't a security risk if you control the entire parent domain (as opposed to <code>*.com</code>, which is vulnerable). For more information, see <a href="https://www.rfc-editor.org/rfc/rfc9110#field.host" data-linktype="external">RFC 9110: Section 7.2: Host and :authority</a>.</p>
</div>
</li>
<li><p>Preregister URL prefixes on the server.</p>
<p>The built-in tool for configuring HTTP.sys is <em>netsh.exe</em>. <em>netsh.exe</em> is used to reserve URL prefixes and assign X.509 certificates. The tool requires administrator privileges.</p>
<p>Use the <em>netsh.exe</em> tool to register URLs for the app:</p>
<pre><code class="lang-console">netsh http add urlacl url=&lt;URL&gt; user=&lt;USER&gt;
</code></pre>
<ul>
<li><code>&lt;URL&gt;</code>: The fully qualified Uniform Resource Locator (URL). Don't use a wildcard binding. Use a valid hostname or local IP address. <em>The URL must include a trailing slash.</em></li>
<li><code>&lt;USER&gt;</code>: Specifies the user or user-group name.</li>
</ul>
<p>In the following example, the local IP address of the server is <code>10.0.0.4</code>:</p>
<pre><code class="lang-console">netsh http add urlacl url=https://10.0.0.4:443/ user=Users
</code></pre>
<p>When a URL is registered, the tool responds with <code>URL reservation successfully added</code>.</p>
<p>To delete a registered URL, use the <code>delete urlacl</code> command:</p>
<pre><code class="lang-console">netsh http delete urlacl url=&lt;URL&gt;
</code></pre>
</li>
<li><p>Register X.509 certificates on the server.</p>
<p>Use the <em>netsh.exe</em> tool to register certificates for the app:</p>
<pre><code class="lang-console">netsh http add sslcert ipport=&lt;IP&gt;:&lt;PORT&gt; certhash=&lt;THUMBPRINT&gt; appid="{&lt;GUID&gt;}"
</code></pre>
<ul>
<li><code>&lt;IP&gt;</code>: Specifies the local IP address for the binding. Don't use a wildcard binding. Use a valid IP address.</li>
<li><code>&lt;PORT&gt;</code>: Specifies the port for the binding.</li>
<li><code>&lt;THUMBPRINT&gt;</code>: The X.509 certificate thumbprint.</li>
<li><code>&lt;GUID&gt;</code>: A developer-generated GUID to represent the app for informational purposes.</li>
</ul>
<p>For reference purposes, store the GUID in the app as a package tag:</p>
<ul>
<li>In Visual Studio:
<ul>
<li>Open the app's project properties by right-clicking on the app in <strong>Solution Explorer</strong> and selecting <strong>Properties</strong>.</li>
<li>Select the <strong>Package</strong> tab.</li>
<li>Enter the GUID that you created in the <strong>Tags</strong> field.</li>
</ul>
</li>
<li>When not using Visual Studio:
<ul>
<li><p>Open the app's project file.</p>
</li>
<li><p>Add a <code>&lt;PackageTags&gt;</code> property to a new or existing <code>&lt;PropertyGroup&gt;</code> with the GUID that you created:</p>
<pre><code class="lang-xml">&lt;PropertyGroup&gt;
  &lt;PackageTags&gt;00001111-aaaa-2222-bbbb-3333cccc4444&lt;/PackageTags&gt;
&lt;/PropertyGroup&gt;
</code></pre>
</li>
</ul>
</li>
</ul>
<p>In the following example:</p>
<ul>
<li>The local IP address of the server is <code>10.0.0.4</code>.</li>
<li>An online random GUID generator provides the <code>appid</code> value.</li>
</ul>
<pre><code class="lang-console">netsh http add sslcert 
    ipport=10.0.0.4:443 
    certhash=b66ee04419d4ee37464ab8785ff02449980eae10 
    appid="{00001111-aaaa-2222-bbbb-3333cccc4444}"
</code></pre>
<p>When a certificate is registered, the tool responds with <code>SSL Certificate successfully added</code>.</p>
<p>To delete a certificate registration, use the <code>delete sslcert</code> command:</p>
<pre><code class="lang-console">netsh http delete sslcert ipport=&lt;IP&gt;:&lt;PORT&gt;
</code></pre>
<p>Reference documentation for <em>netsh.exe</em>:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc725882(v=ws.10)" data-linktype="absolute-path">Netsh Commands for Hypertext Transfer Protocol (HTTP)</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/http/urlprefix-strings" data-linktype="absolute-path">UrlPrefix Strings</a></li>
</ul>
</li>
<li><p>Run the app.</p>
<p>Administrator privileges aren't required to run the app when binding to localhost using HTTP (not HTTPS) with a port number greater than 1024. For other configurations (for example, using a local IP address or binding to port 443), run the app with administrator privileges.</p>
<p>The app responds at the server's public IP address. In this example, the server is reached from the Internet at its public IP address of <code>104.214.79.47</code>.</p>
<p>A development certificate is used in this example. The page loads securely after bypassing the browser's untrusted certificate warning.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/browser.png?view=aspnetcore-9.0" alt="Browser window showing the app's Index page loaded" data-linktype="relative-path"></p>
</li>
</ol>
<h2 id="proxy-server-and-load-balancer-scenarios-1">Proxy server and load balancer scenarios</h2>
<p>For apps hosted by HTTP.sys that interact with requests from the Internet or a corporate network, additional configuration might be required when hosting behind proxy servers and load balancers. For more information, see <a href="https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/proxy-load-balancer?view=aspnetcore-9.0" data-linktype="relative-path">Configure ASP.NET Core to work with proxy servers and load balancers</a>.</p>
<h2 id="advanced-http2-features-to-support-grpc-1">Advanced HTTP/2 features to support gRPC</h2>
<p>Additional HTTP/2 features in HTTP.sys support gRPC, including support for response trailers and sending reset frames.</p>
<p>Requirements to run gRPC with HTTP.sys:</p>
<ul>
<li>Windows 10, OS Build 19041.508 or later</li>
<li>TLS 1.2 or later connection</li>
</ul>
<h3 id="trailers-1">Trailers</h3>
<p>HTTP Trailers are similar to HTTP Headers, except they are sent after the response body is sent. For IIS and HTTP.sys, only HTTP/2 response trailers are supported.</p>
<pre><code class="lang-csharp">if (httpContext.Response.SupportsTrailers())
{
    httpContext.Response.DeclareTrailer("trailername");	

    // Write body
    httpContext.Response.WriteAsync("Hello world");

    httpContext.Response.AppendTrailer("trailername", "TrailerValue");
}
</code></pre>
<p>In the preceding example code:</p>
<ul>
<li><code>SupportsTrailers</code> ensures that trailers are supported for the response.</li>
<li><code>DeclareTrailer</code> adds the given trailer name to the <code>Trailer</code> response header. Declaring a response's trailers is optional, but recommended. If <code>DeclareTrailer</code> is called, it must be before the response headers are sent.</li>
<li><code>AppendTrailer</code> appends the trailer.</li>
</ul>
<h3 id="reset-1">Reset</h3>
<p>Reset allows for the server to reset a HTTP/2 request with a specified error code. A reset request is considered aborted.</p>
<pre><code class="lang-csharp">var resetFeature = httpContext.Features.Get&lt;IHttpResetFeature&gt;();
resetFeature.Reset(errorCode: 2);
</code></pre>
<p><code>Reset</code> in the preceding code example specifies the <code>INTERNAL_ERROR</code> error code. For more information about HTTP/2 error codes, visit the <a href="https://tools.ietf.org/html/rfc7540#page-50" data-linktype="external">HTTP/2 specification error code section</a>.</p>
<h2 id="additional-resources-1">Additional resources</h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/aspnet/core/security/authentication/windowsauth?view=aspnetcore-9.0#httpsys" data-linktype="relative-path">Enable Windows Authentication with HTTP.sys</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/http/http-api-start-page" data-linktype="absolute-path">HTTP Server API</a></li>
<li><a href="https://github.com/aspnet/HttpSysServer/" data-linktype="external">aspnet/HttpSysServer GitHub repository (source code)</a></li>
<li><a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/?view=aspnetcore-9.0#host" data-linktype="relative-path">The host</a></li>
<li><a href="../../test/troubleshoot553c.html?view=aspnetcore-9.0" data-linktype="relative-path">Troubleshoot and debug ASP.NET Core projects</a></li>
</ul>
</div>
<div data-moniker="aspnetcore-8.0 aspnetcore-9.0">
<p><a href="https://learn.microsoft.com/en-us/iis/get-started/introduction-to-iis/introduction-to-iis-architecture#hypertext-transfer-protocol-stack-httpsys" data-linktype="absolute-path">HTTP.sys</a> is a <a href="httpsys553c.html?view=aspnetcore-9.0" data-linktype="relative-path">web server for ASP.NET Core</a> that only runs on Windows. HTTP.sys is an alternative to <a href="kestrel553c.html?view=aspnetcore-9.0" data-linktype="relative-path">Kestrel</a> server and offers some features that Kestrel doesn't provide.</p>
<div class="IMPORTANT">
<p>Important</p>
<p>HTTP.sys isn't compatible with the <a href="https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/aspnet-core-module?view=aspnetcore-9.0" data-linktype="relative-path">ASP.NET Core Module</a> and can't be used with IIS or IIS Express.</p>
</div>
<p>HTTP.sys supports the following features:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/aspnet/core/security/authentication/windowsauth?view=aspnetcore-9.0" data-linktype="relative-path">Windows Authentication</a></li>
<li>Port sharing</li>
<li>HTTPS with SNI</li>
<li>HTTP/2 over TLS (Windows 10 or later)</li>
<li>HTTP/3 over TLS (Windows 11 or later)</li>
<li>Direct file transmission</li>
<li>Response caching</li>
<li>WebSockets (Windows 8 or later)</li>
<li>Customizable security descriptors</li>
</ul>
<p>Supported Windows versions:</p>
<ul>
<li>Windows 7 or later</li>
<li>Windows Server 2008 R2 or later</li>
</ul>
<p><a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/fundamentals/servers/httpsys/samples" data-linktype="external">View or download sample code</a> (<a href="../../overview553c.html?view=aspnetcore-9.0#how-to-download-a-sample" data-linktype="relative-path">how to download</a>)</p>
<h2 id="when-to-use-httpsys">When to use HTTP.sys</h2>
<p>HTTP.sys is useful for deployments where:</p>
<ul>
<li><p>There's a need to expose the server directly to the Internet without using IIS.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/httpsys-to-internet.png?view=aspnetcore-9.0" alt="HTTP.sys communicates directly with the Internet" data-linktype="relative-path"></p>
</li>
<li><p>An internal deployment requires a feature not available in Kestrel. For more information, see <a href="httpsys553c.html?view=aspnetcore-9.0#kestrel-vs-httpsys" data-linktype="relative-path">Kestrel vs. HTTP.sys</a></p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/httpsys-to-internal.png?view=aspnetcore-9.0" alt="HTTP.sys communicates directly with the internal network" data-linktype="relative-path"></p>
</li>
</ul>
<p>HTTP.sys is mature technology that protects against many types of attacks and provides the robustness, security, and scalability of a full-featured web server. IIS itself runs as an HTTP listener on top of HTTP.sys.</p>
<h2 id="http2-support">HTTP/2 support</h2>
<p><a href="https://httpwg.org/specs/rfc7540.html" data-linktype="external">HTTP/2</a> is enabled for ASP.NET Core apps when the following base requirements are met:</p>
<ul>
<li>Windows Server 2016/Windows 10 or later</li>
<li><a href="https://tools.ietf.org/html/rfc7301#section-3" data-linktype="external">Application-Layer Protocol Negotiation (ALPN)</a> connection</li>
<li>TLS 1.2 or later connection</li>
</ul>
<p>If an HTTP/2 connection is established, <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.http.httprequest.protocol" data-linktype="absolute-path">HttpRequest.Protocol</a> reports <code>HTTP/2</code>.</p>
<p>HTTP/2 is enabled by default. If an HTTP/2 connection isn't established, the connection falls back to HTTP/1.1. In a future release of Windows, HTTP/2 configuration flags will be available, including the ability to disable HTTP/2 with HTTP.sys.</p>
<h2 id="http3-support">HTTP/3 support</h2>
<p><a href="https://datatracker.ietf.org/doc/rfc9114/" data-linktype="external">HTTP/3</a> is enabled for ASP.NET Core apps when the following base requirements are met:</p>
<ul>
<li>Windows Server 2022/Windows 11 or later</li>
<li>An <code>https</code> url binding is used.</li>
<li>The <a href="https://techcommunity.microsoft.com/t5/networking-blog/enabling-http-3-support-on-windows-server-2022/ba-p/2676880" data-linktype="external">EnableHttp3 registry key</a> is set.</li>
</ul>
<p>The preceding Windows 11 Build versions may require the use of a <a href="https://www.microsoft.com/en-us/windowsinsider/" data-linktype="external">Windows Insider</a> build.</p>
<p>HTTP/3 is discovered as an upgrade from HTTP/1.1 or HTTP/2 via the <code>alt-svc</code> header. That means the first request will normally use HTTP/1.1 or HTTP/2 before switching to HTTP/3. Http.Sys doesn't automatically add the <code>alt-svc</code> header, it must be added by the application. The following code is a middleware example that adds the <code>alt-svc</code> response header.</p>
<pre><code class="lang-csharp">app.Use((context, next) =&gt;
{
    context.Response.Headers.AltSvc = "h3=\":443\"";
    return next(context);
});
</code></pre>
<p>Place the preceding code early in the request pipeline.</p>
<p>Http.Sys also supports sending an AltSvc HTTP/2 protocol message rather than a response header to notify the client that HTTP/3 is available. See the <a href="https://techcommunity.microsoft.com/t5/networking-blog/enabling-http-3-support-on-windows-server-2022/ba-p/2676880" data-linktype="external">EnableAltSvc registry key</a>. This requires netsh sslcert bindings that use host names rather than IP addresses.</p>
<h2 id="kernel-mode-authentication-with-kerberos">Kernel mode authentication with Kerberos</h2>
<p>HTTP.sys delegates to kernel mode authentication with the Kerberos authentication protocol. User mode authentication isn't supported with Kerberos and HTTP.sys. The machine account must be used to decrypt the Kerberos token/ticket that's obtained from Active Directory and forwarded by the client to the server to authenticate the user. Register the Service Principal Name (SPN) for the host, not the user of the app.</p>
<h3 id="support-for-kernel-mode-response-buffering">Support for kernel-mode response buffering</h3>
<p>In some scenarios, high volumes of small writes with high latency can cause significant performance impact to <code>HTTP.sys</code>. This impact is due to the lack of a <a href="https://learn.microsoft.com/en-us/dotnet/api/system.io.pipelines.pipe" class="no-loc" data-linktype="absolute-path">Pipe</a> buffer in the <code>HTTP.sys</code> implementation. To improve performance in these scenarios, support for response buffering is included in <code>HTTP.sys</code>. Enable buffering by setting <a href="https://github.com/dotnet/aspnetcore/blob/main/src/Servers/HttpSys/src/HttpSysOptions.cs#L120" data-linktype="external">HttpSysOptions.EnableKernelResponseBuffering</a> to <code>true</code>.
Response buffering should be enabled by an app that does synchronous I/O, or asynchronous I/O with no more than one outstanding write at a time. In these scenarios, response buffering can significantly improve throughput over high-latency connections.</p>
<p>Apps that use asynchronous I/O and that may have more than one write outstanding at a time should <strong><em>not</em></strong> use this flag. Enabling this flag can result in higher CPU and memory usage by HTTP.Sys.</p>
<h2 id="how-to-use-httpsys">How to use HTTP.sys</h2>
<h3 id="configure-the-aspnet-core-app-to-use-httpsys">Configure the ASP.NET Core app to use HTTP.sys</h3>
<p>Call the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.hosting.webhostbuilderhttpsysextensions.usehttpsys" class="no-loc" data-linktype="absolute-path">UseHttpSys</a> extension method when building the host, specifying any required <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions" class="no-loc" data-linktype="absolute-path">HttpSysOptions</a>. The following example sets options to their default values:</p>
<pre><code class="lang-csharp" highlight-lines="8-16">using Microsoft.AspNetCore.Hosting.Server;
using Microsoft.AspNetCore.Hosting.Server.Features;
using Microsoft.AspNetCore.Http.Features;
using Microsoft.AspNetCore.Server.HttpSys;

var builder = WebApplication.CreateBuilder(args);

builder.WebHost.UseHttpSys(options =&gt;
{
    options.AllowSynchronousIO = false;
    options.Authentication.Schemes = AuthenticationSchemes.None;
    options.Authentication.AllowAnonymous = true;
    options.MaxConnections = null;
    options.MaxRequestBodySize = 30_000_000;
    options.UrlPrefixes.Add("http://localhost:5005");
});

builder.Services.AddRazorPages();

var app = builder.Build();
</code></pre>
<p>Additional HTTP.sys configuration is handled through <a href="https://support.microsoft.com/help/820129/http-sys-registry-settings-for-windows" data-linktype="external">registry settings</a>.</p>
<p>For more information about HTTP.sys options, see <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions" class="no-loc" data-linktype="absolute-path">HttpSysOptions</a>.</p>
<p><a name="maxrequestbodysize"></a></p>
<p><strong>MaxRequestBodySize</strong></p>
<p>The maximum allowed size of any request body in bytes. When set to <code>null</code>, the maximum request body size is unlimited. This limit has no effect on upgraded connections, which are always unlimited.</p>
<p>The recommended method to override the limit in an ASP.NET Core MVC app for a single <code>IActionResult</code> is to use the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.requestsizelimitattribute" class="no-loc" data-linktype="absolute-path">RequestSizeLimitAttribute</a> attribute on an action method:</p>
<pre><code class="lang-csharp">[RequestSizeLimit(100000000)]
public IActionResult MyActionMethod()
</code></pre>
<p>An exception is thrown if the app attempts to configure the limit on a request after the app has started reading the request. An <code>IsReadOnly</code> property can be used to indicate if the <code>MaxRequestBodySize</code> property is in a read-only state, meaning it's too late to configure the limit.</p>
<p>If the app should override <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.maxrequestbodysize#microsoft-aspnetcore-server-httpsys-httpsysoptions-maxrequestbodysize" class="no-loc" data-linktype="absolute-path">MaxRequestBodySize</a> per-request, use the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.http.features.ihttpmaxrequestbodysizefeature" class="no-loc" data-linktype="absolute-path">IHttpMaxRequestBodySizeFeature</a>:</p>
<pre><code class="lang-csharp" highlight-lines="3-4">app.Use((context, next) =&gt;
{
    context.Features.GetRequiredFeature&lt;IHttpMaxRequestBodySizeFeature&gt;()
                                             .MaxRequestBodySize = 10 * 1024;

    var server = context.RequestServices
        .GetRequiredService&lt;IServer&gt;();
    var serverAddressesFeature = server.Features
                                 .GetRequiredFeature&lt;IServerAddressesFeature&gt;();

    var addresses = string.Join(", ", serverAddressesFeature.Addresses);

    var loggerFactory = context.RequestServices
        .GetRequiredService&lt;ILoggerFactory&gt;();
    var logger = loggerFactory.CreateLogger("Sample");

    logger.LogInformation("Addresses: {addresses}", addresses);

    return next(context);
});
</code></pre>
<p>If using Visual Studio, make sure the app isn't configured to run IIS or IIS Express.</p>
<p>In Visual Studio, the default launch profile is for IIS Express. To run the project as a console app, manually change the selected profile, as shown in the following screenshot:</p>
<p><span class="mx-imgBorder">
<img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/vs-choose-profile.png?view=aspnetcore-9.0" alt="Select console app profile" data-linktype="relative-path">
</span>
</p>
<h3 id="configure-windows-server">Configure Windows Server</h3>
<ol>
<li><p>Determine the ports to open for the app and use <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-firewall/create-an-inbound-port-rule" data-linktype="absolute-path">Windows Firewall</a> or the <a href="https://learn.microsoft.com/en-us/powershell/module/netsecurity/new-netfirewallrule" data-linktype="absolute-path">New-NetFirewallRule</a> PowerShell cmdlet to open firewall ports to allow traffic to reach HTTP.sys. In the following commands and app configuration, port 443 is used.</p>
</li>
<li><p>When deploying to an Azure VM, open the ports in the <a href="https://learn.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal" data-linktype="absolute-path">Network Security Group</a>. In the following commands and app configuration, port 443 is used.</p>
</li>
<li><p>Obtain and install X.509 certificates, if required.</p>
<p>On Windows, create self-signed certificates using the <a href="https://learn.microsoft.com/en-us/powershell/module/pki/new-selfsignedcertificate" data-linktype="absolute-path">New-SelfSignedCertificate PowerShell cmdlet</a>. For an unsupported example, see <a href="https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/includes/make-x509-cert/UpdateIISExpressSSLForChrome.ps1" data-linktype="external">UpdateIISExpressSSLForChrome.ps1</a>.</p>
<p>Install either self-signed or CA-signed certificates in the server's <strong>Local Machine</strong> &gt; <strong>Personal</strong> store.</p>
</li>
<li><p>If the app is a <a href="https://learn.microsoft.com/en-us/dotnet/core/deploying/#framework-dependent-deployments-fdd" data-linktype="absolute-path">framework-dependent deployment</a>, install .NET, .NET Framework, or both (if the app is a .NET app targeting the .NET Framework).</p>
<ul>
<li><strong>.NET</strong>: If the app requires .NET, obtain and run the <strong>.NET Runtime</strong> installer from <a href="https://dotnet.microsoft.com/download" data-linktype="external">.NET Downloads</a>. Don't install the full SDK on the server.</li>
<li><strong>.NET Framework</strong>: If the app requires .NET Framework, see the <a href="https://learn.microsoft.com/en-us/dotnet/framework/install/" data-linktype="absolute-path">.NET Framework installation guide</a>. Install the required .NET Framework. The installer for the latest .NET Framework is available from the <a href="https://dotnet.microsoft.com/download" data-linktype="external">.NET Downloads</a> page.</li>
</ul>
<p>If the app is a <a href="https://learn.microsoft.com/en-us/dotnet/core/deploying/#self-contained-deployments-scd" data-linktype="absolute-path">self-contained deployment</a>, the app includes the runtime in its deployment. No framework installation is required on the server.</p>
</li>
<li><p>Configure URLs and ports in the app.</p>
<p>By default, ASP.NET Core binds to <code>http://localhost:5000</code>. To configure URL prefixes and ports, options include:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.hosting.hostingabstractionswebhostbuilderextensions.useurls" class="no-loc" data-linktype="absolute-path">UseUrls</a></li>
<li><code>urls</code> command-line argument</li>
<li><code>ASPNETCORE_URLS</code> environment variable</li>
<li><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.urlprefixes#microsoft-aspnetcore-server-httpsys-httpsysoptions-urlprefixes" class="no-loc" data-linktype="absolute-path">UrlPrefixes</a></li>
</ul>
<p>The following code example shows how to use <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysoptions.urlprefixes#microsoft-aspnetcore-server-httpsys-httpsysoptions-urlprefixes" class="no-loc" data-linktype="absolute-path">UrlPrefixes</a> with the server's local IP address <code>10.0.0.4</code> on port 443:</p>
<pre><code class="lang-csharp" highlight-lines="5">var builder = WebApplication.CreateBuilder(args);

builder.WebHost.UseHttpSys(options =&gt;
{
    options.UrlPrefixes.Add("https://10.0.0.4:443");
});

builder.Services.AddRazorPages();

var app = builder.Build();
</code></pre>
<p>An advantage of <code>UrlPrefixes</code> is that an error message is generated immediately for improperly formatted prefixes.</p>
<p>The settings in <code>UrlPrefixes</code> override <code>UseUrls</code>/<code>urls</code>/<code>ASPNETCORE_URLS</code> settings. Therefore, an advantage of <code>UseUrls</code>, <code>urls</code>, and the <code>ASPNETCORE_URLS</code> environment variable is that it's easier to switch between Kestrel and HTTP.sys.</p>
<p>HTTP.sys recognizes two types of wild cards in URL prefixes:</p>
<ul>
<li><code>*</code> is a <em>weak binding</em>, also known as a <em>fallback binding</em>. If the URL prefix is <code>http://*:5000</code>, and something else is bound to port 5000, this binding won't be used.</li>
<li><code>+</code> is a <em>strong binding</em>. If the URL prefix is <code>http://+:5000</code>, this binding will be used before other port 5000 bindings.</li>
</ul>
<p>For more information, see <a href="https://learn.microsoft.com/en-us/windows/win32/http/urlprefix-strings" data-linktype="absolute-path">UrlPrefix Strings</a>.</p>
<div class="WARNING">
<p>Warning</p>
<p>Top-level wildcard bindings (<code>http://*:80/</code> and <code>http://+:80</code>) should <strong>not</strong> be used. Top-level wildcard bindings create app security vulnerabilities. This applies to both strong and weak wildcards. Use explicit host names or IP addresses rather than wildcards. Subdomain wildcard binding (for example, <code>*.mysub.com</code>) isn't a security risk if you control the entire parent domain (as opposed to <code>*.com</code>, which is vulnerable). For more information, see <a href="https://www.rfc-editor.org/rfc/rfc9110#field.host" data-linktype="external">RFC 9110: Section 7.2: Host and :authority</a>.</p>
</div>
<p>Apps and containers are often given only a port to listen on, like port 80, without additional constraints like host or path. HTTP_PORTS and HTTPS_PORTS are config keys that specify the listening ports for the Kestrel and HTTP.sys servers. These keys may be specified as environment variables defined with the <code>DOTNET_</code> or <code>ASPNETCORE_</code> prefixes, or specified directly through any other config input, such as <code>appsettings.json</code>. Each is a semicolon-delimited list of port values, as shown in the following example:</p>
<pre><code>ASPNETCORE_HTTP_PORTS=80;8080
ASPNETCORE_HTTPS_PORTS=443;8081
</code></pre>
<p>The preceding example is shorthand for the following configuration, which specifies the scheme (HTTP or HTTPS) and any host or IP.</p>
<pre><code>ASPNETCORE_URLS=http://*:80/;http://*:8080/;https://*:443/;https://*:8081/
</code></pre>
<p>The HTTP_PORTS and HTTPS_PORTS configuration keys are lower priority and are overridden by URLS or values provided directly in code. Certificates still need to be configured separately via server-specific mechanics for HTTPS.</p>
<p>These configuration keys are equivalent to top-level wildcard bindings. They're convenient for development and container scenarios, but avoid wildcards when running on a machine that may also host other services.</p>
</li>
<li><p>Preregister URL prefixes on the server.</p>
<p>The built-in tool for configuring HTTP.sys is <em>netsh.exe</em>. <em>netsh.exe</em> is used to reserve URL prefixes and assign X.509 certificates. The tool requires administrator privileges.</p>
<p>Use the <em>netsh.exe</em> tool to register URLs for the app:</p>
<pre><code class="lang-console">netsh http add urlacl url=&lt;URL&gt; user=&lt;USER&gt;
</code></pre>
<ul>
<li><code>&lt;URL&gt;</code>: The fully qualified Uniform Resource Locator (URL). Don't use a wildcard binding. Use a valid hostname or local IP address. <em>The URL must include a trailing slash.</em></li>
<li><code>&lt;USER&gt;</code>: Specifies the user or user-group name.</li>
</ul>
<p>In the following example, the local IP address of the server is <code>10.0.0.4</code>:</p>
<pre><code class="lang-console">netsh http add urlacl url=https://10.0.0.4:443/ user=Users
</code></pre>
<p>When a URL is registered, the tool responds with <code>URL reservation successfully added</code>.</p>
<p>To delete a registered URL, use the <code>delete urlacl</code> command:</p>
<pre><code class="lang-console">netsh http delete urlacl url=&lt;URL&gt;
</code></pre>
</li>
<li><p>Register X.509 certificates on the server.</p>
<p>Use the <em>netsh.exe</em> tool to register certificates for the app:</p>
<pre><code class="lang-console">netsh http add sslcert ipport=&lt;IP&gt;:&lt;PORT&gt; certhash=&lt;THUMBPRINT&gt; appid="{&lt;GUID&gt;}"
</code></pre>
<ul>
<li><code>&lt;IP&gt;</code>: Specifies the local IP address for the binding. Don't use a wildcard binding. Use a valid IP address.</li>
<li><code>&lt;PORT&gt;</code>: Specifies the port for the binding.</li>
<li><code>&lt;THUMBPRINT&gt;</code>: The X.509 certificate thumbprint.</li>
<li><code>&lt;GUID&gt;</code>: A developer-generated GUID to represent the app for informational purposes.</li>
</ul>
<p>For reference purposes, store the GUID in the app as a package tag:</p>
<ul>
<li>In Visual Studio:
<ul>
<li>Open the app's project properties by right-clicking on the app in <strong>Solution Explorer</strong> and selecting <strong>Properties</strong>.</li>
<li>Select the <strong>Package</strong> tab.</li>
<li>Enter the GUID that you created in the <strong>Tags</strong> field.</li>
</ul>
</li>
<li>When not using Visual Studio:
<ul>
<li><p>Open the app's project file.</p>
</li>
<li><p>Add a <code>&lt;PackageTags&gt;</code> property to a new or existing <code>&lt;PropertyGroup&gt;</code> with the GUID that you created:</p>
<pre><code class="lang-xml">&lt;PropertyGroup&gt;
  &lt;PackageTags&gt;00001111-aaaa-2222-bbbb-3333cccc4444&lt;/PackageTags&gt;
&lt;/PropertyGroup&gt;
</code></pre>
</li>
</ul>
</li>
</ul>
<p>In the following example:</p>
<ul>
<li>The local IP address of the server is <code>10.0.0.4</code>.</li>
<li>An online random GUID generator provides the <code>appid</code> value.</li>
</ul>
<pre><code class="lang-console">netsh http add sslcert 
    ipport=10.0.0.4:443 
    certhash=b66ee04419d4ee37464ab8785ff02449980eae10 
    appid="{00001111-aaaa-2222-bbbb-3333cccc4444}"
</code></pre>
<p>When a certificate is registered, the tool responds with <code>SSL Certificate successfully added</code>.</p>
<p>To delete a certificate registration, use the <code>delete sslcert</code> command:</p>
<pre><code class="lang-console">netsh http delete sslcert ipport=&lt;IP&gt;:&lt;PORT&gt;
</code></pre>
<p>Reference documentation for <em>netsh.exe</em>:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc725882(v=ws.10)" data-linktype="absolute-path">Netsh Commands for Hypertext Transfer Protocol (HTTP)</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/http/urlprefix-strings" data-linktype="absolute-path">UrlPrefix Strings</a></li>
</ul>
</li>
<li><p>Run the app.</p>
<p>Administrator privileges aren't required to run the app when binding to localhost using HTTP (not HTTPS) with a port number greater than 1024. For other configurations (for example, using a local IP address or binding to port 443), run the app with administrator privileges.</p>
<p>The app responds at the server's public IP address. In this example, the server is reached from the Internet at its public IP address of <code>104.214.79.47</code>.</p>
<p>A development certificate is used in this example. The page loads securely after bypassing the browser's untrusted certificate warning.</p>
<p><img src="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys/_static/browser.png?view=aspnetcore-9.0" alt="Browser window showing the app's Index page loaded" data-linktype="relative-path"></p>
</li>
</ol>
<h2 id="proxy-server-and-load-balancer-scenarios">Proxy server and load balancer scenarios</h2>
<p>For apps hosted by HTTP.sys that interact with requests from the Internet or a corporate network, additional configuration might be required when hosting behind proxy servers and load balancers. For more information, see <a href="https://learn.microsoft.com/en-us/aspnet/core/host-and-deploy/proxy-load-balancer?view=aspnetcore-9.0" data-linktype="relative-path">Configure ASP.NET Core to work with proxy servers and load balancers</a>.</p>
<p><a name="ihsrtf8"></a></p>
<h2 id="get-detailed-timing-information-with-ihttpsysrequesttimingfeature">Get detailed timing information with IHttpSysRequestTimingFeature</h2>
<!--
<xref:Microsoft.AspNetCore.Server.HttpSys.IHttpSysRequestTimingFeature> 
-->
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.ihttpsysrequesttimingfeature" data-linktype="absolute-path">IHttpSysRequestTimingFeature</a>  provides detailed timing information for requests:</p>
<ul>
<li>Timestamps are obtained using <a href="https://learn.microsoft.com/en-us/windows/win32/api/profileapi/nf-profileapi-queryperformancecounter" data-linktype="absolute-path">QueryPerformanceCounter</a>.</li>
<li>The timestamp frequency can be obtained via <a href="https://learn.microsoft.com/en-us/windows/win32/api/profileapi/nf-profileapi-queryperformancefrequency" data-linktype="absolute-path">QueryPerformanceFrequency</a>.</li>
<li>The index of the timing can be cast to <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.httpsysrequesttimingtype" data-linktype="absolute-path">HttpSysRequestTimingType</a> to know what the timing represents.</li>
<li>The value may be 0 if the timing isn't available for the current request.</li>
<li>Requires Windows 10 version 2004, Windows Server 2022, or later.</li>
</ul>
<pre><code class="lang-csharp">using Microsoft.AspNetCore.Http.Features;
using Microsoft.AspNetCore.Server.HttpSys;

var builder = WebApplication.CreateBuilder(args);

builder.WebHost.UseHttpSys();

var app = builder.Build();

app.Use((context, next) =&gt;
{
    var feature = context.Features.GetRequiredFeature&lt;IHttpSysRequestTimingFeature&gt;();
    
    var loggerFactory = context.RequestServices.GetRequiredService&lt;ILoggerFactory&gt;();
    var logger = loggerFactory.CreateLogger("Sample");

    var timestamps = feature.Timestamps;

    for (var i = 0; i &lt; timestamps.Length; i++)
    {
        var timestamp = timestamps[i];
        var timingType = (HttpSysRequestTimingType)i;

        logger.LogInformation("Timestamp {timingType}: {timestamp}",
                                          timingType, timestamp);
    }

    return next(context);
});

app.MapGet("/", () =&gt; Results.Ok());

app.Run();
</code></pre>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.server.httpsys.ihttpsysrequesttimingfeature.trygettimestamp" data-linktype="absolute-path">IHttpSysRequestTimingFeature.TryGetTimestamp</a> retrieves the timestamp for the provided timing type:</p>
<pre><code class="lang-csharp">using Microsoft.AspNetCore.Http.Features;
using Microsoft.AspNetCore.Server.HttpSys;
var builder = WebApplication.CreateBuilder(args);

builder.WebHost.UseHttpSys();

var app = builder.Build();

app.Use((context, next) =&gt;
{
    var feature = context.Features.GetRequiredFeature&lt;IHttpSysRequestTimingFeature&gt;();

    var loggerFactory = context.RequestServices.GetRequiredService&lt;ILoggerFactory&gt;();
    var logger = loggerFactory.CreateLogger("Sample");

    var timingType = HttpSysRequestTimingType.RequestRoutingEnd;

    if (feature.TryGetTimestamp(timingType, out var timestamp))
    {
        logger.LogInformation("Timestamp {timingType}: {timestamp}",
                                          timingType, timestamp);
    }
    else
    {
        logger.LogInformation("Timestamp {timingType}: not available for the "
                                           + "current request",    timingType);
    }

    return next(context);
});

app.MapGet("/", () =&gt; Results.Ok());

app.Run();
</code></pre>
<p>[IHttpSysRequestTimingFeature.TryGetElapsedTime](/dotnet/api/microsoft.aspnetcore.server.httpsys.ihttpsysrequesttimingfeature.trygetelapsedtime yields the elapsed time between two specified timings:</p>
<pre><code class="lang-csharp">using Microsoft.AspNetCore.Http.Features;
using Microsoft.AspNetCore.Server.HttpSys;

var builder = WebApplication.CreateBuilder(args);

builder.WebHost.UseHttpSys();

var app = builder.Build();

app.Use((context, next) =&gt;
{
    var feature = context.Features.GetRequiredFeature&lt;IHttpSysRequestTimingFeature&gt;();

    var loggerFactory = context.RequestServices.GetRequiredService&lt;ILoggerFactory&gt;();
    var logger = loggerFactory.CreateLogger("Sample");

    var startingTimingType = HttpSysRequestTimingType.RequestRoutingStart;
    var endingTimingType = HttpSysRequestTimingType.RequestRoutingEnd;

    if (feature.TryGetElapsedTime(startingTimingType, endingTimingType, out var elapsed))
    {
        logger.LogInformation(
            "Elapsed time {startingTimingType} to {endingTimingType}: {elapsed}",
            startingTimingType,
            endingTimingType,
            elapsed);
    }
    else
    {
        logger.LogInformation(
            "Elapsed time {startingTimingType} to {endingTimingType}:"
            + " not available for the current request.",
            startingTimingType,
            endingTimingType);
    }

    return next(context);
});

app.MapGet("/", () =&gt; Results.Ok());

app.Run();
</code></pre>
<h2 id="advanced-http2-features-to-support-grpc">Advanced HTTP/2 features to support gRPC</h2>
<p>Additional HTTP/2 features in HTTP.sys support gRPC, including support for response trailers and sending reset frames.</p>
<p>Requirements to run gRPC with HTTP.sys:</p>
<ul>
<li>Windows 11 Build 22000 or later, Windows Server 2022 Build 20348 or later.</li>
<li>TLS 1.2 or later connection.</li>
</ul>
<h3 id="trailers">Trailers</h3>
<p>HTTP Trailers are similar to HTTP Headers, except they are sent after the response body is sent. For IIS and HTTP.sys, only HTTP/2 response trailers are supported.</p>
<pre><code class="lang-csharp">if (httpContext.Response.SupportsTrailers())
{
    httpContext.Response.DeclareTrailer("trailername");	

    // Write body
    httpContext.Response.WriteAsync("Hello world");

    httpContext.Response.AppendTrailer("trailername", "TrailerValue");
}
</code></pre>
<p>In the preceding example code:</p>
<ul>
<li><code>SupportsTrailers</code> ensures that trailers are supported for the response.</li>
<li><code>DeclareTrailer</code> adds the given trailer name to the <code>Trailer</code> response header. Declaring a response's trailers is optional, but recommended. If <code>DeclareTrailer</code> is called, it must be before the response headers are sent.</li>
<li><code>AppendTrailer</code> appends the trailer.</li>
</ul>
<h3 id="reset">Reset</h3>
<p>Reset allows for the server to reset a HTTP/2 request with a specified error code. A reset request is considered aborted.</p>
<pre><code class="lang-csharp">var resetFeature = httpContext.Features.Get&lt;IHttpResetFeature&gt;();
resetFeature.Reset(errorCode: 2);
</code></pre>
<p><code>Reset</code> in the preceding code example specifies the <code>INTERNAL_ERROR</code> error code. For more information about HTTP/2 error codes, visit the <a href="https://tools.ietf.org/html/rfc7540#page-50" data-linktype="external">HTTP/2 specification error code section</a>.</p>
<h2 id="tracing">Tracing</h2>
<p>For information about how to get traces from HTTP.sys, see <a href="https://learn.microsoft.com/en-us/windows/win32/http/http-sys-manageability-scenarios" data-linktype="absolute-path">HTTP.sys Manageability Scenarios</a>.</p>
<h2 id="additional-resources">Additional resources</h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/aspnet/core/security/authentication/windowsauth?view=aspnetcore-9.0#httpsys" data-linktype="relative-path">Enable Windows Authentication with HTTP.sys</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/http/http-api-start-page" data-linktype="absolute-path">HTTP Server API</a></li>
<li><a href="https://github.com/aspnet/HttpSysServer/" data-linktype="external">aspnet/HttpSysServer GitHub repository (source code)</a></li>
<li><a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/?view=aspnetcore-9.0#host" data-linktype="relative-path">The host</a></li>
<li><a href="../../test/troubleshoot553c.html?view=aspnetcore-9.0" data-linktype="relative-path">Troubleshoot and debug ASP.NET Core projects</a></li>
</ul>
</div>
</div>
					
		<div
			id="ms--inline-notifications"
			class="margin-block-xs"
			data-bi-name="inline-notification"
		></div>
	 
		<div
			id="assertive-live-region"
			role="alert"
			aria-live="assertive"
			class="visually-hidden"
			aria-relevant="additions"
			aria-atomic="true"
		></div>
		<div
			id="polite-live-region"
			role="status"
			aria-live="polite"
			class="visually-hidden"
			aria-relevant="additions"
			aria-atomic="true"
		></div>
	
					
			
		<!-- feedback section -->
		<section
			class="feedback-section position-relative margin-top-lg border border-radius padding-xxs display-none-print"
			data-bi-name="open-source-feedback-section"
			data-open-source-feedback-section
			hidden
		>
			<div class="display-flex flex-direction-column flex-direction-row-tablet">
				<div
					class="width-450-tablet padding-inline-xs padding-inline-xs-tablet padding-top-xs padding-bottom-sm padding-top-xs-tablet background-color-body-medium"
				>
					<div class="display-flex flex-direction-column">
						<div class="padding-bottom-xxs">
							<span class="icon margin-right-xxs" aria-hidden="true">
								<span class="docon docon-brand-github"></span>
							</span>
							<span class="font-weight-semibold">
								Collaborate with us on GitHub
							</span>
						</div>
						<span class="line-height-normal">
							The source for this content can be found on GitHub, where you can also create and review issues and pull requests. For more information, see <a href="https://learn.microsoft.com/contribute/content/dotnet/dotnet-contribute">our contributor guide</a>.
						</span>
					</div>
				</div>
				<div
					class="display-flex gap-xs width-full-tablet flex-direction-column padding-xs justify-content-space-evenly"
				>
					<div class="media">
						
					<div class="media-left">
						<div class="image image-36x36" hidden data-open-source-image-container>
							<img
								class="theme-display is-light"
								src="https://learn.microsoft.com/media/logos/logo_net.svg"
								aria-hidden="true"
								data-open-source-image-light
							/>
							<img
								class="theme-display is-dark is-high-contrast"
								src="https://learn.microsoft.com/media/logos/logo_net.svg"
								aria-hidden="true"
								data-open-source-image-dark
							/>
						</div>
					</div>
			  

						<div class="media-content">
							<p
								class="font-size-xl font-weight-semibold margin-bottom-xxs"
								data-open-source-product-title
							>
								ASP.NET Core
							</p>
							<div class="display-flex gap-xs flex-direction-column">
								<p class="line-height-normal" data-open-source-product-description></p>
								<div class="display-flex gap-xs flex-direction-column">
									<a href="#" data-github-link>
										<span class="icon margin-right-xxs" aria-hidden="true">
											<span class="docon docon-bug"></span>
										</span>
										<span>Open a documentation issue</span>
									</a>
									<a
										href="https://github.com/dotnet/aspnetcore/blob/main/CONTRIBUTING.md"
										class="display-block margin-top-auto font-size-md"
										data-feedback-product-url
									>
										<span class="icon margin-right-xxs" aria-hidden="true">
											<span class="docon docon-feedback"></span>
										</span>
										<span>Provide product feedback</span>
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!-- end feedback section -->
	
			
		<!-- feedback section -->
		<section
			id="site-user-feedback-footer"
			class="font-size-sm margin-top-md display-none-print display-none-desktop"
			data-test-id="site-user-feedback-footer"
			data-bi-name="site-feedback-section"
		>
			<hr class="hr" />
			<h2 id="ms--feedback" class="title is-3">Feedback</h2>
			<div class="display-flex flex-wrap-wrap align-items-center">
				<p class="font-weight-semibold margin-xxs margin-left-none">
					Was this page helpful?
				</p>
				<div class="buttons">
					<button
						class="thumb-rating-button like button button-primary button-sm"
						data-test-id="footer-rating-yes"
						data-binary-rating-response="rating-yes"
						type="button"
						title="This article is helpful"
						data-bi-name="button-rating-yes"
						aria-pressed="false"
					>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-like"></span>
						</span>
						<span>Yes</span>
					</button>
					<button
						class="thumb-rating-button dislike button button-primary button-sm"
						data-test-id="footer-rating-no"
						data-binary-rating-response="rating-no"
						type="button"
						title="This article is not helpful"
						data-bi-name="button-rating-no"
						aria-pressed="false"
					>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-dislike"></span>
						</span>
						<span>No</span>
					</button>
				</div>
			</div>
		</section>
		<!-- end feedback section -->
	
		
				</div>
				
		<div id="ms--additional-resources-mobile" class="display-none-print">
			<hr class="hr" hidden />
			<h2 id="ms--additional-resources-mobile-heading" class="title is-3" hidden>
				Additional resources
			</h2>
			
		<section
			id="right-rail-recommendations-mobile"
			class=""
			data-bi-name="recommendations"
			hidden
		></section>
	 
		<section
			id="right-rail-training-mobile"
			class=""
			data-bi-name="learning-resource-card"
			hidden
		></section>
	 
		<section
			id="right-rail-events-mobile"
			class=""
			data-bi-name="events-card"
			hidden
		></section>
	 
		<section
			id="right-rail-qna-mobile"
			class="margin-top-xxs"
			data-bi-name="qna-link-card"
			hidden
		></section>
	
		</div>
	
			</div>
			
		<div
			id="action-panel"
			role="region"
			aria-label="Action Panel"
			class="action-panel"
			tabindex="-1"
		></div>
	
		
				</main>
				<aside
					id="layout-body-aside"
					class="layout-body-aside "
					data-bi-name="aside"
			  >
					
		<div
			id="ms--additional-resources"
			class="right-container padding-sm display-none display-block-desktop height-full"
			data-bi-name="pageactions"
			role="complementary"
			aria-label="Additional resources"
		>
			<div id="affixed-right-container" data-bi-name="right-column">
				
		<nav
			id="side-doc-outline"
			class="doc-outline border-bottom padding-bottom-xs margin-bottom-xs"
			data-bi-name="intopic toc"
			aria-label="In this article"
		>
			<h3>In this article</h3>
		</nav>
	
				<!-- Feedback -->
				
		<section
			id="ms--site-user-feedback-right-rail"
			class="font-size-sm display-none-print"
			data-test-id="site-user-feedback-right-rail"
			data-bi-name="site-feedback-right-rail"
		>
			<p class="font-weight-semibold margin-bottom-xs">Was this page helpful?</p>
			<div class="buttons">
				<button
					class="thumb-rating-button like button button-primary button-sm"
					data-test-id="right-rail-rating-yes"
					data-binary-rating-response="rating-yes"
					type="button"
					title="This article is helpful"
					data-bi-name="button-rating-yes"
					aria-pressed="false"
				>
					<span class="icon" aria-hidden="true">
						<span class="docon docon-like"></span>
					</span>
					<span>Yes</span>
				</button>
				<button
					class="thumb-rating-button dislike button button-primary button-sm"
					data-test-id="right-rail-rating-no"
					data-binary-rating-response="rating-no"
					type="button"
					title="This article is not helpful"
					data-bi-name="button-rating-no"
					aria-pressed="false"
				>
					<span class="icon" aria-hidden="true">
						<span class="docon docon-dislike"></span>
					</span>
					<span>No</span>
				</button>
			</div>
		</section>
	
			</div>
		</div>
	
			  </aside> <section
					id="layout-body-flyout"
					class="layout-body-flyout "
					data-bi-name="flyout"
			  >
					 <div
	class="height-full border-left background-color-body-medium"
	id="ask-learn-flyout"
></div>
			  </section> <div class="layout-body-footer " data-bi-name="layout-footer">
		<footer
			id="footer"
			data-test-id="footer"
			data-bi-name="footer"
			class="footer-layout has-padding has-default-focus border-top  uhf-container"
			role="contentinfo"
		>
			<div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop">
				
		<a
			data-mscc-ic="false"
			href="#"
			data-bi-name="select-locale"
			class="locale-selector-link flex-shrink-0 button button-sm button-clear external-link-indicator"
			id=""
			title=""
			><span class="icon" aria-hidden="true"
				><span class="docon docon-world"></span></span
			><span class="local-selector-link-text">en-us</span></a
		>
	
				<div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
		
		<a
			data-mscc-ic="false"
			href="https://aka.ms/yourcaliforniaprivacychoices"
			data-bi-name="your-privacy-choices"
			class="button button-sm button-clear flex-shrink-0 external-link-indicator"
			id=""
			title=""
			>
		<svg
			xmlns="http://www.w3.org/2000/svg"
			viewBox="0 0 30 14"
			xml:space="preserve"
			height="16"
			width="43"
			aria-hidden="true"
			focusable="false"
		>
			<path
				d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z"
				style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"
			></path>
			<path
				d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z"
				style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"
			></path>
			<path
				d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z"
				style="fill:#fff"
			></path>
			<path
				d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z"
				style="fill:#06f"
			></path>
		</svg>
	
			<span>Your Privacy Choices</span></a
		>
	
	</div>
				<div class="flex-shrink-0">
		<div class="dropdown has-caret-up">
			<button
				data-test-id="theme-selector-button"
				class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
				aria-controls="{{ themeMenuId }}"
				aria-expanded="false"
				title="Theme"
				data-bi-name="theme"
			>
				<span class="icon">
					<span class="docon docon-sun" aria-hidden="true"></span>
				</span>
				<span>Theme</span>
				<span class="icon expanded-indicator" aria-hidden="true">
					<span class="docon docon-chevron-down-light"></span>
				</span>
			</button>
			<div class="dropdown-menu" id="{{ themeMenuId }}" role="menu">
				<ul class="theme-selector padding-xxs" data-test-id="theme-dropdown-menu">
					<li class="theme display-block">
						<button
							class="button button-clear button-sm theme-control button-block justify-content-flex-start text-align-left"
							data-theme-to="light"
						>
							<span class="theme-light margin-right-xxs">
								<span
									class="theme-selector-icon border display-inline-block has-body-background"
									aria-hidden="true"
								>
									<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
										<rect width="22" height="14" class="has-fill-body-background" />
										<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
										<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
										<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
										<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
										<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
									</svg>
								</span>
							</span>
							<span role="menuitem"> Light </span>
						</button>
					</li>
					<li class="theme display-block">
						<button
							class="button button-clear button-sm theme-control button-block justify-content-flex-start text-align-left"
							data-theme-to="dark"
						>
							<span class="theme-dark margin-right-xxs">
								<span
									class="border theme-selector-icon display-inline-block has-body-background"
									aria-hidden="true"
								>
									<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
										<rect width="22" height="14" class="has-fill-body-background" />
										<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
										<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
										<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
										<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
										<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
									</svg>
								</span>
							</span>
							<span role="menuitem"> Dark </span>
						</button>
					</li>
					<li class="theme display-block">
						<button
							class="button button-clear button-sm theme-control button-block justify-content-flex-start text-align-left"
							data-theme-to="high-contrast"
						>
							<span class="theme-high-contrast margin-right-xxs">
								<span
									class="border theme-selector-icon display-inline-block has-body-background"
									aria-hidden="true"
								>
									<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
										<rect width="22" height="14" class="has-fill-body-background" />
										<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
										<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
										<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
										<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
										<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
									</svg>
								</span>
							</span>
							<span role="menuitem"> High contrast </span>
						</button>
					</li>
				</ul>
			</div>
		</div>
	</div>
			</div>
			<ul class="links" data-bi-name="footerlinks">
				<li class="manage-cookies-holder" hidden=""></li>
				<li>
		
		<a
			data-mscc-ic="false"
			href="https://learn.microsoft.com/en-us/principles-for-ai-generated-content"
			data-bi-name="aiDisclaimer"
			class=" external-link-indicator"
			id=""
			title=""
			>AI Disclaimer</a
		>
	
	</li><li>
		
		<a
			data-mscc-ic="false"
			href="https://learn.microsoft.com/en-us/previous-versions/"
			data-bi-name="archivelink"
			class=" external-link-indicator"
			id=""
			title=""
			>Previous Versions</a
		>
	
	</li> <li>
		
		<a
			data-mscc-ic="false"
			href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog"
			data-bi-name="bloglink"
			class=" external-link-indicator"
			id=""
			title=""
			>Blog</a
		>
	
	</li> <li>
		
		<a
			data-mscc-ic="false"
			href="https://learn.microsoft.com/en-us/contribute"
			data-bi-name="contributorGuide"
			class=" external-link-indicator"
			id=""
			title=""
			>Contribute</a
		>
	
	</li><li>
		
		<a
			data-mscc-ic="false"
			href="https://go.microsoft.com/fwlink/?LinkId=521839"
			data-bi-name="privacy"
			class=" external-link-indicator"
			id=""
			title=""
			>Privacy</a
		>
	
	</li><li>
		
		<a
			data-mscc-ic="false"
			href="https://learn.microsoft.com/en-us/legal/termsofuse"
			data-bi-name="termsofuse"
			class=" external-link-indicator"
			id=""
			title=""
			>Terms of Use</a
		>
	
	</li><li>
		
		<a
			data-mscc-ic="false"
			href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/"
			data-bi-name="trademarks"
			class=" external-link-indicator"
			id=""
			title=""
			>Trademarks</a
		>
	
	</li>
				<li>&copy; Microsoft 2025</li>
			</ul>
		</footer>
	</footer>
			</body>
		
<!-- Mirrored from learn.microsoft.com/en-us/aspnet/core/fundamentals/servers/httpsys?view=aspnetcore-9.0 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Aug 2025 14:53:03 GMT -->
</html>