<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from perldoc.perl.org/5.005_02/perlxstut by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Aug 2025 16:20:47 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>perlXStut - Tutorial for XSUBs - Perldoc Browser</title>
    <link rel="search" href="../opensearch.xml" type="application/opensearchdescription+xml" title="Perldoc Browser">
    <link rel="canonical" href="../perlxstut.html">
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/stackoverflow-light.min.css" rel="stylesheet">
    <link href="../css/perldoc.css" rel="stylesheet">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KVNWBNT5FB"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-KVNWBNT5FB');
      gtag('config', 'UA-50555-3');
    </script>
  </head>
  <body>
    <nav class="navbar navbar-expand-md bg-dark" data-bs-theme="dark"><div class="container-fluid">
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a class="navbar-brand" href="../index.html"><img src="../images/perl_camel_30.png" width="30" height="30" class="d-inline-block align-text-top" alt="Perl Camel Logo"> Perldoc Browser</a>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav me-auto">
      <li class="nav-item dropdown text-nowrap">
        <a class="nav-link dropdown-toggle" href="#" id="dropdownlink-stable" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">5.005_02</a>
        <div class="dropdown-menu" aria-labelledby="dropdownlink-stable">
          <a class="dropdown-item" href="../perlxstut.html">Latest</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0/perlxstut">5.42.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.3/perlxstut">5.40.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.2/perlxstut">5.40.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.1/perlxstut">5.40.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.0/perlxstut">5.40.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.5/perlxstut">5.38.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.4/perlxstut">5.38.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.3/perlxstut">5.38.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.2/perlxstut">5.38.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.1/perlxstut">5.38.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.0/perlxstut">5.38.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.3/perlxstut">5.36.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.2/perlxstut">5.36.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.1/perlxstut">5.36.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.0/perlxstut">5.36.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.3/perlxstut">5.34.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.2/perlxstut">5.34.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.1/perlxstut">5.34.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.0/perlxstut">5.34.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.32.1/perlxstut">5.32.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.32.0/perlxstut">5.32.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.3/perlxstut">5.30.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.2/perlxstut">5.30.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.1/perlxstut">5.30.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.0/perlxstut">5.30.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.3/perlxstut">5.28.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.2/perlxstut">5.28.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.1/perlxstut">5.28.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.0/perlxstut">5.28.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.3/perlxstut">5.26.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.2/perlxstut">5.26.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.1/perlxstut">5.26.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.0/perlxstut">5.26.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.4/perlxstut">5.24.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.3/perlxstut">5.24.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.2/perlxstut">5.24.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.1/perlxstut">5.24.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.0/perlxstut">5.24.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.4/perlxstut">5.22.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.3/perlxstut">5.22.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.2/perlxstut">5.22.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.1/perlxstut">5.22.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.0/perlxstut">5.22.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.3/perlxstut">5.20.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.2/perlxstut">5.20.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.1/perlxstut">5.20.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.0/perlxstut">5.20.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.4/perlxstut">5.18.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.3/perlxstut">5.18.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.2/perlxstut">5.18.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.1/perlxstut">5.18.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.0/perlxstut">5.18.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="../5.16.3/perlxstut.html">5.16.3</a>
          <a class="dropdown-item" href="../5.16.2/perlxstut.html">5.16.2</a>
          <a class="dropdown-item" href="../5.16.1/perlxstut.html">5.16.1</a>
          <a class="dropdown-item" href="../5.16.0/perlxstut.html">5.16.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="../5.14.4/perlxstut.html">5.14.4</a>
          <a class="dropdown-item" href="../5.14.3/perlxstut.html">5.14.3</a>
          <a class="dropdown-item" href="../5.14.2/perlxstut.html">5.14.2</a>
          <a class="dropdown-item" href="../5.14.1/perlxstut.html">5.14.1</a>
          <a class="dropdown-item" href="../5.14.0/perlxstut.html">5.14.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="../5.12.5/perlxstut.html">5.12.5</a>
          <a class="dropdown-item" href="../5.12.4/perlxstut.html">5.12.4</a>
          <a class="dropdown-item" href="../5.12.3/perlxstut.html">5.12.3</a>
          <a class="dropdown-item" href="../5.12.2/perlxstut.html">5.12.2</a>
          <a class="dropdown-item" href="../5.12.1/perlxstut.html">5.12.1</a>
          <a class="dropdown-item" href="../5.12.0/perlxstut.html">5.12.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="../5.10.1/perlxstut.html">5.10.1</a>
          <a class="dropdown-item" href="../5.10.0/perlxstut.html">5.10.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="../5.8.9/perlxstut.html">5.8.9</a>
          <a class="dropdown-item" href="../5.8.8/perlxstut.html">5.8.8</a>
          <a class="dropdown-item" href="../5.8.7/perlxstut.html">5.8.7</a>
          <a class="dropdown-item" href="../5.8.6/perlxstut.html">5.8.6</a>
          <a class="dropdown-item" href="../5.8.5/perlxstut.html">5.8.5</a>
          <a class="dropdown-item" href="../5.8.4/perlxstut.html">5.8.4</a>
          <a class="dropdown-item" href="../5.8.3/perlxstut.html">5.8.3</a>
          <a class="dropdown-item" href="../5.8.2/perlxstut.html">5.8.2</a>
          <a class="dropdown-item" href="../5.8.1/perlxstut.html">5.8.1</a>
          <a class="dropdown-item" href="../5.8.0/perlxstut.html">5.8.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="../5.6.2/perlxstut.html">5.6.2</a>
          <a class="dropdown-item" href="../5.6.1/perlxstut.html">5.6.1</a>
          <a class="dropdown-item" href="../5.6.0/perlxstut.html">5.6.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="../5.005_04/perlxstut.html">5.005_04</a>
          <a class="dropdown-item" href="../5.005_03/perlxstut.html">5.005_03</a>
          <a class="dropdown-item active" href="perlxstut.html">5.005_02</a>
          <a class="dropdown-item" href="../5.005_01/perlxstut.html">5.005_01</a>
          <a class="dropdown-item" href="../5.005/perlxstut.html">5.005</a>
        </div>
      </li>
      <li class="nav-item dropdown text-nowrap">
        <a class="nav-link dropdown-toggle" href="#" id="dropdownlink-dev" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dev</a>
        <div class="dropdown-menu" aria-labelledby="dropdownlink-dev">
          <a class="dropdown-item" href="https://perldoc.perl.org/blead/perlxstut">blead</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.43.1/perlxstut">5.43.1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0-RC3/perlxstut">5.42.0-RC3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0-RC2/perlxstut">5.42.0-RC2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0-RC1/perlxstut">5.42.0-RC1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.13/perlxstut">5.41.13</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.12/perlxstut">5.41.12</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.11/perlxstut">5.41.11</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.10/perlxstut">5.41.10</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.9/perlxstut">5.41.9</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.8/perlxstut">5.41.8</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.7/perlxstut">5.41.7</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.6/perlxstut">5.41.6</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.5/perlxstut">5.41.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.4/perlxstut">5.41.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.3/perlxstut">5.41.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.2/perlxstut">5.41.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.1/perlxstut">5.41.1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.3-RC1/perlxstut">5.40.3-RC1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.5-RC1/perlxstut">5.38.5-RC1</a>
        </div>
      </li>
      <li class="nav-item dropdown text-nowrap">
        <a class="nav-link dropdown-toggle" href="#" id="dropdownlink-nav" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Documentation</a>
        <div class="dropdown-menu" aria-labelledby="dropdownlink-nav">
          <a class="dropdown-item" href="perl.html">Perl</a>
          <a class="dropdown-item" href="perlintro.html">Intro</a>
          <a class="dropdown-item" href="perl.html#Tutorials">Tutorials</a>
          <a class="dropdown-item" href="perlfaq.html">FAQs</a>
          <a class="dropdown-item" href="perl.html#Reference-Manual">Reference</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="perlop.html">Operators</a>
          <a class="dropdown-item" href="functions.html">Functions</a>
          <a class="dropdown-item" href="variables.html">Variables</a>
          <a class="dropdown-item" href="modules.html">Modules</a>
          <a class="dropdown-item" href="perlutil.html">Utilities</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="perldelta.html">Release Notes</a>
          <a class="dropdown-item" href="perlcommunity.html">Community</a>
          <a class="dropdown-item" href="perlhist.html">History</a>
        </div>
      </li>
    </ul>
    <ul class="navbar-nav">
      <button id="content-expand-button" type="button" class="btn btn-dark d-none d-lg-inline-block me-4">Expand</button>
      <script src="../js/perldoc-expand-page.js"></script>
    </ul>
    <form class="form-inline" method="get" action="https://perldoc.perl.org/5.005_02/search">
      <input id="search-input" class="form-control me-3" type="search" name="q" placeholder="[S]earch" aria-label="Search" value="">
    </form>
    <script src="../js/perldoc-focus-search.js"></script>
  </div>
</div></nav>

    <div id="wrapperlicious" class="container-fluid">
      <div id="perldocdiv">
        <div id="links">
          <a href="perlxstut.html">perlxstut</a>
          <div id="more">
            (<a href="https://perldoc.perl.org/5.005_02/perlxstut.txt">source</a>,
            <a href="https://metacpan.org/pod/perlxstut">CPAN</a>)
          </div>
        </div>
        <div class="leading-notice">
          You are viewing the version of this documentation from Perl 5.005_02.
            <a href="../perlxstut.html">View the latest version</a>
        </div>
        <h1><a id="toc">CONTENTS</a></h1>
                  <ul>
              <li>
                <a class="text-decoration-none" href="#NAME">NAME</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#DESCRIPTION">DESCRIPTION</a>
                            <ul>
              <li>
                <a class="text-decoration-none" href="#VERSION-CAVEAT">VERSION CAVEAT</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#DYNAMIC-VERSUS-STATIC">DYNAMIC VERSUS STATIC</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#EXAMPLE-1">EXAMPLE 1</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#EXAMPLE-2">EXAMPLE 2</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#WHAT-HAS-GONE-ON?">WHAT HAS GONE ON?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#WRITING-GOOD-TEST-SCRIPTS">WRITING GOOD TEST SCRIPTS</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#EXAMPLE-3">EXAMPLE 3</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#WHAT&#39;S-NEW-HERE?">WHAT&#39;S NEW HERE?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#INPUT-AND-OUTPUT-PARAMETERS">INPUT AND OUTPUT PARAMETERS</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#THE-XSUBPP-COMPILER">THE XSUBPP COMPILER</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#THE-TYPEMAP-FILE">THE TYPEMAP FILE</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#WARNING">WARNING</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#EXAMPLE-4">EXAMPLE 4</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#WHAT-HAS-HAPPENED-HERE?">WHAT HAS HAPPENED HERE?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#SPECIFYING-ARGUMENTS-TO-XSUBPP">SPECIFYING ARGUMENTS TO XSUBPP</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#THE-ARGUMENT-STACK">THE ARGUMENT STACK</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#EXTENDING-YOUR-EXTENSION">EXTENDING YOUR EXTENSION</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#DOCUMENTING-YOUR-EXTENSION">DOCUMENTING YOUR EXTENSION</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#INSTALLING-YOUR-EXTENSION">INSTALLING YOUR EXTENSION</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#SEE-ALSO">SEE ALSO</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#Author">Author</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#Last-Changed">Last Changed</a>
              </li>
          </ul>

              </li>
          </ul>

      <h1 id="NAME"><a class="permalink" href="#NAME">#</a>NAME</h1>

<p>perlXStut - Tutorial for XSUBs</p>

<h1 id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">#</a>DESCRIPTION</h1>

<p>This tutorial will educate the reader on the steps involved in creating a Perl extension. The reader is assumed to have access to <a href="perlguts.html">perlguts</a> and <a href="perlxs.html">perlxs</a>.</p>

<p>This tutorial starts with very simple examples and becomes more complex, with each new example adding new features. Certain concepts may not be completely explained until later in the tutorial to ease the reader slowly into building extensions.</p>

<h2 id="VERSION-CAVEAT"><a class="permalink" href="#VERSION-CAVEAT">#</a><a id="VERSION"></a>VERSION CAVEAT</h2>

<p>This tutorial tries hard to keep up with the latest development versions of Perl. This often means that it is sometimes in advance of the latest released version of Perl, and that certain features described here might not work on earlier versions. This section will keep track of when various features were added to Perl 5.</p>

<ul>

<li><p>In versions of Perl 5.002 prior to the gamma version, the test script in Example 1 will not function properly. You need to change the &quot;use lib&quot; line to read:</p>

<pre><code>use lib &#39;./blib&#39;;</code></pre>

</li>
<li><p>In versions of Perl 5.002 prior to version beta 3, the line in the .xs file about &quot;PROTOTYPES: DISABLE&quot; will cause a compiler error. Simply remove that line from the file.</p>

</li>
<li><p>In versions of Perl 5.002 prior to version 5.002b1h, the test.pl file was not automatically created by h2xs. This means that you cannot say &quot;make test&quot; to run the test script. You will need to add the following line before the &quot;use extension&quot; statement:</p>

<pre><code>use lib &#39;./blib&#39;;</code></pre>

</li>
<li><p>In versions 5.000 and 5.001, instead of using the above line, you will need to use the following line:</p>

<pre><code>BEGIN { unshift(@INC, &quot;./blib&quot;) }</code></pre>

</li>
<li><p>This document assumes that the executable named &quot;perl&quot; is Perl version 5. Some systems may have installed Perl version 5 as &quot;perl5&quot;.</p>

</li>
</ul>

<h2 id="DYNAMIC-VERSUS-STATIC"><a class="permalink" href="#DYNAMIC-VERSUS-STATIC">#</a><a id="DYNAMIC"></a>DYNAMIC VERSUS STATIC</h2>

<p>It is commonly thought that if a system does not have the capability to load a library dynamically, you cannot build XSUBs. This is incorrect. You <i>can</i> build them, but you must link the XSUB&#39;s subroutines with the rest of Perl, creating a new executable. This situation is similar to Perl 4.</p>

<p>This tutorial can still be used on such a system. The XSUB build mechanism will check the system and build a dynamically-loadable library if possible, or else a static library and then, optionally, a new statically-linked executable with that static library linked in.</p>

<p>Should you wish to build a statically-linked executable on a system which can dynamically load libraries, you may, in all the following examples, where the command &quot;make&quot; with no arguments is executed, run the command &quot;make perl&quot; instead.</p>

<p>If you have generated such a statically-linked executable by choice, then instead of saying &quot;make test&quot;, you should say &quot;make test_static&quot;. On systems that cannot build dynamically-loadable libraries at all, simply saying &quot;make test&quot; is sufficient.</p>

<h2 id="EXAMPLE-1"><a class="permalink" href="#EXAMPLE-1">#</a><a id="EXAMPLE"></a>EXAMPLE 1</h2>

<p>Our first extension will be very simple. When we call the routine in the extension, it will print out a well-known message and return.</p>

<p>Run <code>h2xs -A -n Mytest</code>. This creates a directory named Mytest, possibly under ext/ if that directory exists in the current working directory. Several files will be created in the Mytest dir, including MANIFEST, Makefile.PL, Mytest.pm, Mytest.xs, test.pl, and Changes.</p>

<p>The MANIFEST file contains the names of all the files created.</p>

<p>The file Makefile.PL should look something like this:</p>

<pre><code>use ExtUtils::MakeMaker;
# See lib/ExtUtils/MakeMaker.pm for details of how to influence
# the contents of the Makefile that is written.
WriteMakefile(
    &#39;NAME&#39;      =&gt; &#39;Mytest&#39;,
    &#39;VERSION_FROM&#39; =&gt; &#39;Mytest.pm&#39;, # finds $VERSION
    &#39;LIBS&#39;      =&gt; [&#39;&#39;],   # e.g., &#39;-lm&#39;
    &#39;DEFINE&#39;    =&gt; &#39;&#39;,     # e.g., &#39;-DHAVE_SOMETHING&#39;
    &#39;INC&#39;       =&gt; &#39;&#39;,     # e.g., &#39;-I/usr/include/other&#39;
);</code></pre>

<p>The file Mytest.pm should start with something like this:</p>

<pre><code>package Mytest;

require Exporter;
require DynaLoader;

@ISA = qw(Exporter DynaLoader);
# Items to export into callers namespace by default. Note: do not export
# names by default without a very good reason. Use EXPORT_OK instead.
# Do not simply export all your public functions/methods/constants.
@EXPORT = qw(

);
$VERSION = &#39;0.01&#39;;

bootstrap Mytest $VERSION;

# Preloaded methods go here.

# Autoload methods go after __END__, and are processed by the autosplit program.

1;
__END__
# Below is the stub of documentation for your module. You better edit it!</code></pre>

<p>And the Mytest.xs file should look something like this:</p>

<pre><code>#ifdef __cplusplus
extern &quot;C&quot; {
#endif
#include &quot;EXTERN.h&quot;
#include &quot;perl.h&quot;
#include &quot;XSUB.h&quot;
#ifdef __cplusplus
}
#endif

PROTOTYPES: DISABLE

MODULE = Mytest		PACKAGE = Mytest</code></pre>

<p>Let&#39;s edit the .xs file by adding this to the end of the file:</p>

<pre><code>void
hello()
	CODE:
	printf(&quot;Hello, world!\n&quot;);</code></pre>

<p>Now we&#39;ll run &quot;perl Makefile.PL&quot;. This will create a real Makefile, which make needs. Its output looks something like:</p>

<pre><code class="plaintext">% perl Makefile.PL
Checking if your kit is complete...
Looks good
Writing Makefile for Mytest
%</code></pre>

<p>Now, running make will produce output that looks something like this (some long lines shortened for clarity):</p>

<pre><code class="plaintext">% make
umask 0 &amp;&amp; cp Mytest.pm ./blib/Mytest.pm
perl xsubpp -typemap typemap Mytest.xs &gt;Mytest.tc &amp;&amp; mv Mytest.tc Mytest.c
cc -c Mytest.c
Running Mkbootstrap for Mytest ()
chmod 644 Mytest.bs
LD_RUN_PATH=&quot;&quot; ld -o ./blib/PA-RISC1.1/auto/Mytest/Mytest.sl -b Mytest.o
chmod 755 ./blib/PA-RISC1.1/auto/Mytest/Mytest.sl
cp Mytest.bs ./blib/PA-RISC1.1/auto/Mytest/Mytest.bs
chmod 644 ./blib/PA-RISC1.1/auto/Mytest/Mytest.bs</code></pre>

<p>Now, although there is already a test.pl template ready for us, for this example only, we&#39;ll create a special test script. Create a file called hello that looks like this:</p>

<pre><code>#! /opt/perl5/bin/perl

use ExtUtils::testlib;

use Mytest;

Mytest::hello();</code></pre>

<p>Now we run the script and we should see the following output:</p>

<pre><code class="plaintext">% perl hello
Hello, world!
%</code></pre>

<h2 id="EXAMPLE-2"><a class="permalink" href="#EXAMPLE-2">#</a><a id="EXAMPLE1"></a>EXAMPLE 2</h2>

<p>Now let&#39;s add to our extension a subroutine that will take a single argument and return 1 if the argument is even, 0 if the argument is odd.</p>

<p>Add the following to the end of Mytest.xs:</p>

<pre><code>int
is_even(input)
	int	input
	CODE:
	RETVAL = (input % 2 == 0);
	OUTPUT:
	RETVAL</code></pre>

<p>There does not need to be white space at the start of the &quot;int input&quot; line, but it is useful for improving readability. The semi-colon at the end of that line is also optional.</p>

<p>Any white space may be between the &quot;int&quot; and &quot;input&quot;. It is also okay for the four lines starting at the &quot;CODE:&quot; line to not be indented. However, for readability purposes, it is suggested that you indent them 8 spaces (or one normal tab stop).</p>

<p>Now rerun make to rebuild our new shared library.</p>

<p>Now perform the same steps as before, generating a Makefile from the Makefile.PL file, and running make.</p>

<p>To test that our extension works, we now need to look at the file test.pl. This file is set up to imitate the same kind of testing structure that Perl itself has. Within the test script, you perform a number of tests to confirm the behavior of the extension, printing &quot;ok&quot; when the test is correct, &quot;not ok&quot; when it is not. Change the print statement in the BEGIN block to print &quot;1..4&quot;, and add the following code to the end of the file:</p>

<pre><code>print &amp;Mytest::is_even(0) == 1 ? &quot;ok 2&quot; : &quot;not ok 2&quot;, &quot;\n&quot;;
print &amp;Mytest::is_even(1) == 0 ? &quot;ok 3&quot; : &quot;not ok 3&quot;, &quot;\n&quot;;
print &amp;Mytest::is_even(2) == 1 ? &quot;ok 4&quot; : &quot;not ok 4&quot;, &quot;\n&quot;;</code></pre>

<p>We will be calling the test script through the command &quot;make test&quot;. You should see output that looks something like this:</p>

<pre><code class="plaintext">% make test
PERL_DL_NONLAZY=1 /opt/perl5.002b2/bin/perl (lots of -I arguments) test.pl
1..4
ok 1
ok 2
ok 3
ok 4
%</code></pre>

<h2 id="WHAT-HAS-GONE-ON?"><a class="permalink" href="#WHAT-HAS-GONE-ON?">#</a><a id="WHAT"></a><a id="WHAT-HAS-GONE-ON"></a>WHAT HAS GONE ON?</h2>

<p>The program h2xs is the starting point for creating extensions. In later examples we&#39;ll see how we can use h2xs to read header files and generate templates to connect to C routines.</p>

<p>h2xs creates a number of files in the extension directory. The file Makefile.PL is a perl script which will generate a true Makefile to build the extension. We&#39;ll take a closer look at it later.</p>

<p>The files &lt;extension&gt;.pm and &lt;extension&gt;.xs contain the meat of the extension. The .xs file holds the C routines that make up the extension. The .pm file contains routines that tell Perl how to load your extension.</p>

<p>Generating and invoking the Makefile created a directory blib (which stands for &quot;build library&quot;) in the current working directory. This directory will contain the shared library that we will build. Once we have tested it, we can install it into its final location.</p>

<p>Invoking the test script via &quot;make test&quot; did something very important. It invoked perl with all those <code>-I</code> arguments so that it could find the various files that are part of the extension.</p>

<p>It is <i>very</i> important that while you are still testing extensions that you use &quot;make test&quot;. If you try to run the test script all by itself, you will get a fatal error.</p>

<p>Another reason it is important to use &quot;make test&quot; to run your test script is that if you are testing an upgrade to an already-existing version, using &quot;make test&quot; insures that you use your new extension, not the already-existing version.</p>

<p>When Perl sees a <code>use extension;</code>, it searches for a file with the same name as the use&#39;d extension that has a .pm suffix. If that file cannot be found, Perl dies with a fatal error. The default search path is contained in the @INC array.</p>

<p>In our case, Mytest.pm tells perl that it will need the Exporter and Dynamic Loader extensions. It then sets the @ISA and @EXPORT arrays and the $VERSION scalar; finally it tells perl to bootstrap the module. Perl will call its dynamic loader routine (if there is one) and load the shared library.</p>

<p>The two arrays that are set in the .pm file are very important. The @ISA array contains a list of other packages in which to search for methods (or subroutines) that do not exist in the current package. The @EXPORT array tells Perl which of the extension&#39;s routines should be placed into the calling package&#39;s namespace.</p>

<p>It&#39;s important to select what to export carefully. Do NOT export method names and do NOT export anything else <i>by default</i> without a good reason.</p>

<p>As a general rule, if the module is trying to be object-oriented then don&#39;t export anything. If it&#39;s just a collection of functions then you can export any of the functions via another array, called @EXPORT_OK.</p>

<p>See <a href="perlmod.html">perlmod</a> for more information.</p>

<p>The $VERSION variable is used to ensure that the .pm file and the shared library are &quot;in sync&quot; with each other. Any time you make changes to the .pm or .xs files, you should increment the value of this variable.</p>

<h2 id="WRITING-GOOD-TEST-SCRIPTS"><a class="permalink" href="#WRITING-GOOD-TEST-SCRIPTS">#</a><a id="WRITING"></a>WRITING GOOD TEST SCRIPTS</h2>

<p>The importance of writing good test scripts cannot be overemphasized. You should closely follow the &quot;ok/not ok&quot; style that Perl itself uses, so that it is very easy and unambiguous to determine the outcome of each test case. When you find and fix a bug, make sure you add a test case for it.</p>

<p>By running &quot;make test&quot;, you ensure that your test.pl script runs and uses the correct version of your extension. If you have many test cases, you might want to copy Perl&#39;s test style. Create a directory named &quot;t&quot;, and ensure all your test files end with the suffix &quot;.t&quot;. The Makefile will properly run all these test files.</p>

<h2 id="EXAMPLE-3"><a class="permalink" href="#EXAMPLE-3">#</a><a id="EXAMPLE2"></a>EXAMPLE 3</h2>

<p>Our third extension will take one argument as its input, round off that value, and set the <i>argument</i> to the rounded value.</p>

<p>Add the following to the end of Mytest.xs:</p>

<pre><code>void
round(arg)
	double  arg
	CODE:
	if (arg &gt; 0.0) {
		arg = floor(arg + 0.5);
	} else if (arg &lt; 0.0) {
		arg = ceil(arg - 0.5);
	} else {
		arg = 0.0;
	}
	OUTPUT:
	arg</code></pre>

<p>Edit the Makefile.PL file so that the corresponding line looks like this:</p>

<pre><code class="plaintext">&#39;LIBS&#39;      =&gt; [&#39;-lm&#39;],   # e.g., &#39;-lm&#39;</code></pre>

<p>Generate the Makefile and run make. Change the BEGIN block to print out &quot;1..9&quot; and add the following to test.pl:</p>

<pre><code>$i = -1.5; &amp;Mytest::round($i); print $i == -2.0 ? &quot;ok 5&quot; : &quot;not ok 5&quot;, &quot;\n&quot;;
$i = -1.1; &amp;Mytest::round($i); print $i == -1.0 ? &quot;ok 6&quot; : &quot;not ok 6&quot;, &quot;\n&quot;;
$i = 0.0; &amp;Mytest::round($i); print $i == 0.0 ? &quot;ok 7&quot; : &quot;not ok 7&quot;, &quot;\n&quot;;
$i = 0.5; &amp;Mytest::round($i); print $i == 1.0 ? &quot;ok 8&quot; : &quot;not ok 8&quot;, &quot;\n&quot;;
$i = 1.2; &amp;Mytest::round($i); print $i == 1.0 ? &quot;ok 9&quot; : &quot;not ok 9&quot;, &quot;\n&quot;;</code></pre>

<p>Running &quot;make test&quot; should now print out that all nine tests are okay.</p>

<p>You might be wondering if you can round a constant. To see what happens, add the following line to test.pl temporarily:</p>

<pre><code>&amp;Mytest::round(3);</code></pre>

<p>Run &quot;make test&quot; and notice that Perl dies with a fatal error. Perl won&#39;t let you change the value of constants!</p>

<h2 id="WHAT&#39;S-NEW-HERE?"><a class="permalink" href="#WHAT&#39;S-NEW-HERE?">#</a><a id="WHAT1"></a><a id="WHATS-NEW-HERE"></a>WHAT&#39;S NEW HERE?</h2>

<p>Two things are new here. First, we&#39;ve made some changes to Makefile.PL. In this case, we&#39;ve specified an extra library to link in, the math library libm. We&#39;ll talk later about how to write XSUBs that can call every routine in a library.</p>

<p>Second, the value of the function is being passed back not as the function&#39;s return value, but through the same variable that was passed into the function.</p>

<h2 id="INPUT-AND-OUTPUT-PARAMETERS"><a class="permalink" href="#INPUT-AND-OUTPUT-PARAMETERS">#</a><a id="INPUT"></a>INPUT AND OUTPUT PARAMETERS</h2>

<p>You specify the parameters that will be passed into the XSUB just after you declare the function return value and name. Each parameter line starts with optional white space, and may have an optional terminating semicolon.</p>

<p>The list of output parameters occurs after the OUTPUT: directive. The use of RETVAL tells Perl that you wish to send this value back as the return value of the XSUB function. In Example 3, the value we wanted returned was contained in the same variable we passed in, so we listed it (and not RETVAL) in the OUTPUT: section.</p>

<h2 id="THE-XSUBPP-COMPILER"><a class="permalink" href="#THE-XSUBPP-COMPILER">#</a><a id="THE"></a>THE XSUBPP COMPILER</h2>

<p>The compiler xsubpp takes the XS code in the .xs file and converts it into C code, placing it in a file whose suffix is .c. The C code created makes heavy use of the C functions within Perl.</p>

<h2 id="THE-TYPEMAP-FILE"><a class="permalink" href="#THE-TYPEMAP-FILE">#</a><a id="THE1"></a>THE TYPEMAP FILE</h2>

<p>The xsubpp compiler uses rules to convert from Perl&#39;s data types (scalar, array, etc.) to C&#39;s data types (int, char *, etc.). These rules are stored in the typemap file ($PERLLIB/ExtUtils/typemap). This file is split into three parts.</p>

<p>The first part attempts to map various C data types to a coded flag, which has some correspondence with the various Perl types. The second part contains C code which xsubpp uses for input parameters. The third part contains C code which xsubpp uses for output parameters. We&#39;ll talk more about the C code later.</p>

<p>Let&#39;s now take a look at a portion of the .c file created for our extension.</p>

<pre><code>XS(XS_Mytest_round)
{
    dXSARGS;
    if (items != 1)
	croak(&quot;Usage: Mytest::round(arg)&quot;);
    {
	double  arg = (double)SvNV(ST(0));	/* XXXXX */
	if (arg &gt; 0.0) {
		arg = floor(arg + 0.5);
	} else if (arg &lt; 0.0) {
		arg = ceil(arg - 0.5);
	} else {
		arg = 0.0;
	}
	sv_setnv(ST(0), (double)arg);		/* XXXXX */
    }
    XSRETURN(1);
}</code></pre>

<p>Notice the two lines marked with &quot;XXXXX&quot;. If you check the first section of the typemap file, you&#39;ll see that doubles are of type T_DOUBLE. In the INPUT section, an argument that is T_DOUBLE is assigned to the variable arg by calling the routine SvNV on something, then casting it to double, then assigned to the variable arg. Similarly, in the OUTPUT section, once arg has its final value, it is passed to the sv_setnv function to be passed back to the calling subroutine. These two functions are explained in <a href="perlguts.html">perlguts</a>; we&#39;ll talk more later about what that &quot;ST(0)&quot; means in the section on the argument stack.</p>

<h2 id="WARNING"><a class="permalink" href="#WARNING">#</a>WARNING</h2>

<p>In general, it&#39;s not a good idea to write extensions that modify their input parameters, as in Example 3. However, to accommodate better calling pre-existing C routines, which often do modify their input parameters, this behavior is tolerated. The next example will show how to do this.</p>

<h2 id="EXAMPLE-4"><a class="permalink" href="#EXAMPLE-4">#</a><a id="EXAMPLE3"></a>EXAMPLE 4</h2>

<p>In this example, we&#39;ll now begin to write XSUBs that will interact with predefined C libraries. To begin with, we will build a small library of our own, then let h2xs write our .pm and .xs files for us.</p>

<p>Create a new directory called Mytest2 at the same level as the directory Mytest. In the Mytest2 directory, create another directory called mylib, and cd into that directory.</p>

<p>Here we&#39;ll create some files that will generate a test library. These will include a C source file and a header file. We&#39;ll also create a Makefile.PL in this directory. Then we&#39;ll make sure that running make at the Mytest2 level will automatically run this Makefile.PL file and the resulting Makefile.</p>

<p>In the testlib directory, create a file mylib.h that looks like this:</p>

<pre><code>#define TESTVAL	4

extern double	foo(int, long, const char*);</code></pre>

<p>Also create a file mylib.c that looks like this:</p>

<pre><code>#include &lt;stdlib.h&gt;
#include &quot;./mylib.h&quot;

double
foo(a, b, c)
int		a;
long		b;
const char *	c;
{
	return (a + b + atof(c) + TESTVAL);
}</code></pre>

<p>And finally create a file Makefile.PL that looks like this:</p>

<pre><code>use ExtUtils::MakeMaker;
$Verbose = 1;
WriteMakefile(
    NAME      =&gt; &#39;Mytest2::mylib&#39;,
    SKIP      =&gt; [qw(all static static_lib dynamic dynamic_lib)],
    clean     =&gt; {&#39;FILES&#39; =&gt; &#39;libmylib$(LIB_EXT)&#39;},
);


sub MY::top_targets {
	&#39;
all :: static

static ::       libmylib$(LIB_EXT)

libmylib$(LIB_EXT): $(O_FILES)
	$(AR) cr libmylib$(LIB_EXT) $(O_FILES)
	$(RANLIB) libmylib$(LIB_EXT)

&#39;;
}</code></pre>

<p>We will now create the main top-level Mytest2 files. Change to the directory above Mytest2 and run the following command:</p>

<pre><code class="plaintext">% h2xs -O -n Mytest2 ./Mytest2/mylib/mylib.h</code></pre>

<p>This will print out a warning about overwriting Mytest2, but that&#39;s okay. Our files are stored in Mytest2/mylib, and will be untouched.</p>

<p>The normal Makefile.PL that h2xs generates doesn&#39;t know about the mylib directory. We need to tell it that there is a subdirectory and that we will be generating a library in it. Let&#39;s add the following key-value pair to the WriteMakefile call:</p>

<pre><code class="plaintext">&#39;MYEXTLIB&#39; =&gt; &#39;mylib/libmylib$(LIB_EXT)&#39;,</code></pre>

<p>and a new replacement subroutine too:</p>

<pre><code>sub MY::postamble {
&#39;
$(MYEXTLIB): mylib/Makefile
	cd mylib &amp;&amp; $(MAKE) $(PASTHRU)
&#39;;
}</code></pre>

<p>(Note: Most makes will require that there be a tab character that indents the line <code>cd mylib &amp;&amp; $(MAKE) $(PASTHRU)</code>, similarly for the Makefile in the subdirectory.)</p>

<p>Let&#39;s also fix the MANIFEST file so that it accurately reflects the contents of our extension. The single line that says &quot;mylib&quot; should be replaced by the following three lines:</p>

<pre><code class="plaintext">mylib/Makefile.PL
mylib/mylib.c
mylib/mylib.h</code></pre>

<p>To keep our namespace nice and unpolluted, edit the .pm file and change the lines setting @EXPORT to @EXPORT_OK (there are two: one in the line beginning &quot;use vars&quot; and one setting the array itself). Finally, in the .xs file, edit the #include line to read:</p>

<pre><code class="plaintext">#include &quot;mylib/mylib.h&quot;</code></pre>

<p>And also add the following function definition to the end of the .xs file:</p>

<pre><code class="plaintext">double
foo(a,b,c)
	int             a
	long            b
	const char *    c
	OUTPUT:
	RETVAL</code></pre>

<p>Now we also need to create a typemap file because the default Perl doesn&#39;t currently support the const char * type. Create a file called typemap and place the following in it:</p>

<pre><code class="plaintext">const char *	T_PV</code></pre>

<p>Now run perl on the top-level Makefile.PL. Notice that it also created a Makefile in the mylib directory. Run make and see that it does cd into the mylib directory and run make in there as well.</p>

<p>Now edit the test.pl script and change the BEGIN block to print &quot;1..4&quot;, and add the following lines to the end of the script:</p>

<pre><code>print &amp;Mytest2::foo(1, 2, &quot;Hello, world!&quot;) == 7 ? &quot;ok 2\n&quot; : &quot;not ok 2\n&quot;;
print &amp;Mytest2::foo(1, 2, &quot;0.0&quot;) == 7 ? &quot;ok 3\n&quot; : &quot;not ok 3\n&quot;;
print abs(&amp;Mytest2::foo(0, 0, &quot;-3.4&quot;) - 0.6) &lt;= 0.01 ? &quot;ok 4\n&quot; : &quot;not ok 4\n&quot;;</code></pre>

<p>(When dealing with floating-point comparisons, it is often useful not to check for equality, but rather the difference being below a certain epsilon factor, 0.01 in this case)</p>

<p>Run &quot;make test&quot; and all should be well.</p>

<h2 id="WHAT-HAS-HAPPENED-HERE?"><a class="permalink" href="#WHAT-HAS-HAPPENED-HERE?">#</a><a id="WHAT2"></a><a id="WHAT-HAS-HAPPENED-HERE"></a>WHAT HAS HAPPENED HERE?</h2>

<p>Unlike previous examples, we&#39;ve now run h2xs on a real include file. This has caused some extra goodies to appear in both the .pm and .xs files.</p>

<ul>

<li><p>In the .xs file, there&#39;s now a #include declaration with the full path to the mylib.h header file.</p>

</li>
<li><p>There&#39;s now some new C code that&#39;s been added to the .xs file. The purpose of the <code>constant</code> routine is to make the values that are #define&#39;d in the header file available to the Perl script (in this case, by calling <code>&amp;main::TESTVAL</code>). There&#39;s also some XS code to allow calls to the <code>constant</code> routine.</p>

</li>
<li><p>The .pm file has exported the name TESTVAL in the @EXPORT array. This could lead to name clashes. A good rule of thumb is that if the #define is going to be used by only the C routines themselves, and not by the user, they should be removed from the @EXPORT array. Alternately, if you don&#39;t mind using the &quot;fully qualified name&quot; of a variable, you could remove most or all of the items in the @EXPORT array.</p>

</li>
<li><p>If our include file contained #include directives, these would not be processed at all by h2xs. There is no good solution to this right now.</p>

</li>
</ul>

<p>We&#39;ve also told Perl about the library that we built in the mylib subdirectory. That required the addition of only the MYEXTLIB variable to the WriteMakefile call and the replacement of the postamble subroutine to cd into the subdirectory and run make. The Makefile.PL for the library is a bit more complicated, but not excessively so. Again we replaced the postamble subroutine to insert our own code. This code specified simply that the library to be created here was a static archive (as opposed to a dynamically loadable library) and provided the commands to build it.</p>

<h2 id="SPECIFYING-ARGUMENTS-TO-XSUBPP"><a class="permalink" href="#SPECIFYING-ARGUMENTS-TO-XSUBPP">#</a><a id="SPECIFYING"></a>SPECIFYING ARGUMENTS TO XSUBPP</h2>

<p>With the completion of Example 4, we now have an easy way to simulate some real-life libraries whose interfaces may not be the cleanest in the world. We shall now continue with a discussion of the arguments passed to the xsubpp compiler.</p>

<p>When you specify arguments in the .xs file, you are really passing three pieces of information for each one listed. The first piece is the order of that argument relative to the others (first, second, etc). The second is the type of argument, and consists of the type declaration of the argument (e.g., int, char*, etc). The third piece is the exact way in which the argument should be used in the call to the library function from this XSUB. This would mean whether or not to place a &quot;&amp;&quot; before the argument or not, meaning the argument expects to be passed the address of the specified data type.</p>

<p>There is a difference between the two arguments in this hypothetical function:</p>

<pre><code class="plaintext">int
foo(a,b)
	char	&amp;a
	char *	b</code></pre>

<p>The first argument to this function would be treated as a char and assigned to the variable a, and its address would be passed into the function foo. The second argument would be treated as a string pointer and assigned to the variable b. The <i>value</i> of b would be passed into the function foo. The actual call to the function foo that xsubpp generates would look like this:</p>

<pre><code>foo(&amp;a, b);</code></pre>

<p>Xsubpp will identically parse the following function argument lists:</p>

<pre><code class="plaintext">char	&amp;a
char&amp;a
char	&amp; a</code></pre>

<p>However, to help ease understanding, it is suggested that you place a &quot;&amp;&quot; next to the variable name and away from the variable type), and place a &quot;*&quot; near the variable type, but away from the variable name (as in the complete example above). By doing so, it is easy to understand exactly what will be passed to the C function -- it will be whatever is in the &quot;last column&quot;.</p>

<p>You should take great pains to try to pass the function the type of variable it wants, when possible. It will save you a lot of trouble in the long run.</p>

<h2 id="THE-ARGUMENT-STACK"><a class="permalink" href="#THE-ARGUMENT-STACK">#</a><a id="THE2"></a>THE ARGUMENT STACK</h2>

<p>If we look at any of the C code generated by any of the examples except example 1, you will notice a number of references to ST(n), where n is usually 0. The &quot;ST&quot; is actually a macro that points to the n&#39;th argument on the argument stack. ST(0) is thus the first argument passed to the XSUB, ST(1) is the second argument, and so on.</p>

<p>When you list the arguments to the XSUB in the .xs file, that tells xsubpp which argument corresponds to which of the argument stack (i.e., the first one listed is the first argument, and so on). You invite disaster if you do not list them in the same order as the function expects them.</p>

<h2 id="EXTENDING-YOUR-EXTENSION"><a class="permalink" href="#EXTENDING-YOUR-EXTENSION">#</a><a id="EXTENDING"></a>EXTENDING YOUR EXTENSION</h2>

<p>Sometimes you might want to provide some extra methods or subroutines to assist in making the interface between Perl and your extension simpler or easier to understand. These routines should live in the .pm file. Whether they are automatically loaded when the extension itself is loaded or loaded only when called depends on where in the .pm file the subroutine definition is placed.</p>

<h2 id="DOCUMENTING-YOUR-EXTENSION"><a class="permalink" href="#DOCUMENTING-YOUR-EXTENSION">#</a><a id="DOCUMENTING"></a>DOCUMENTING YOUR EXTENSION</h2>

<p>There is absolutely no excuse for not documenting your extension. Documentation belongs in the .pm file. This file will be fed to pod2man, and the embedded documentation will be converted to the manpage format, then placed in the blib directory. It will be copied to Perl&#39;s man page directory when the extension is installed.</p>

<p>You may intersperse documentation and Perl code within the .pm file. In fact, if you want to use method autoloading, you must do this, as the comment inside the .pm file explains.</p>

<p>See <a href="perlpod.html">perlpod</a> for more information about the pod format.</p>

<h2 id="INSTALLING-YOUR-EXTENSION"><a class="permalink" href="#INSTALLING-YOUR-EXTENSION">#</a><a id="INSTALLING"></a>INSTALLING YOUR EXTENSION</h2>

<p>Once your extension is complete and passes all its tests, installing it is quite simple: you simply run &quot;make install&quot;. You will either need to have write permission into the directories where Perl is installed, or ask your system administrator to run the make for you.</p>

<h2 id="SEE-ALSO"><a class="permalink" href="#SEE-ALSO">#</a><a id="SEE"></a>SEE ALSO</h2>

<p>For more information, consult <a href="perlguts.html">perlguts</a>, <a href="perlxs.html">perlxs</a>, <a href="perlmod.html">perlmod</a>, and <a href="perlpod.html">perlpod</a>.</p>

<h2 id="Author"><a class="permalink" href="#Author">#</a>Author</h2>

<p>Jeff Okamoto &lt;<i>okamoto@corp.hp.com</i>&gt;</p>

<p>Reviewed and assisted by Dean Roehrich, Ilya Zakharevich, Andreas Koenig, and Tim Bunce.</p>

<h2 id="Last-Changed"><a class="permalink" href="#Last-Changed">#</a><a id="Last"></a>Last Changed</h2>

<p>1996/7/10</p>


      </div>
      <div id="footer">
        <p>Perldoc Browser is maintained by Dan Book (<a href="https://metacpan.org/author/DBOOK">DBOOK</a>). Please contact him via the <a href="https://github.com/Grinnz/perldoc-browser/issues">GitHub issue tracker</a> or <a href="mailto:dbook@cpan.org">email</a> regarding any issues with the site itself, search, or rendering of documentation.</p>

<p>The Perl documentation is maintained by the Perl 5 Porters in the development of Perl. Please contact them via the <a href="https://github.com/Perl/perl5/issues">Perl issue tracker</a>, the <a href="https://lists.perl.org/list/perl5-porters.html">mailing list</a>, or <a href="https://kiwiirc.com/client/irc.perl.org/p5p">IRC</a> to report any issues with the contents or format of the documentation.</p>


      </div>
    </div>
    <script src="../js/bootstrap.bundle.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.highlightAll();</script>
  </body>

<!-- Mirrored from perldoc.perl.org/5.005_02/perlxstut by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Aug 2025 16:20:47 GMT -->
</html>
