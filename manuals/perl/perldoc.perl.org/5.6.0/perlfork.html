<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from perldoc.perl.org/5.6.0/perlfork by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Aug 2025 16:20:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>perlfork - Perl&#39;s fork() emulation - Perldoc Browser</title>
    <link rel="search" href="../opensearch.xml" type="application/opensearchdescription+xml" title="Perldoc Browser">
    <link rel="canonical" href="../perlfork.html">
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/stackoverflow-light.min.css" rel="stylesheet">
    <link href="../css/perldoc.css" rel="stylesheet">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KVNWBNT5FB"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-KVNWBNT5FB');
      gtag('config', 'UA-50555-3');
    </script>
  </head>
  <body>
    <nav class="navbar navbar-expand-md bg-dark" data-bs-theme="dark"><div class="container-fluid">
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a class="navbar-brand" href="../index.html"><img src="../images/perl_camel_30.png" width="30" height="30" class="d-inline-block align-text-top" alt="Perl Camel Logo"> Perldoc Browser</a>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav me-auto">
      <li class="nav-item dropdown text-nowrap">
        <a class="nav-link dropdown-toggle" href="#" id="dropdownlink-stable" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">5.6.0</a>
        <div class="dropdown-menu" aria-labelledby="dropdownlink-stable">
          <a class="dropdown-item" href="../perlfork.html">Latest</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0/perlfork">5.42.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.3/perlfork">5.40.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.2/perlfork">5.40.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.1/perlfork">5.40.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.0/perlfork">5.40.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.5/perlfork">5.38.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.4/perlfork">5.38.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.3/perlfork">5.38.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.2/perlfork">5.38.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.1/perlfork">5.38.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.0/perlfork">5.38.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.3/perlfork">5.36.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.2/perlfork">5.36.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.1/perlfork">5.36.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.0/perlfork">5.36.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.3/perlfork">5.34.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.2/perlfork">5.34.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.1/perlfork">5.34.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.0/perlfork">5.34.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.32.1/perlfork">5.32.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.32.0/perlfork">5.32.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.3/perlfork">5.30.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.2/perlfork">5.30.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.1/perlfork">5.30.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.0/perlfork">5.30.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.3/perlfork">5.28.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.2/perlfork">5.28.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.1/perlfork">5.28.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.0/perlfork">5.28.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.3/perlfork">5.26.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.2/perlfork">5.26.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.1/perlfork">5.26.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.0/perlfork">5.26.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.4/perlfork">5.24.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.3/perlfork">5.24.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.2/perlfork">5.24.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.1/perlfork">5.24.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.0/perlfork">5.24.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.4/perlfork">5.22.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.3/perlfork">5.22.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.2/perlfork">5.22.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.1/perlfork">5.22.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.0/perlfork">5.22.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.3/perlfork">5.20.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.2/perlfork">5.20.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.1/perlfork">5.20.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.0/perlfork">5.20.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.4/perlfork">5.18.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.3/perlfork">5.18.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.2/perlfork">5.18.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.1/perlfork">5.18.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.0/perlfork">5.18.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.16.3/perlfork">5.16.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.16.2/perlfork">5.16.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.16.1/perlfork">5.16.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.16.0/perlfork">5.16.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.14.4/perlfork">5.14.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.14.3/perlfork">5.14.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.14.2/perlfork">5.14.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.14.1/perlfork">5.14.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.14.0/perlfork">5.14.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.5/perlfork">5.12.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.4/perlfork">5.12.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.3/perlfork">5.12.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.2/perlfork">5.12.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.1/perlfork">5.12.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.0/perlfork">5.12.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.10.1/perlfork">5.10.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.10.0/perlfork">5.10.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.9/perlfork">5.8.9</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.8/perlfork">5.8.8</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.7/perlfork">5.8.7</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.6/perlfork">5.8.6</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.5/perlfork">5.8.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.4/perlfork">5.8.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.3/perlfork">5.8.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.2/perlfork">5.8.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.1/perlfork">5.8.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.0/perlfork">5.8.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="../5.6.2/perlfork.html">5.6.2</a>
          <a class="dropdown-item" href="../5.6.1/perlfork.html">5.6.1</a>
          <a class="dropdown-item active" href="perlfork.html">5.6.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_04/perlfork">5.005_04</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_03/perlfork">5.005_03</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_02/perlfork">5.005_02</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_01/perlfork">5.005_01</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005/perlfork">5.005</a>
        </div>
      </li>
      <li class="nav-item dropdown text-nowrap">
        <a class="nav-link dropdown-toggle" href="#" id="dropdownlink-dev" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dev</a>
        <div class="dropdown-menu" aria-labelledby="dropdownlink-dev">
          <a class="dropdown-item" href="https://perldoc.perl.org/blead/perlfork">blead</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.43.1/perlfork">5.43.1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0-RC3/perlfork">5.42.0-RC3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0-RC2/perlfork">5.42.0-RC2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0-RC1/perlfork">5.42.0-RC1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.13/perlfork">5.41.13</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.12/perlfork">5.41.12</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.11/perlfork">5.41.11</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.10/perlfork">5.41.10</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.9/perlfork">5.41.9</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.8/perlfork">5.41.8</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.7/perlfork">5.41.7</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.6/perlfork">5.41.6</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.5/perlfork">5.41.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.4/perlfork">5.41.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.3/perlfork">5.41.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.2/perlfork">5.41.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.1/perlfork">5.41.1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.3-RC1/perlfork">5.40.3-RC1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.5-RC1/perlfork">5.38.5-RC1</a>
        </div>
      </li>
      <li class="nav-item dropdown text-nowrap">
        <a class="nav-link dropdown-toggle" href="#" id="dropdownlink-nav" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Documentation</a>
        <div class="dropdown-menu" aria-labelledby="dropdownlink-nav">
          <a class="dropdown-item" href="perl.html">Perl</a>
          <a class="dropdown-item" href="perlintro.html">Intro</a>
          <a class="dropdown-item" href="perl.html#Tutorials">Tutorials</a>
          <a class="dropdown-item" href="perlfaq.html">FAQs</a>
          <a class="dropdown-item" href="perl.html#Reference-Manual">Reference</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="perlop.html">Operators</a>
          <a class="dropdown-item" href="functions.html">Functions</a>
          <a class="dropdown-item" href="variables.html">Variables</a>
          <a class="dropdown-item" href="modules.html">Modules</a>
          <a class="dropdown-item" href="perlutil.html">Utilities</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="perldelta.html">Release Notes</a>
          <a class="dropdown-item" href="perlcommunity.html">Community</a>
          <a class="dropdown-item" href="perlhist.html">History</a>
        </div>
      </li>
    </ul>
    <ul class="navbar-nav">
      <button id="content-expand-button" type="button" class="btn btn-dark d-none d-lg-inline-block me-4">Expand</button>
      <script src="../js/perldoc-expand-page.js"></script>
    </ul>
    <form class="form-inline" method="get" action="https://perldoc.perl.org/5.6.0/search">
      <input id="search-input" class="form-control me-3" type="search" name="q" placeholder="[S]earch" aria-label="Search" value="">
    </form>
    <script src="../js/perldoc-focus-search.js"></script>
  </div>
</div></nav>

    <div id="wrapperlicious" class="container-fluid">
      <div id="perldocdiv">
        <div id="links">
          <a href="perlfork.html">perlfork</a>
          <div id="more">
            (<a href="https://perldoc.perl.org/5.6.0/perlfork.txt">source</a>,
            <a href="https://metacpan.org/pod/perlfork">CPAN</a>)
          </div>
        </div>
        <div class="leading-notice">
          You are viewing the version of this documentation from Perl 5.6.0.
            <a href="../perlfork.html">View the latest version</a>
        </div>
        <h1><a id="toc">CONTENTS</a></h1>
                  <ul>
              <li>
                <a class="text-decoration-none" href="#NAME">NAME</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#SYNOPSIS">SYNOPSIS</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#DESCRIPTION">DESCRIPTION</a>
                            <ul>
              <li>
                <a class="text-decoration-none" href="#Behavior-of-other-Perl-features-in-forked-pseudo-processes">Behavior of other Perl features in forked pseudo-processes</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#Resource-limits">Resource limits</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#Killing-the-parent-process">Killing the parent process</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#Lifetime-of-the-parent-process-and-pseudo-processes">Lifetime of the parent process and pseudo-processes</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#CAVEATS-AND-LIMITATIONS">CAVEATS AND LIMITATIONS</a>
              </li>
          </ul>

              </li>
              <li>
                <a class="text-decoration-none" href="#BUGS">BUGS</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#AUTHOR">AUTHOR</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#SEE-ALSO">SEE ALSO</a>
              </li>
          </ul>

      <h1 id="NAME"><a class="permalink" href="#NAME">#</a>NAME</h1>

<p>perlfork - Perl&#39;s fork() emulation</p>

<h1 id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">#</a>SYNOPSIS</h1>

<p>Perl provides a fork() keyword that corresponds to the Unix system call of the same name. On most Unix-like platforms where the fork() system call is available, Perl&#39;s fork() simply calls it.</p>

<p>On some platforms such as Windows where the fork() system call is not available, Perl can be built to emulate fork() at the interpreter level. While the emulation is designed to be as compatible as possible with the real fork() at the the level of the Perl program, there are certain important differences that stem from the fact that all the pseudo child &quot;processes&quot; created this way live in the same real process as far as the operating system is concerned.</p>

<p>This document provides a general overview of the capabilities and limitations of the fork() emulation. Note that the issues discussed here are not applicable to platforms where a real fork() is available and Perl has been configured to use it.</p>

<h1 id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">#</a>DESCRIPTION</h1>

<p>The fork() emulation is implemented at the level of the Perl interpreter. What this means in general is that running fork() will actually clone the running interpreter and all its state, and run the cloned interpreter in a separate thread, beginning execution in the new thread just after the point where the fork() was called in the parent. We will refer to the thread that implements this child &quot;process&quot; as the pseudo-process.</p>

<p>To the Perl program that called fork(), all this is designed to be transparent. The parent returns from the fork() with a pseudo-process ID that can be subsequently used in any process manipulation functions; the child returns from the fork() with a value of <code>0</code> to signify that it is the child pseudo-process.</p>

<h2 id="Behavior-of-other-Perl-features-in-forked-pseudo-processes"><a class="permalink" href="#Behavior-of-other-Perl-features-in-forked-pseudo-processes">#</a><a id="Behavior"></a>Behavior of other Perl features in forked pseudo-processes</h2>

<p>Most Perl features behave in a natural way within pseudo-processes.</p>

<dl>

<dt id="$$-or-$PROCESS_ID"><a class="permalink" href="#$$-or-$PROCESS_ID">#</a><a id="or-PROCESS_ID"></a>$$ or $PROCESS_ID</dt>
<dd>

<p>This special variable is correctly set to the pseudo-process ID. It can be used to identify pseudo-processes within a particular session. Note that this value is subject to recycling if any pseudo-processes are launched after others have been wait()-ed on.</p>

</dd>
<dt id="%ENV"><a class="permalink" href="#%25ENV">#</a><a id="ENV"></a>%ENV</dt>
<dd>

<p>Each pseudo-process maintains its own virtual enviroment. Modifications to %ENV affect the virtual environment, and are only visible within that pseudo-process, and in any processes (or pseudo-processes) launched from it.</p>

</dd>
<dt id="chdir()-and-all-other-builtins-that-accept-filenames"><a class="permalink" href="#chdir()-and-all-other-builtins-that-accept-filenames">#</a><a id="chdir"></a><a id="chdir-and-all-other-builtins-that-accept-filenames"></a>chdir() and all other builtins that accept filenames</dt>
<dd>

<p>Each pseudo-process maintains its own virtual idea of the current directory. Modifications to the current directory using chdir() are only visible within that pseudo-process, and in any processes (or pseudo-processes) launched from it. All file and directory accesses from the pseudo-process will correctly map the virtual working directory to the real working directory appropriately.</p>

</dd>
<dt id="wait()-and-waitpid()"><a class="permalink" href="#wait()-and-waitpid()">#</a><a id="wait"></a><a id="wait-and-waitpid"></a>wait() and waitpid()</dt>
<dd>

<p>wait() and waitpid() can be passed a pseudo-process ID returned by fork(). These calls will properly wait for the termination of the pseudo-process and return its status.</p>

</dd>
<dt id="kill()"><a class="permalink" href="#kill()">#</a><a id="kill"></a>kill()</dt>
<dd>

<p>kill() can be used to terminate a pseudo-process by passing it the ID returned by fork(). This should not be used except under dire circumstances, because the operating system may not guarantee integrity of the process resources when a running thread is terminated. Note that using kill() on a pseudo-process() may typically cause memory leaks, because the thread that implements the pseudo-process does not get a chance to clean up its resources.</p>

</dd>
<dt id="exec()"><a class="permalink" href="#exec()">#</a><a id="exec"></a>exec()</dt>
<dd>

<p>Calling exec() within a pseudo-process actually spawns the requested executable in a separate process and waits for it to complete before exiting with the same exit status as that process. This means that the process ID reported within the running executable will be different from what the earlier Perl fork() might have returned. Similarly, any process manipulation functions applied to the ID returned by fork() will affect the waiting pseudo-process that called exec(), not the real process it is waiting for after the exec().</p>

</dd>
<dt id="exit()"><a class="permalink" href="#exit()">#</a><a id="exit"></a>exit()</dt>
<dd>

<p>exit() always exits just the executing pseudo-process, after automatically wait()-ing for any outstanding child pseudo-processes. Note that this means that the process as a whole will not exit unless all running pseudo-processes have exited.</p>

</dd>
<dt id="Open-handles-to-files,-directories-and-network-sockets"><a class="permalink" href="#Open-handles-to-files,-directories-and-network-sockets">#</a><a id="Open"></a><a id="Open-handles-to-files-directories-and-network-sockets"></a>Open handles to files, directories and network sockets</dt>
<dd>

<p>All open handles are dup()-ed in pseudo-processes, so that closing any handles in one process does not affect the others. See below for some limitations.</p>

</dd>
</dl>

<h2 id="Resource-limits"><a class="permalink" href="#Resource-limits">#</a><a id="Resource"></a>Resource limits</h2>

<p>In the eyes of the operating system, pseudo-processes created via the fork() emulation are simply threads in the same process. This means that any process-level limits imposed by the operating system apply to all pseudo-processes taken together. This includes any limits imposed by the operating system on the number of open file, directory and socket handles, limits on disk space usage, limits on memory size, limits on CPU utilization etc.</p>

<h2 id="Killing-the-parent-process"><a class="permalink" href="#Killing-the-parent-process">#</a><a id="Killing"></a>Killing the parent process</h2>

<p>If the parent process is killed (either using Perl&#39;s kill() builtin, or using some external means) all the pseudo-processes are killed as well, and the whole process exits.</p>

<h2 id="Lifetime-of-the-parent-process-and-pseudo-processes"><a class="permalink" href="#Lifetime-of-the-parent-process-and-pseudo-processes">#</a><a id="Lifetime"></a>Lifetime of the parent process and pseudo-processes</h2>

<p>During the normal course of events, the parent process and every pseudo-process started by it will wait for their respective pseudo-children to complete before they exit. This means that the parent and every pseudo-child created by it that is also a pseudo-parent will only exit after their pseudo-children have exited.</p>

<p>A way to mark a pseudo-processes as running detached from their parent (so that the parent would not have to wait() for them if it doesn&#39;t want to) will be provided in future.</p>

<h2 id="CAVEATS-AND-LIMITATIONS"><a class="permalink" href="#CAVEATS-AND-LIMITATIONS">#</a><a id="CAVEATS"></a>CAVEATS AND LIMITATIONS</h2>

<dl>

<dt id="BEGIN-blocks"><a class="permalink" href="#BEGIN-blocks">#</a><a id="BEGIN"></a>BEGIN blocks</dt>
<dd>

<p>The fork() emulation will not work entirely correctly when called from within a BEGIN block. The forked copy will run the contents of the BEGIN block, but will not continue parsing the source stream after the BEGIN block. For example, consider the following code:</p>

<pre><code>    BEGIN {
        fork and exit;		# fork child and exit the parent
	print &quot;inner\n&quot;;
    }
    print &quot;outer\n&quot;;</code></pre>

<p>This will print:</p>

<pre><code class="plaintext">inner</code></pre>

<p>rather than the expected:</p>

<pre><code class="plaintext">inner
outer</code></pre>

<p>This limitation arises from fundamental technical difficulties in cloning and restarting the stacks used by the Perl parser in the middle of a parse.</p>

</dd>
<dt id="Open-filehandles"><a class="permalink" href="#Open-filehandles">#</a><a id="Open1"></a>Open filehandles</dt>
<dd>

<p>Any filehandles open at the time of the fork() will be dup()-ed. Thus, the files can be closed independently in the parent and child, but beware that the dup()-ed handles will still share the same seek pointer. Changing the seek position in the parent will change it in the child and vice-versa. One can avoid this by opening files that need distinct seek pointers separately in the child.</p>

</dd>
<dt id="Forking-pipe-open()-not-yet-implemented"><a class="permalink" href="#Forking-pipe-open()-not-yet-implemented">#</a><a id="Forking"></a><a id="Forking-pipe-open-not-yet-implemented"></a>Forking pipe open() not yet implemented</dt>
<dd>

<p>The <code>open(FOO, &quot;|-&quot;)</code> and <code>open(BAR, &quot;-|&quot;)</code> constructs are not yet implemented. This limitation can be easily worked around in new code by creating a pipe explicitly. The following example shows how to write to a forked child:</p>

<pre><code>    # simulate open(FOO, &quot;|-&quot;)
    sub pipe_to_fork ($) {
	my $parent = shift;
	pipe my $child, $parent or die;
	my $pid = fork();
	die &quot;fork() failed: $!&quot; unless defined $pid;
	if ($pid) {
	    close $child;
	}
	else {
	    close $parent;
	    open(STDIN, &quot;&lt;&amp;=&quot; . fileno($child)) or die;
	}
	$pid;
    }

    if (pipe_to_fork(&#39;FOO&#39;)) {
	# parent
	print FOO &quot;pipe_to_fork\n&quot;;
	close FOO;
    }
    else {
	# child
	while (&lt;STDIN&gt;) { print; }
	close STDIN;
	exit(0);
    }</code></pre>

<p>And this one reads from the child:</p>

<pre><code>    # simulate open(FOO, &quot;-|&quot;)
    sub pipe_from_fork ($) {
	my $parent = shift;
	pipe $parent, my $child or die;
	my $pid = fork();
	die &quot;fork() failed: $!&quot; unless defined $pid;
	if ($pid) {
	    close $child;
	}
	else {
	    close $parent;
	    open(STDOUT, &quot;&gt;&amp;=&quot; . fileno($child)) or die;
	}
	$pid;
    }

    if (pipe_from_fork(&#39;BAR&#39;)) {
	# parent
	while (&lt;BAR&gt;) { print; }
	close BAR;
    }
    else {
	# child
	print &quot;pipe_from_fork\n&quot;;
	close STDOUT;
	exit(0);
    }</code></pre>

<p>Forking pipe open() constructs will be supported in future.</p>

</dd>
<dt id="Global-state-maintained-by-XSUBs"><a class="permalink" href="#Global-state-maintained-by-XSUBs">#</a><a id="Global"></a>Global state maintained by XSUBs</dt>
<dd>

<p>External subroutines (XSUBs) that maintain their own global state may not work correctly. Such XSUBs will either need to maintain locks to protect simultaneous access to global data from different pseudo-processes, or maintain all their state on the Perl symbol table, which is copied naturally when fork() is called. A callback mechanism that provides extensions an opportunity to clone their state will be provided in the near future.</p>

</dd>
<dt id="Interpreter-embedded-in-larger-application"><a class="permalink" href="#Interpreter-embedded-in-larger-application">#</a><a id="Interpreter"></a>Interpreter embedded in larger application</dt>
<dd>

<p>The fork() emulation may not behave as expected when it is executed in an application which embeds a Perl interpreter and calls Perl APIs that can evaluate bits of Perl code. This stems from the fact that the emulation only has knowledge about the Perl interpreter&#39;s own data structures and knows nothing about the containing application&#39;s state. For example, any state carried on the application&#39;s own call stack is out of reach.</p>

</dd>
<dt id="Thread-safety-of-extensions"><a class="permalink" href="#Thread-safety-of-extensions">#</a><a id="Thread"></a>Thread-safety of extensions</dt>
<dd>

<p>Since the fork() emulation runs code in multiple threads, extensions calling into non-thread-safe libraries may not work reliably when calling fork(). As Perl&#39;s threading support gradually becomes more widely adopted even on platforms with a native fork(), such extensions are expected to be fixed for thread-safety.</p>

</dd>
</dl>

<h1 id="BUGS"><a class="permalink" href="#BUGS">#</a>BUGS</h1>

<ul>

<li><p>Having pseudo-process IDs be negative integers breaks down for the integer <code>-1</code> because the wait() and waitpid() functions treat this number as being special. The tacit assumption in the current implementation is that the system never allocates a thread ID of <code>1</code> for user threads. A better representation for pseudo-process IDs will be implemented in future.</p>

</li>
<li><p>This document may be incomplete in some respects.</p>

</li>
</ul>

<h1 id="AUTHOR"><a class="permalink" href="#AUTHOR">#</a>AUTHOR</h1>

<p>Support for concurrent interpreters and the fork() emulation was implemented by ActiveState, with funding from Microsoft Corporation.</p>

<p>This document is authored and maintained by Gurusamy Sarathy &lt;gsar@activestate.com&gt;.</p>

<h1 id="SEE-ALSO"><a class="permalink" href="#SEE-ALSO">#</a><a id="SEE"></a>SEE ALSO</h1>

<p><a href="perlfunc.html#fork">&quot;fork&quot; in perlfunc</a>, <a href="perlipc.html">perlipc</a></p>


      </div>
      <div id="footer">
        <p>Perldoc Browser is maintained by Dan Book (<a href="https://metacpan.org/author/DBOOK">DBOOK</a>). Please contact him via the <a href="https://github.com/Grinnz/perldoc-browser/issues">GitHub issue tracker</a> or <a href="mailto:dbook@cpan.org">email</a> regarding any issues with the site itself, search, or rendering of documentation.</p>

<p>The Perl documentation is maintained by the Perl 5 Porters in the development of Perl. Please contact them via the <a href="https://github.com/Perl/perl5/issues">Perl issue tracker</a>, the <a href="https://lists.perl.org/list/perl5-porters.html">mailing list</a>, or <a href="https://kiwiirc.com/client/irc.perl.org/p5p">IRC</a> to report any issues with the contents or format of the documentation.</p>


      </div>
    </div>
    <script src="../js/bootstrap.bundle.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.highlightAll();</script>
  </body>

<!-- Mirrored from perldoc.perl.org/5.6.0/perlfork by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Aug 2025 16:20:46 GMT -->
</html>
