<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from perldoc.perl.org/Test2::Compare by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Aug 2025 16:20:53 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Test2::Compare - Test2 extension for writing deep comparison tools. - Perldoc Browser</title>
    <link rel="search" href="opensearch.xml" type="application/opensearchdescription+xml" title="Perldoc Browser">
    <link rel="canonical" href="Test2__Compare.html">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/stackoverflow-light.min.css" rel="stylesheet">
    <link href="css/perldoc.css" rel="stylesheet">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KVNWBNT5FB"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-KVNWBNT5FB');
      gtag('config', 'UA-50555-3');
    </script>
  </head>
  <body>
    <nav class="navbar navbar-expand-md bg-dark" data-bs-theme="dark"><div class="container-fluid">
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a class="navbar-brand" href="index.html"><img src="images/perl_camel_30.png" width="30" height="30" class="d-inline-block align-text-top" alt="Perl Camel Logo"> Perldoc Browser</a>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav me-auto">
      <li class="nav-item dropdown text-nowrap">
        <a class="nav-link dropdown-toggle" href="#" id="dropdownlink-stable" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">5.42.0</a>
        <div class="dropdown-menu" aria-labelledby="dropdownlink-stable">
          <a class="dropdown-item" href="Test2__Compare.html">Latest</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item active" href="https://perldoc.perl.org/5.42.0/Test2::Compare">5.42.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.3/Test2::Compare">5.40.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.2/Test2::Compare">5.40.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.1/Test2::Compare">5.40.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.0/Test2::Compare">5.40.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.5/Test2::Compare">5.38.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.4/Test2::Compare">5.38.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.3/Test2::Compare">5.38.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.2/Test2::Compare">5.38.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.1/Test2::Compare">5.38.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.0/Test2::Compare">5.38.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.3/Test2::Compare">5.36.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.2/Test2::Compare">5.36.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.1/Test2::Compare">5.36.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.0/Test2::Compare">5.36.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.3/Test2::Compare">5.34.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.2/Test2::Compare">5.34.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.1/Test2::Compare">5.34.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.0/Test2::Compare">5.34.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.32.1/Test2::Compare">5.32.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.32.0/Test2::Compare">5.32.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.3/Test2::Compare">5.30.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.2/Test2::Compare">5.30.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.1/Test2::Compare">5.30.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.0/Test2::Compare">5.30.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.3/Test2::Compare">5.28.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.2/Test2::Compare">5.28.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.1/Test2::Compare">5.28.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.0/Test2::Compare">5.28.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.3/Test2::Compare">5.26.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.2/Test2::Compare">5.26.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.1/Test2::Compare">5.26.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.0/Test2::Compare">5.26.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.4/Test2::Compare">5.24.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.3/Test2::Compare">5.24.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.2/Test2::Compare">5.24.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.1/Test2::Compare">5.24.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.0/Test2::Compare">5.24.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.4/Test2::Compare">5.22.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.3/Test2::Compare">5.22.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.2/Test2::Compare">5.22.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.1/Test2::Compare">5.22.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.0/Test2::Compare">5.22.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.3/Test2::Compare">5.20.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.2/Test2::Compare">5.20.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.1/Test2::Compare">5.20.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.0/Test2::Compare">5.20.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.4/Test2::Compare">5.18.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.3/Test2::Compare">5.18.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.2/Test2::Compare">5.18.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.1/Test2::Compare">5.18.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.0/Test2::Compare">5.18.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.16.3/Test2::Compare">5.16.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.16.2/Test2::Compare">5.16.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.16.1/Test2::Compare">5.16.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.16.0/Test2::Compare">5.16.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.14.4/Test2::Compare">5.14.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.14.3/Test2::Compare">5.14.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.14.2/Test2::Compare">5.14.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.14.1/Test2::Compare">5.14.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.14.0/Test2::Compare">5.14.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.5/Test2::Compare">5.12.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.4/Test2::Compare">5.12.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.3/Test2::Compare">5.12.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.2/Test2::Compare">5.12.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.1/Test2::Compare">5.12.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.0/Test2::Compare">5.12.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.10.1/Test2::Compare">5.10.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.10.0/Test2::Compare">5.10.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.9/Test2::Compare">5.8.9</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.8/Test2::Compare">5.8.8</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.7/Test2::Compare">5.8.7</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.6/Test2::Compare">5.8.6</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.5/Test2::Compare">5.8.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.4/Test2::Compare">5.8.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.3/Test2::Compare">5.8.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.2/Test2::Compare">5.8.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.1/Test2::Compare">5.8.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.0/Test2::Compare">5.8.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.6.2/Test2::Compare">5.6.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.6.1/Test2::Compare">5.6.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.6.0/Test2::Compare">5.6.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_04/Test2::Compare">5.005_04</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_03/Test2::Compare">5.005_03</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_02/Test2::Compare">5.005_02</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_01/Test2::Compare">5.005_01</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005/Test2::Compare">5.005</a>
        </div>
      </li>
      <li class="nav-item dropdown text-nowrap">
        <a class="nav-link dropdown-toggle" href="#" id="dropdownlink-dev" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dev</a>
        <div class="dropdown-menu" aria-labelledby="dropdownlink-dev">
          <a class="dropdown-item" href="https://perldoc.perl.org/blead/Test2::Compare">blead</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.43.1/Test2::Compare">5.43.1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0-RC3/Test2::Compare">5.42.0-RC3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0-RC2/Test2::Compare">5.42.0-RC2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0-RC1/Test2::Compare">5.42.0-RC1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.13/Test2::Compare">5.41.13</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.12/Test2::Compare">5.41.12</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.11/Test2::Compare">5.41.11</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.10/Test2::Compare">5.41.10</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.9/Test2::Compare">5.41.9</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.8/Test2::Compare">5.41.8</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.7/Test2::Compare">5.41.7</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.6/Test2::Compare">5.41.6</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.5/Test2::Compare">5.41.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.4/Test2::Compare">5.41.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.3/Test2::Compare">5.41.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.2/Test2::Compare">5.41.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.1/Test2::Compare">5.41.1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.3-RC1/Test2::Compare">5.40.3-RC1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.5-RC1/Test2::Compare">5.38.5-RC1</a>
        </div>
      </li>
      <li class="nav-item dropdown text-nowrap">
        <a class="nav-link dropdown-toggle" href="#" id="dropdownlink-nav" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Documentation</a>
        <div class="dropdown-menu" aria-labelledby="dropdownlink-nav">
          <a class="dropdown-item" href="perl.html">Perl</a>
          <a class="dropdown-item" href="perlintro.html">Intro</a>
          <a class="dropdown-item" href="perl.html#Tutorials">Tutorials</a>
          <a class="dropdown-item" href="perlfaq.html">FAQs</a>
          <a class="dropdown-item" href="perl.html#Reference-Manual">Reference</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="perlop.html">Operators</a>
          <a class="dropdown-item" href="functions.html">Functions</a>
          <a class="dropdown-item" href="variables.html">Variables</a>
          <a class="dropdown-item" href="modules.html">Modules</a>
          <a class="dropdown-item" href="perlutil.html">Utilities</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="perldelta.html">Release Notes</a>
          <a class="dropdown-item" href="perlcommunity.html">Community</a>
          <a class="dropdown-item" href="perlhist.html">History</a>
        </div>
      </li>
    </ul>
    <ul class="navbar-nav">
      <button id="content-expand-button" type="button" class="btn btn-dark d-none d-lg-inline-block me-4">Expand</button>
      <script src="js/perldoc-expand-page.js"></script>
    </ul>
    <form class="form-inline" method="get" action="https://perldoc.perl.org/search">
      <input id="search-input" class="form-control me-3" type="search" name="q" placeholder="[S]earch" aria-label="Search" value="">
    </form>
    <script src="js/perldoc-focus-search.js"></script>
  </div>
</div></nav>

    <div id="wrapperlicious" class="container-fluid">
      <div id="perldocdiv">
        <div id="links">
          <a href="Test2__Compare.html">Test2::Compare</a>
          <div id="more">
            (<a href="https://perldoc.perl.org/Test2::Compare.txt">source</a>,
            <a href="https://metacpan.org/pod/Test2::Compare">CPAN</a>)
          </div>
            <div id="moduleversion">version 1.302210</div>
        </div>
        <h1><a id="toc">CONTENTS</a></h1>
                  <ul>
              <li>
                <a class="text-decoration-none" href="#NAME">NAME</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#DESCRIPTION">DESCRIPTION</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#SYNOPSIS">SYNOPSIS</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#EXPORTS">EXPORTS</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#WRITING-A-VARIANT-OF-IS/LIKE">WRITING A VARIANT OF IS/LIKE</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#SOURCE">SOURCE</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#MAINTAINERS">MAINTAINERS</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#AUTHORS">AUTHORS</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#COPYRIGHT">COPYRIGHT</a>
              </li>
          </ul>

      <h1 id="NAME"><a class="permalink" href="#NAME">#</a>NAME</h1>

<p>Test2::Compare - Test2 extension for writing deep comparison tools.</p>

<h1 id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">#</a>DESCRIPTION</h1>

<p>This library is the driving force behind deep comparison tools such as <code>Test2::Tools::Compare::is()</code> and <code>Test2::Tools::ClassicCompare::is_deeply()</code>.</p>

<h1 id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">#</a>SYNOPSIS</h1>

<pre><code>package Test2::Tools::MyCheck;

use Test2::Compare::MyCheck;
use Test2::Compare qw/compare/;

sub MyCheck {
    my ($got, $exp, $name, @diag) = @_;
    my $ctx = context();

    my $delta = compare($got, $exp, \&amp;convert);

    if ($delta) {
        $ctx-&gt;fail($name, $delta-&gt;diag, @diag);
    }
    else {
        $ctx-&gt;ok(1, $name);
    }

    $ctx-&gt;release;
    return !$delta;
}

sub convert {
    my $thing = shift;
    return $thing if blessed($thing) &amp;&amp; $thing-&gt;isa(&#39;Test2::Compare::MyCheck&#39;);

    return Test2::Compare::MyCheck-&gt;new(stuff =&gt; $thing);
}</code></pre>

<p>See <a href="Test2__Compare__Base.html">Test2::Compare::Base</a> for details about writing a custom check.</p>

<h1 id="EXPORTS"><a class="permalink" href="#EXPORTS">#</a>EXPORTS</h1>

<dl>

<dt id="$delta-=-compare($got,-$expect,-\&amp;convert)"><a class="permalink" href="#$delta-=-compare($got,-$expect,-%5C&amp;convert)">#</a><a id="delta-compare-got-expect-convert"></a>$delta = compare($got, $expect, \&amp;convert)</dt>
<dd>

<p>This will compare the structures in <code>$got</code> with those in <code>$expect</code>, The convert sub should convert vanilla structures inside <code>$expect</code> into checks. If there are differences in the structures they will be reported back as an <a href="Test2__Compare__Delta.html">Test2::Compare::Delta</a> tree.</p>

</dd>
<dt id="$build-=-get_build()"><a class="permalink" href="#$build-=-get_build()">#</a><a id="build-get_build"></a>$build = get_build()</dt>
<dd>

<p>Get the current global build, if any.</p>

</dd>
<dt id="push_build($build)"><a class="permalink" href="#push_build($build)">#</a><a id="push_build"></a><a id="push_build-build"></a>push_build($build)</dt>
<dd>

<p>Set the current global build.</p>

</dd>
<dt id="$build-=-pop_build($build)"><a class="permalink" href="#$build-=-pop_build($build)">#</a><a id="build-pop_build-build"></a>$build = pop_build($build)</dt>
<dd>

<p>Unset the current global build. This will throw an exception if the build passed in is different from the current global.</p>

</dd>
<dt id="build($class,-sub-{-...-})"><a class="permalink" href="#build($class,-sub-%7B-...-%7D)">#</a><a id="build"></a><a id="build-class-sub"></a>build($class, sub { ... })</dt>
<dd>

<p>Run the provided codeblock with a new instance of <code>$class</code> as the current build. Returns the new build.</p>

</dd>
<dt id="$check-=-convert($thing)"><a class="permalink" href="#$check-=-convert($thing)">#</a><a id="check-convert-thing"></a>$check = convert($thing)</dt>
<dd>

</dd>
<dt id="$check-=-convert($thing,-$config)"><a class="permalink" href="#$check-=-convert($thing,-$config)">#</a><a id="check-convert-thing-config"></a>$check = convert($thing, $config)</dt>
<dd>

<p>This convert function is used by <code>strict_convert()</code> and <code>relaxed_convert()</code> under the hood. It can also be used as the basis for other convert functions.</p>

<p>If you want to use it with a custom configuration you should wrap it in another sub like so:</p>

<pre><code>sub my_convert {
    my $thing_to_convert = shift;
    return convert(
        $thing_to_convert,
        { ... }
    );
}</code></pre>

<p>Or the short variant:</p>

<pre><code>sub my_convert { convert($_[0], { ... }) }</code></pre>

<p>There are several configuration options, here they are with the default setting listed first:</p>

<dl>

<dt id="implicit_end-=&gt;-1"><a class="permalink" href="#implicit_end-=%3E-1">#</a><a id="implicit_end"></a><a id="implicit_end-1"></a>implicit_end =&gt; 1</dt>
<dd>

<p>This option toggles array/hash boundaries. If this is true then no extra hash keys or array indexes will be allowed. This setting affects generated compare objects as well as any passed in.</p>

</dd>
<dt id="use_regex-=&gt;-1"><a class="permalink" href="#use_regex-=%3E-1">#</a><a id="use_regex"></a><a id="use_regex-1"></a>use_regex =&gt; 1</dt>
<dd>

<p>This option toggles regex matching. When true (default) regexes are converted to checks such that values must match the regex. When false regexes will be compared to see if they are identical regexes.</p>

</dd>
<dt id="use_code-=&gt;-0"><a class="permalink" href="#use_code-=%3E-0">#</a><a id="use_code"></a><a id="use_code-0"></a>use_code =&gt; 0</dt>
<dd>

<p>This option toggles code matching. When false (default) coderefs in structures must be the same coderef as specified. When true coderefs will be run to verify the value being checked.</p>

</dd>
</dl>

</dd>
<dt id="$check-=-strict_convert($thing)"><a class="permalink" href="#$check-=-strict_convert($thing)">#</a><a id="check-strict_convert-thing"></a>$check = strict_convert($thing)</dt>
<dd>

<p>Convert <code>$thing</code> to an <a href="https://metacpan.org/pod/Test2::Compare::*">Test2::Compare::*</a> object. This will behave strictly which means it uses these settings:</p>

<dl>

<dt id="implicit_end-=&gt;-11"><a class="permalink" href="#implicit_end-=%3E-11">#</a><a id="implicit_end1"></a><a id="implicit_end-11"></a>implicit_end =&gt; 1</dt>
<dd>

<p>Array bounds will be checked when this object is used in a comparison. No unexpected hash keys can be present.</p>

</dd>
<dt id="use_code-=&gt;-01"><a class="permalink" href="#use_code-=%3E-01">#</a><a id="use_code1"></a><a id="use_code-01"></a>use_code =&gt; 0</dt>
<dd>

<p>Sub references will be compared as refs (IE are these sub refs the same ref?)</p>

</dd>
<dt id="use_regex-=&gt;-0"><a class="permalink" href="#use_regex-=%3E-0">#</a><a id="use_regex1"></a><a id="use_regex-0"></a>use_regex =&gt; 0</dt>
<dd>

<p>Regexes will be compared directly (IE are the regexes the same?)</p>

</dd>
</dl>

</dd>
<dt id="$compare-=-relaxed_convert($thing)"><a class="permalink" href="#$compare-=-relaxed_convert($thing)">#</a><a id="compare-relaxed_convert-thing"></a>$compare = relaxed_convert($thing)</dt>
<dd>

<p>Convert <code>$thing</code> to an <a href="https://metacpan.org/pod/Test2::Compare::*">Test2::Compare::*</a> object. This will be relaxed which means it uses these settings:</p>

<dl>

<dt id="implicit_end-=&gt;-0"><a class="permalink" href="#implicit_end-=%3E-0">#</a><a id="implicit_end2"></a><a id="implicit_end-0"></a>implicit_end =&gt; 0</dt>
<dd>

<p>Array bounds will not be checked when this object is used in a comparison. Unexpected hash keys can be present.</p>

</dd>
<dt id="use_code-=&gt;-1"><a class="permalink" href="#use_code-=%3E-1">#</a><a id="use_code2"></a><a id="use_code-1"></a>use_code =&gt; 1</dt>
<dd>

<p>Sub references will be run to verify a value.</p>

</dd>
<dt id="use_regex-=&gt;-11"><a class="permalink" href="#use_regex-=%3E-11">#</a><a id="use_regex2"></a><a id="use_regex-11"></a>use_regex =&gt; 1</dt>
<dd>

<p>Values will be checked against any regexes provided.</p>

</dd>
</dl>

</dd>
</dl>

<h1 id="WRITING-A-VARIANT-OF-IS/LIKE"><a class="permalink" href="#WRITING-A-VARIANT-OF-IS/LIKE">#</a><a id="WRITING"></a><a id="WRITING-A-VARIANT-OF-IS-LIKE"></a>WRITING A VARIANT OF IS/LIKE</h1>

<pre><code>use Test2::Compare qw/compare convert/;

sub my_like($$;$@) {
    my ($got, $exp, $name, @diag) = @_;
    my $ctx = context();

    # A custom converter that does the same thing as the one used by like()
    my $convert = sub {
        my $thing = shift;
        return convert(
            $thing,
            {
                implicit_end =&gt; 0,
                use_code     =&gt; 1,
                use_regex    =&gt; 1,
            }
        );
    };

    my $delta = compare($got, $exp, $convert);

    if ($delta) {
        $ctx-&gt;fail($name, $delta-&gt;diag, @diag);
    }
    else {
        $ctx-&gt;ok(1, $name);
    }

    $ctx-&gt;release;
    return !$delta;
}</code></pre>

<p>The work of a comparison tool is done by 3 entities:</p>

<dl>

<dt id="compare()"><a class="permalink" href="#compare()">#</a><a id="compare"></a>compare()</dt>
<dd>

<p>The <code>compare()</code> function takes the structure you got, the specification you want to check against, and a <code>\&amp;convert</code> sub that will convert anything that is not an instance of an <a href="Test2__Compare__Base.html">Test2::Compare::Base</a> subclass into one.</p>

<p>This tool will use the <code>\&amp;convert</code> function on the specification, and then produce an <a href="Test2__Compare__Delta.html">Test2::Compare::Delta</a> structure that outlines all the ways the structure you got deviates from the specification.</p>

</dd>
<dt id="\&amp;convert"><a class="permalink" href="#%5C&amp;convert">#</a><a id="convert"></a>\&amp;convert</dt>
<dd>

<p>Converts anything that is not an instance of an <a href="Test2__Compare__Base.html">Test2::Compare::Base</a> subclass, and turns it into one. The objects this produces are able to check that a structure matches a specification.</p>

</dd>
<dt id="$delta"><a class="permalink" href="#$delta">#</a><a id="delta"></a>$delta</dt>
<dd>

<p>An instance of <a href="Test2__Compare__Delta.html">Test2::Compare::Delta</a> is ultimately returned. This object represents all the ways in with the structure you got deviated from the specification. The delta is a tree and may contain child deltas for nested structures.</p>

<p>The delta is capable of rendering itself as a table, use <code>@lines = $delta-&gt;diag</code> to get the table (lines in <code>@lines</code> will not be terminated with <code>&quot;\n&quot;</code>).</p>

</dd>
</dl>

<p>The <code>convert()</code> function provided by this package contains all the specification behavior of <code>like()</code> and <code>is()</code>. It is intended to be wrapped in a sub that passes in a configuration hash, which allows you to control the behavior.</p>

<p>You are free to write your own <code>$check = compare($thing)</code> function, it just needs to accept a single argument, and produce a single instance of an <a href="Test2__Compare__Base.html">Test2::Compare::Base</a> subclass.</p>

<h1 id="SOURCE"><a class="permalink" href="#SOURCE">#</a>SOURCE</h1>

<p>The source code repository for Test2-Suite can be found at <i>https://github.com/Test-More/test-more/</i>.</p>

<h1 id="MAINTAINERS"><a class="permalink" href="#MAINTAINERS">#</a>MAINTAINERS</h1>

<dl>

<dt id="Chad-Granum-&lt;exodist@cpan.org&gt;"><a class="permalink" href="#Chad-Granum-%3Cexodist@cpan.org%3E">#</a><a id="Chad"></a><a id="Chad-Granum-exodist-cpan.org"></a>Chad Granum &lt;exodist@cpan.org&gt;</dt>
<dd>

</dd>
</dl>

<h1 id="AUTHORS"><a class="permalink" href="#AUTHORS">#</a>AUTHORS</h1>

<dl>

<dt id="Chad-Granum-&lt;exodist@cpan.org&gt;1"><a class="permalink" href="#Chad-Granum-%3Cexodist@cpan.org%3E1">#</a><a id="Chad1"></a><a id="Chad-Granum-exodist-cpan.org1"></a>Chad Granum &lt;exodist@cpan.org&gt;</dt>
<dd>

</dd>
</dl>

<h1 id="COPYRIGHT"><a class="permalink" href="#COPYRIGHT">#</a>COPYRIGHT</h1>

<p>Copyright Chad Granum &lt;exodist@cpan.org&gt;.</p>

<p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>

<p>See <i>http://dev.perl.org/licenses/</i></p>


      </div>
      <div id="footer">
        <p>Perldoc Browser is maintained by Dan Book (<a href="https://metacpan.org/author/DBOOK">DBOOK</a>). Please contact him via the <a href="https://github.com/Grinnz/perldoc-browser/issues">GitHub issue tracker</a> or <a href="mailto:dbook@cpan.org">email</a> regarding any issues with the site itself, search, or rendering of documentation.</p>

<p>The Perl documentation is maintained by the Perl 5 Porters in the development of Perl. Please contact them via the <a href="https://github.com/Perl/perl5/issues">Perl issue tracker</a>, the <a href="https://lists.perl.org/list/perl5-porters.html">mailing list</a>, or <a href="https://kiwiirc.com/client/irc.perl.org/p5p">IRC</a> to report any issues with the contents or format of the documentation.</p>


      </div>
    </div>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/highlight.pack.js"></script>
    <script>hljs.highlightAll();</script>
  </body>

<!-- Mirrored from perldoc.perl.org/Test2::Compare by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Aug 2025 16:20:53 GMT -->
</html>
