<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from perldoc.perl.org/5.12.1/threads by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Aug 2025 16:20:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>threads - Perl interpreter-based threads - Perldoc Browser</title>
    <link rel="search" href="../opensearch.xml" type="application/opensearchdescription+xml" title="Perldoc Browser">
    <link rel="canonical" href="../threads.html">
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/stackoverflow-light.min.css" rel="stylesheet">
    <link href="../css/perldoc.css" rel="stylesheet">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KVNWBNT5FB"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-KVNWBNT5FB');
      gtag('config', 'UA-50555-3');
    </script>
  </head>
  <body>
    <nav class="navbar navbar-expand-md bg-dark" data-bs-theme="dark"><div class="container-fluid">
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a class="navbar-brand" href="../index.html"><img src="../images/perl_camel_30.png" width="30" height="30" class="d-inline-block align-text-top" alt="Perl Camel Logo"> Perldoc Browser</a>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav me-auto">
      <li class="nav-item dropdown text-nowrap">
        <a class="nav-link dropdown-toggle" href="#" id="dropdownlink-stable" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">5.12.1</a>
        <div class="dropdown-menu" aria-labelledby="dropdownlink-stable">
          <a class="dropdown-item" href="../threads.html">Latest</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0/threads">5.42.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.3/threads">5.40.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.2/threads">5.40.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.1/threads">5.40.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.0/threads">5.40.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.5/threads">5.38.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.4/threads">5.38.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.3/threads">5.38.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.2/threads">5.38.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.1/threads">5.38.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.0/threads">5.38.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.3/threads">5.36.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.2/threads">5.36.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.1/threads">5.36.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.0/threads">5.36.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.3/threads">5.34.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.2/threads">5.34.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.1/threads">5.34.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.0/threads">5.34.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.32.1/threads">5.32.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.32.0/threads">5.32.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.3/threads">5.30.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.2/threads">5.30.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.1/threads">5.30.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.0/threads">5.30.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.3/threads">5.28.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.2/threads">5.28.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.1/threads">5.28.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.0/threads">5.28.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.3/threads">5.26.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.2/threads">5.26.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.1/threads">5.26.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.0/threads">5.26.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.4/threads">5.24.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.3/threads">5.24.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.2/threads">5.24.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.1/threads">5.24.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.0/threads">5.24.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.4/threads">5.22.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.3/threads">5.22.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.2/threads">5.22.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.1/threads">5.22.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.0/threads">5.22.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.3/threads">5.20.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.2/threads">5.20.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.1/threads">5.20.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.0/threads">5.20.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.4/threads">5.18.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.3/threads">5.18.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.2/threads">5.18.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.1/threads">5.18.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.0/threads">5.18.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="../5.16.3/threads.html">5.16.3</a>
          <a class="dropdown-item" href="../5.16.2/threads.html">5.16.2</a>
          <a class="dropdown-item" href="../5.16.1/threads.html">5.16.1</a>
          <a class="dropdown-item" href="../5.16.0/threads.html">5.16.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="../5.14.4/threads.html">5.14.4</a>
          <a class="dropdown-item" href="../5.14.3/threads.html">5.14.3</a>
          <a class="dropdown-item" href="../5.14.2/threads.html">5.14.2</a>
          <a class="dropdown-item" href="../5.14.1/threads.html">5.14.1</a>
          <a class="dropdown-item" href="../5.14.0/threads.html">5.14.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="../5.12.5/threads.html">5.12.5</a>
          <a class="dropdown-item" href="../5.12.4/threads.html">5.12.4</a>
          <a class="dropdown-item" href="../5.12.3/threads.html">5.12.3</a>
          <a class="dropdown-item" href="../5.12.2/threads.html">5.12.2</a>
          <a class="dropdown-item active" href="threads.html">5.12.1</a>
          <a class="dropdown-item" href="../5.12.0/threads.html">5.12.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="../5.10.1/threads.html">5.10.1</a>
          <a class="dropdown-item" href="../5.10.0/threads.html">5.10.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="../5.8.9/threads.html">5.8.9</a>
          <a class="dropdown-item" href="../5.8.8/threads.html">5.8.8</a>
          <a class="dropdown-item" href="../5.8.7/threads.html">5.8.7</a>
          <a class="dropdown-item" href="../5.8.6/threads.html">5.8.6</a>
          <a class="dropdown-item" href="../5.8.5/threads.html">5.8.5</a>
          <a class="dropdown-item" href="../5.8.4/threads.html">5.8.4</a>
          <a class="dropdown-item" href="../5.8.3/threads.html">5.8.3</a>
          <a class="dropdown-item" href="../5.8.2/threads.html">5.8.2</a>
          <a class="dropdown-item" href="../5.8.1/threads.html">5.8.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.0/threads">5.8.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.6.2/threads">5.6.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.6.1/threads">5.6.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.6.0/threads">5.6.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_04/threads">5.005_04</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_03/threads">5.005_03</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_02/threads">5.005_02</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_01/threads">5.005_01</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005/threads">5.005</a>
        </div>
      </li>
      <li class="nav-item dropdown text-nowrap">
        <a class="nav-link dropdown-toggle" href="#" id="dropdownlink-dev" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dev</a>
        <div class="dropdown-menu" aria-labelledby="dropdownlink-dev">
          <a class="dropdown-item" href="https://perldoc.perl.org/blead/threads">blead</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.43.1/threads">5.43.1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0-RC3/threads">5.42.0-RC3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0-RC2/threads">5.42.0-RC2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0-RC1/threads">5.42.0-RC1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.13/threads">5.41.13</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.12/threads">5.41.12</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.11/threads">5.41.11</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.10/threads">5.41.10</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.9/threads">5.41.9</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.8/threads">5.41.8</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.7/threads">5.41.7</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.6/threads">5.41.6</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.5/threads">5.41.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.4/threads">5.41.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.3/threads">5.41.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.2/threads">5.41.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.1/threads">5.41.1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.3-RC1/threads">5.40.3-RC1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.5-RC1/threads">5.38.5-RC1</a>
        </div>
      </li>
      <li class="nav-item dropdown text-nowrap">
        <a class="nav-link dropdown-toggle" href="#" id="dropdownlink-nav" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Documentation</a>
        <div class="dropdown-menu" aria-labelledby="dropdownlink-nav">
          <a class="dropdown-item" href="perl.html">Perl</a>
          <a class="dropdown-item" href="perlintro.html">Intro</a>
          <a class="dropdown-item" href="perl.html#Tutorials">Tutorials</a>
          <a class="dropdown-item" href="perlfaq.html">FAQs</a>
          <a class="dropdown-item" href="perl.html#Reference-Manual">Reference</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="perlop.html">Operators</a>
          <a class="dropdown-item" href="functions.html">Functions</a>
          <a class="dropdown-item" href="variables.html">Variables</a>
          <a class="dropdown-item" href="modules.html">Modules</a>
          <a class="dropdown-item" href="perlutil.html">Utilities</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="perldelta.html">Release Notes</a>
          <a class="dropdown-item" href="perlcommunity.html">Community</a>
          <a class="dropdown-item" href="perlhist.html">History</a>
        </div>
      </li>
    </ul>
    <ul class="navbar-nav">
      <button id="content-expand-button" type="button" class="btn btn-dark d-none d-lg-inline-block me-4">Expand</button>
      <script src="../js/perldoc-expand-page.js"></script>
    </ul>
    <form class="form-inline" method="get" action="https://perldoc.perl.org/5.12.1/search">
      <input id="search-input" class="form-control me-3" type="search" name="q" placeholder="[S]earch" aria-label="Search" value="">
    </form>
    <script src="../js/perldoc-focus-search.js"></script>
  </div>
</div></nav>

    <div id="wrapperlicious" class="container-fluid">
      <div id="perldocdiv">
        <div id="links">
          <a href="threads.html">threads</a>
          <div id="more">
            (<a href="https://perldoc.perl.org/5.12.1/threads.txt">source</a>,
            <a href="https://metacpan.org/pod/threads">CPAN</a>)
          </div>
            <div id="moduleversion">version 1.75</div>
        </div>
        <div class="leading-notice">
          You are viewing the version of this documentation from Perl 5.12.1.
            <a href="../threads.html">View the latest version</a>
        </div>
        <h1><a id="toc">CONTENTS</a></h1>
                  <ul>
              <li>
                <a class="text-decoration-none" href="#NAME">NAME</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#VERSION">VERSION</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#SYNOPSIS">SYNOPSIS</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#DESCRIPTION">DESCRIPTION</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#EXITING-A-THREAD">EXITING A THREAD</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#THREAD-STATE">THREAD STATE</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#THREAD-CONTEXT">THREAD CONTEXT</a>
                            <ul>
              <li>
                <a class="text-decoration-none" href="#Explicit-context">Explicit context</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#Implicit-context">Implicit context</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#$thr-%3Ewantarray()">$thr-&gt;wantarray()</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#threads-%3Ewantarray()">threads-&gt;wantarray()</a>
              </li>
          </ul>

              </li>
              <li>
                <a class="text-decoration-none" href="#THREAD-STACK-SIZE">THREAD STACK SIZE</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#THREAD-SIGNALLING">THREAD SIGNALLING</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#WARNINGS">WARNINGS</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#ERRORS">ERRORS</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#BUGS-AND-LIMITATIONS">BUGS AND LIMITATIONS</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#REQUIREMENTS">REQUIREMENTS</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#SEE-ALSO">SEE ALSO</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#AUTHOR">AUTHOR</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#LICENSE">LICENSE</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#ACKNOWLEDGEMENTS">ACKNOWLEDGEMENTS</a>
              </li>
          </ul>

      <h1 id="NAME"><a class="permalink" href="#NAME">#</a>NAME</h1>

<p>threads - Perl interpreter-based threads</p>

<h1 id="VERSION"><a class="permalink" href="#VERSION">#</a>VERSION</h1>

<p>This document describes threads version 1.75</p>

<h1 id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">#</a>SYNOPSIS</h1>

<pre><code>use threads (&#39;yield&#39;,
             &#39;stack_size&#39; =&gt; 64*4096,
             &#39;exit&#39; =&gt; &#39;threads_only&#39;,
             &#39;stringify&#39;);

sub start_thread {
    my @args = @_;
    print(&#39;Thread started: &#39;, join(&#39; &#39;, @args), &quot;\n&quot;);
}
my $thr = threads-&gt;create(&#39;start_thread&#39;, &#39;argument&#39;);
$thr-&gt;join();

threads-&gt;create(sub { print(&quot;I am a thread\n&quot;); })-&gt;join();

my $thr2 = async { foreach (@files) { ... } };
$thr2-&gt;join();
if (my $err = $thr2-&gt;error()) {
    warn(&quot;Thread error: $err\n&quot;);
}

# Invoke thread in list context (implicit) so it can return a list
my ($thr) = threads-&gt;create(sub { return (qw/a b c/); });
# or specify list context explicitly
my $thr = threads-&gt;create({&#39;context&#39; =&gt; &#39;list&#39;},
                          sub { return (qw/a b c/); });
my @results = $thr-&gt;join();

$thr-&gt;detach();

# Get a thread&#39;s object
$thr = threads-&gt;self();
$thr = threads-&gt;object($tid);

# Get a thread&#39;s ID
$tid = threads-&gt;tid();
$tid = $thr-&gt;tid();
$tid = &quot;$thr&quot;;

# Give other threads a chance to run
threads-&gt;yield();
yield();

# Lists of non-detached threads
my @threads = threads-&gt;list();
my $thread_count = threads-&gt;list();

my @running = threads-&gt;list(threads::running);
my @joinable = threads-&gt;list(threads::joinable);

# Test thread objects
if ($thr1 == $thr2) {
    ...
}

# Manage thread stack size
$stack_size = threads-&gt;get_stack_size();
$old_size = threads-&gt;set_stack_size(32*4096);

# Create a thread with a specific context and stack size
my $thr = threads-&gt;create({ &#39;context&#39;    =&gt; &#39;list&#39;,
                            &#39;stack_size&#39; =&gt; 32*4096,
                            &#39;exit&#39;       =&gt; &#39;thread_only&#39; },
                          \&amp;foo);

# Get thread&#39;s context
my $wantarray = $thr-&gt;wantarray();

# Check thread&#39;s state
if ($thr-&gt;is_running()) {
    sleep(1);
}
if ($thr-&gt;is_joinable()) {
    $thr-&gt;join();
}

# Send a signal to a thread
$thr-&gt;kill(&#39;SIGUSR1&#39;);

# Exit a thread
threads-&gt;exit();</code></pre>

<h1 id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">#</a>DESCRIPTION</h1>

<p>Since Perl 5.8, thread programming has been available using a model called <i>interpreter threads</i> which provides a new Perl interpreter for each thread, and, by default, results in no data or state information being shared between threads.</p>

<p>(Prior to Perl 5.8, <i>5005threads</i> was available through the <code>Thread.pm</code> API. This threading model has been deprecated, and was removed as of Perl 5.10.0.)</p>

<p>As just mentioned, all variables are, by default, thread local. To use shared variables, you need to also load <a href="https://perldoc.perl.org/5.12.1/threads::shared">threads::shared</a>:</p>

<pre><code>use threads;
use threads::shared;</code></pre>

<p>When loading <a href="https://perldoc.perl.org/5.12.1/threads::shared">threads::shared</a>, you must <code>use threads</code> before you <code>use threads::shared</code>. (<code>threads</code> will emit a warning if you do it the other way around.)</p>

<p>It is strongly recommended that you enable threads via <code>use threads</code> as early as possible in your script.</p>

<p>If needed, scripts can be written so as to run on both threaded and non-threaded Perls:</p>

<pre><code>my $can_use_threads = eval &#39;use threads; 1&#39;;
if ($can_use_threads) {
    # Do processing using threads
    ...
} else {
    # Do it without using threads
    ...
}</code></pre>

<dl>

<dt id="$thr-=-threads-&gt;create(FUNCTION,-ARGS)"><a class="permalink" href="#$thr-=-threads-%3Ecreate(FUNCTION,-ARGS)">#</a><a id="thr-threads-create-FUNCTION-ARGS"></a>$thr = threads-&gt;create(FUNCTION, ARGS)</dt>
<dd>

<p>This will create a new thread that will begin execution with the specified entry point function, and give it the <i>ARGS</i> list as parameters. It will return the corresponding threads object, or <code>undef</code> if thread creation failed.</p>

<p><i>FUNCTION</i> may either be the name of a function, an anonymous subroutine, or a code ref.</p>

<pre><code>my $thr = threads-&gt;create(&#39;func_name&#39;, ...);
    # or
my $thr = threads-&gt;create(sub { ... }, ...);
    # or
my $thr = threads-&gt;create(\&amp;func, ...);</code></pre>

<p>The <code>-&gt;new()</code> method is an alias for <code>-&gt;create()</code>.</p>

</dd>
<dt id="$thr-&gt;join()"><a class="permalink" href="#$thr-%3Ejoin()">#</a><a id="join"></a><a id="thr-join"></a>$thr-&gt;join()</dt>
<dd>

<p>This will wait for the corresponding thread to complete its execution. When the thread finishes, <code>-&gt;join()</code> will return the return value(s) of the entry point function.</p>

<p>The context (void, scalar or list) for the return value(s) for <code>-&gt;join()</code> is determined at the time of thread creation.</p>

<pre><code># Create thread in list context (implicit)
my ($thr1) = threads-&gt;create(sub {
                                my @results = qw(a b c);
                                return (@results);
                             });
#   or (explicit)
my $thr1 = threads-&gt;create({&#39;context&#39; =&gt; &#39;list&#39;},
                           sub {
                                my @results = qw(a b c);
                                return (@results);
                           });
# Retrieve list results from thread
my @res1 = $thr1-&gt;join();

# Create thread in scalar context (implicit)
my $thr2 = threads-&gt;create(sub {
                                my $result = 42;
                                return ($result);
                             });
# Retrieve scalar result from thread
my $res2 = $thr2-&gt;join();

# Create a thread in void context (explicit)
my $thr3 = threads-&gt;create({&#39;void&#39; =&gt; 1},
                           sub { print(&quot;Hello, world\n&quot;); });
# Join the thread in void context (i.e., no return value)
$thr3-&gt;join();</code></pre>

<p>See <a href="#THREAD-CONTEXT">&quot;THREAD CONTEXT&quot;</a> for more details.</p>

<p>If the program exits without all threads having either been joined or detached, then a warning will be issued.</p>

<p>Calling <code>-&gt;join()</code> or <code>-&gt;detach()</code> on an already joined thread will cause an error to be thrown.</p>

</dd>
<dt id="$thr-&gt;detach()"><a class="permalink" href="#$thr-%3Edetach()">#</a><a id="detach"></a><a id="thr-detach"></a>$thr-&gt;detach()</dt>
<dd>

<p>Makes the thread unjoinable, and causes any eventual return value to be discarded. When the program exits, any detached threads that are still running are silently terminated.</p>

<p>If the program exits without all threads having either been joined or detached, then a warning will be issued.</p>

<p>Calling <code>-&gt;join()</code> or <code>-&gt;detach()</code> on an already detached thread will cause an error to be thrown.</p>

</dd>
<dt id="threads-&gt;detach()"><a class="permalink" href="#threads-%3Edetach()">#</a><a id="threads"></a><a id="threads-detach"></a>threads-&gt;detach()</dt>
<dd>

<p>Class method that allows a thread to detach itself.</p>

</dd>
<dt id="threads-&gt;self()"><a class="permalink" href="#threads-%3Eself()">#</a><a id="threads1"></a><a id="threads-self"></a>threads-&gt;self()</dt>
<dd>

<p>Class method that allows a thread to obtain its own <i>threads</i> object.</p>

</dd>
<dt id="$thr-&gt;tid()"><a class="permalink" href="#$thr-%3Etid()">#</a><a id="tid"></a><a id="thr-tid"></a>$thr-&gt;tid()</dt>
<dd>

<p>Returns the ID of the thread. Thread IDs are unique integers with the main thread in a program being 0, and incrementing by 1 for every thread created.</p>

</dd>
<dt id="threads-&gt;tid()"><a class="permalink" href="#threads-%3Etid()">#</a><a id="threads2"></a><a id="threads-tid"></a>threads-&gt;tid()</dt>
<dd>

<p>Class method that allows a thread to obtain its own ID.</p>

</dd>
<dt id="&quot;$thr&quot;"><a class="permalink" href="#%22$thr%22">#</a><a id="thr"></a>&quot;$thr&quot;</dt>
<dd>

<p>If you add the <code>stringify</code> import option to your <code>use threads</code> declaration, then using a threads object in a string or a string context (e.g., as a hash key) will cause its ID to be used as the value:</p>

<pre><code>use threads qw(stringify);

my $thr = threads-&gt;create(...);
print(&quot;Thread $thr started...\n&quot;);  # Prints out: Thread 1 started...</code></pre>

</dd>
<dt id="threads-&gt;object($tid)"><a class="permalink" href="#threads-%3Eobject($tid)">#</a><a id="threads3"></a><a id="threads-object-tid"></a>threads-&gt;object($tid)</dt>
<dd>

<p>This will return the <i>threads</i> object for the <i>active</i> thread associated with the specified thread ID. Returns <code>undef</code> if there is no thread associated with the TID, if the thread is joined or detached, if no TID is specified or if the specified TID is undef.</p>

</dd>
<dt id="threads-&gt;yield()"><a class="permalink" href="#threads-%3Eyield()">#</a><a id="threads4"></a><a id="threads-yield"></a>threads-&gt;yield()</dt>
<dd>

<p>This is a suggestion to the OS to let this thread yield CPU time to other threads. What actually happens is highly dependent upon the underlying thread implementation.</p>

<p>You may do <code>use threads qw(yield)</code>, and then just use <code>yield()</code> in your code.</p>

</dd>
<dt id="threads-&gt;list()"><a class="permalink" href="#threads-%3Elist()">#</a><a id="threads5"></a><a id="threads-list"></a>threads-&gt;list()</dt>
<dd>

</dd>
<dt id="threads-&gt;list(threads::all)"><a class="permalink" href="#threads-%3Elist(threads::all)">#</a><a id="threads6"></a><a id="threads-list-threads::all"></a>threads-&gt;list(threads::all)</dt>
<dd>

</dd>
<dt id="threads-&gt;list(threads::running)"><a class="permalink" href="#threads-%3Elist(threads::running)">#</a><a id="threads7"></a><a id="threads-list-threads::running"></a>threads-&gt;list(threads::running)</dt>
<dd>

</dd>
<dt id="threads-&gt;list(threads::joinable)"><a class="permalink" href="#threads-%3Elist(threads::joinable)">#</a><a id="threads8"></a><a id="threads-list-threads::joinable"></a>threads-&gt;list(threads::joinable)</dt>
<dd>

<p>With no arguments (or using <code>threads::all</code>) and in a list context, returns a list of all non-joined, non-detached <i>threads</i> objects. In a scalar context, returns a count of the same.</p>

<p>With a <i>true</i> argument (using <code>threads::running</code>), returns a list of all non-joined, non-detached <i>threads</i> objects that are still running.</p>

<p>With a <i>false</i> argument (using <code>threads::joinable</code>), returns a list of all non-joined, non-detached <i>threads</i> objects that have finished running (i.e., for which <code>-&gt;join()</code> will not <i>block</i>).</p>

</dd>
<dt id="$thr1-&gt;equal($thr2)"><a class="permalink" href="#$thr1-%3Eequal($thr2)">#</a><a id="equal"></a><a id="thr1-equal-thr2"></a>$thr1-&gt;equal($thr2)</dt>
<dd>

<p>Tests if two threads objects are the same thread or not. This is overloaded to the more natural forms:</p>

<pre><code>if ($thr1 == $thr2) {
    print(&quot;Threads are the same\n&quot;);
}
# or
if ($thr1 != $thr2) {
    print(&quot;Threads differ\n&quot;);
}</code></pre>

<p>(Thread comparison is based on thread IDs.)</p>

</dd>
<dt id="async-BLOCK;"><a class="permalink" href="#async-BLOCK;">#</a><a id="async"></a><a id="async-BLOCK"></a>async BLOCK;</dt>
<dd>

<p><code>async</code> creates a thread to execute the block immediately following it. This block is treated as an anonymous subroutine, and so must have a semicolon after the closing brace. Like <code>threads-&gt;create()</code>, <code>async</code> returns a <i>threads</i> object.</p>

</dd>
<dt id="$thr-&gt;error()"><a class="permalink" href="#$thr-%3Eerror()">#</a><a id="error"></a><a id="thr-error"></a>$thr-&gt;error()</dt>
<dd>

<p>Threads are executed in an <code>eval</code> context. This method will return <code>undef</code> if the thread terminates <i>normally</i>. Otherwise, it returns the value of <code>$@</code> associated with the thread&#39;s execution status in its <code>eval</code> context.</p>

</dd>
<dt id="$thr-&gt;_handle()"><a class="permalink" href="#$thr-%3E_handle()">#</a><a id="_handle"></a><a id="thr-_handle"></a>$thr-&gt;_handle()</dt>
<dd>

<p>This <i>private</i> method returns the memory location of the internal thread structure associated with a threads object. For Win32, this is a pointer to the <code>HANDLE</code> value returned by <code>CreateThread</code> (i.e., <code>HANDLE *</code>); for other platforms, it is a pointer to the <code>pthread_t</code> structure used in the <code>pthread_create</code> call (i.e., <code>pthread_t *</code>).</p>

<p>This method is of no use for general Perl threads programming. Its intent is to provide other (XS-based) thread modules with the capability to access, and possibly manipulate, the underlying thread structure associated with a Perl thread.</p>

</dd>
<dt id="threads-&gt;_handle()"><a class="permalink" href="#threads-%3E_handle()">#</a><a id="threads9"></a><a id="threads-_handle"></a>threads-&gt;_handle()</dt>
<dd>

<p>Class method that allows a thread to obtain its own <i>handle</i>.</p>

</dd>
</dl>

<h1 id="EXITING-A-THREAD"><a class="permalink" href="#EXITING-A-THREAD">#</a><a id="EXITING"></a>EXITING A THREAD</h1>

<p>The usual method for terminating a thread is to <a href="https://perldoc.perl.org/5.12.1/perlfunc#return-EXPR">return()</a> from the entry point function with the appropriate return value(s).</p>

<dl>

<dt id="threads-&gt;exit()"><a class="permalink" href="#threads-%3Eexit()">#</a><a id="threads10"></a><a id="threads-exit"></a>threads-&gt;exit()</dt>
<dd>

<p>If needed, a thread can be exited at any time by calling <code>threads-&gt;exit()</code>. This will cause the thread to return <code>undef</code> in a scalar context, or the empty list in a list context.</p>

<p>When called from the <i>main</i> thread, this behaves the same as <code>exit(0)</code>.</p>

</dd>
<dt id="threads-&gt;exit(status)"><a class="permalink" href="#threads-%3Eexit(status)">#</a><a id="threads11"></a><a id="threads-exit-status"></a>threads-&gt;exit(status)</dt>
<dd>

<p>When called from a thread, this behaves like <code>threads-&gt;exit()</code> (i.e., the exit status code is ignored).</p>

<p>When called from the <i>main</i> thread, this behaves the same as <code>exit(status)</code>.</p>

</dd>
<dt id="die()"><a class="permalink" href="#die()">#</a><a id="die"></a>die()</dt>
<dd>

<p>Calling <code>die()</code> in a thread indicates an abnormal exit for the thread. Any <code>$SIG{__DIE__}</code> handler in the thread will be called first, and then the thread will exit with a warning message that will contain any arguments passed in the <code>die()</code> call.</p>

</dd>
<dt id="exit(status)"><a class="permalink" href="#exit(status)">#</a><a id="exit"></a><a id="exit-status"></a>exit(status)</dt>
<dd>

<p>Calling <a href="https://perldoc.perl.org/5.12.1/perlfunc#exit-EXPR">exit()</a> inside a thread causes the whole application to terminate. Because of this, the use of <code>exit()</code> inside threaded code, or in modules that might be used in threaded applications, is strongly discouraged.</p>

<p>If <code>exit()</code> really is needed, then consider using the following:</p>

<pre><code>threads-&gt;exit() if threads-&gt;can(&#39;exit&#39;);   # Thread friendly
exit(status);</code></pre>

</dd>
<dt id="use-threads-&#39;exit&#39;-=&gt;-&#39;threads_only&#39;"><a class="permalink" href="#use-threads-&#39;exit&#39;-=%3E-&#39;threads_only&#39;">#</a><a id="use"></a><a id="use-threads-exit-threads_only"></a>use threads &#39;exit&#39; =&gt; &#39;threads_only&#39;</dt>
<dd>

<p>This globally overrides the default behavior of calling <code>exit()</code> inside a thread, and effectively causes such calls to behave the same as <code>threads-&gt;exit()</code>. In other words, with this setting, calling <code>exit()</code> causes only the thread to terminate.</p>

<p>Because of its global effect, this setting should not be used inside modules or the like.</p>

<p>The <i>main</i> thread is unaffected by this setting.</p>

</dd>
<dt id="threads-&gt;create({&#39;exit&#39;-=&gt;-&#39;thread_only&#39;},-...)"><a class="permalink" href="#threads-%3Ecreate(%7B&#39;exit&#39;-=%3E-&#39;thread_only&#39;%7D,-...)">#</a><a id="threads12"></a><a id="threads-create-exit-thread_only"></a>threads-&gt;create({&#39;exit&#39; =&gt; &#39;thread_only&#39;}, ...)</dt>
<dd>

<p>This overrides the default behavior of <code>exit()</code> inside the newly created thread only.</p>

</dd>
<dt id="$thr-&gt;set_thread_exit_only(boolean)"><a class="permalink" href="#$thr-%3Eset_thread_exit_only(boolean)">#</a><a id="set_thread_exit_only"></a><a id="thr-set_thread_exit_only-boolean"></a>$thr-&gt;set_thread_exit_only(boolean)</dt>
<dd>

<p>This can be used to change the <i>exit thread only</i> behavior for a thread after it has been created. With a <i>true</i> argument, <code>exit()</code> will cause only the thread to exit. With a <i>false</i> argument, <code>exit()</code> will terminate the application.</p>

<p>The <i>main</i> thread is unaffected by this call.</p>

</dd>
<dt id="threads-&gt;set_thread_exit_only(boolean)"><a class="permalink" href="#threads-%3Eset_thread_exit_only(boolean)">#</a><a id="threads13"></a><a id="threads-set_thread_exit_only-boolean"></a>threads-&gt;set_thread_exit_only(boolean)</dt>
<dd>

<p>Class method for use inside a thread to change its own behavior for <code>exit()</code>.</p>

<p>The <i>main</i> thread is unaffected by this call.</p>

</dd>
</dl>

<h1 id="THREAD-STATE"><a class="permalink" href="#THREAD-STATE">#</a><a id="THREAD"></a>THREAD STATE</h1>

<p>The following boolean methods are useful in determining the <i>state</i> of a thread.</p>

<dl>

<dt id="$thr-&gt;is_running()"><a class="permalink" href="#$thr-%3Eis_running()">#</a><a id="is_running"></a><a id="thr-is_running"></a>$thr-&gt;is_running()</dt>
<dd>

<p>Returns true if a thread is still running (i.e., if its entry point function has not yet finished or exited).</p>

</dd>
<dt id="$thr-&gt;is_joinable()"><a class="permalink" href="#$thr-%3Eis_joinable()">#</a><a id="is_joinable"></a><a id="thr-is_joinable"></a>$thr-&gt;is_joinable()</dt>
<dd>

<p>Returns true if the thread has finished running, is not detached and has not yet been joined. In other words, the thread is ready to be joined, and a call to <code>$thr-&gt;join()</code> will not <i>block</i>.</p>

</dd>
<dt id="$thr-&gt;is_detached()"><a class="permalink" href="#$thr-%3Eis_detached()">#</a><a id="is_detached"></a><a id="thr-is_detached"></a>$thr-&gt;is_detached()</dt>
<dd>

<p>Returns true if the thread has been detached.</p>

</dd>
<dt id="threads-&gt;is_detached()"><a class="permalink" href="#threads-%3Eis_detached()">#</a><a id="threads14"></a><a id="threads-is_detached"></a>threads-&gt;is_detached()</dt>
<dd>

<p>Class method that allows a thread to determine whether or not it is detached.</p>

</dd>
</dl>

<h1 id="THREAD-CONTEXT"><a class="permalink" href="#THREAD-CONTEXT">#</a><a id="THREAD1"></a>THREAD CONTEXT</h1>

<p>As with subroutines, the type of value returned from a thread&#39;s entry point function may be determined by the thread&#39;s <i>context</i>: list, scalar or void. The thread&#39;s context is determined at thread creation. This is necessary so that the context is available to the entry point function via <a href="https://perldoc.perl.org/5.12.1/perlfunc#wantarray">wantarray()</a>. The thread may then specify a value of the appropriate type to be returned from <code>-&gt;join()</code>.</p>

<h2 id="Explicit-context"><a class="permalink" href="#Explicit-context">#</a><a id="Explicit"></a>Explicit context</h2>

<p>Because thread creation and thread joining may occur in different contexts, it may be desirable to state the context explicitly to the thread&#39;s entry point function. This may be done by calling <code>-&gt;create()</code> with a hash reference as the first argument:</p>

<pre><code>my $thr = threads-&gt;create({&#39;context&#39; =&gt; &#39;list&#39;}, \&amp;foo);
...
my @results = $thr-&gt;join();</code></pre>

<p>In the above, the threads object is returned to the parent thread in scalar context, and the thread&#39;s entry point function <code>foo</code> will be called in list (array) context such that the parent thread can receive a list (array) from the <code>-&gt;join()</code> call. (<code>&#39;array&#39;</code> is synonymous with <code>&#39;list&#39;</code>.)</p>

<p>Similarly, if you need the threads object, but your thread will not be returning a value (i.e., <i>void</i> context), you would do the following:</p>

<pre><code>my $thr = threads-&gt;create({&#39;context&#39; =&gt; &#39;void&#39;}, \&amp;foo);
...
$thr-&gt;join();</code></pre>

<p>The context type may also be used as the <i>key</i> in the hash reference followed by a <i>true</i> value:</p>

<pre><code>threads-&gt;create({&#39;scalar&#39; =&gt; 1}, \&amp;foo);
...
my ($thr) = threads-&gt;list();
my $result = $thr-&gt;join();</code></pre>

<h2 id="Implicit-context"><a class="permalink" href="#Implicit-context">#</a><a id="Implicit"></a>Implicit context</h2>

<p>If not explicitly stated, the thread&#39;s context is implied from the context of the <code>-&gt;create()</code> call:</p>

<pre><code># Create thread in list context
my ($thr) = threads-&gt;create(...);

# Create thread in scalar context
my $thr = threads-&gt;create(...);

# Create thread in void context
threads-&gt;create(...);</code></pre>

<h2 id="$thr-&gt;wantarray()"><a class="permalink" href="#$thr-%3Ewantarray()">#</a><a id="wantarray"></a><a id="thr-wantarray"></a>$thr-&gt;wantarray()</h2>

<p>This returns the thread&#39;s context in the same manner as <a href="https://perldoc.perl.org/5.12.1/perlfunc#wantarray">wantarray()</a>.</p>

<h2 id="threads-&gt;wantarray()"><a class="permalink" href="#threads-%3Ewantarray()">#</a><a id="threads15"></a><a id="threads-wantarray"></a>threads-&gt;wantarray()</h2>

<p>Class method to return the current thread&#39;s context. This returns the same value as running <a href="https://perldoc.perl.org/5.12.1/perlfunc#wantarray">wantarray()</a> inside the current thread&#39;s entry point function.</p>

<h1 id="THREAD-STACK-SIZE"><a class="permalink" href="#THREAD-STACK-SIZE">#</a><a id="THREAD2"></a>THREAD STACK SIZE</h1>

<p>The default per-thread stack size for different platforms varies significantly, and is almost always far more than is needed for most applications. On Win32, Perl&#39;s makefile explicitly sets the default stack to 16 MB; on most other platforms, the system default is used, which again may be much larger than is needed.</p>

<p>By tuning the stack size to more accurately reflect your application&#39;s needs, you may significantly reduce your application&#39;s memory usage, and increase the number of simultaneously running threads.</p>

<p>Note that on Windows, address space allocation granularity is 64 KB, therefore, setting the stack smaller than that on Win32 Perl will not save any more memory.</p>

<dl>

<dt id="threads-&gt;get_stack_size();"><a class="permalink" href="#threads-%3Eget_stack_size();">#</a><a id="threads16"></a><a id="threads-get_stack_size"></a>threads-&gt;get_stack_size();</dt>
<dd>

<p>Returns the current default per-thread stack size. The default is zero, which means the system default stack size is currently in use.</p>

</dd>
<dt id="$size-=-$thr-&gt;get_stack_size();"><a class="permalink" href="#$size-=-$thr-%3Eget_stack_size();">#</a><a id="size-thr-get_stack_size"></a>$size = $thr-&gt;get_stack_size();</dt>
<dd>

<p>Returns the stack size for a particular thread. A return value of zero indicates the system default stack size was used for the thread.</p>

</dd>
<dt id="$old_size-=-threads-&gt;set_stack_size($new_size);"><a class="permalink" href="#$old_size-=-threads-%3Eset_stack_size($new_size);">#</a><a id="old_size-threads-set_stack_size-new_size"></a>$old_size = threads-&gt;set_stack_size($new_size);</dt>
<dd>

<p>Sets a new default per-thread stack size, and returns the previous setting.</p>

<p>Some platforms have a minimum thread stack size. Trying to set the stack size below this value will result in a warning, and the minimum stack size will be used.</p>

<p>Some Linux platforms have a maximum stack size. Setting too large of a stack size will cause thread creation to fail.</p>

<p>If needed, <code>$new_size</code> will be rounded up to the next multiple of the memory page size (usually 4096 or 8192).</p>

<p>Threads created after the stack size is set will then either call <code>pthread_attr_setstacksize()</code> <i>(for pthreads platforms)</i>, or supply the stack size to <code>CreateThread()</code> <i>(for Win32 Perl)</i>.</p>

<p>(Obviously, this call does not affect any currently extant threads.)</p>

</dd>
<dt id="use-threads-(&#39;stack_size&#39;-=&gt;-VALUE);"><a class="permalink" href="#use-threads-(&#39;stack_size&#39;-=%3E-VALUE);">#</a><a id="use1"></a><a id="use-threads-stack_size-VALUE"></a>use threads (&#39;stack_size&#39; =&gt; VALUE);</dt>
<dd>

<p>This sets the default per-thread stack size at the start of the application.</p>

</dd>
<dt id="$ENV{&#39;PERL5_ITHREADS_STACK_SIZE&#39;}"><a class="permalink" href="#$ENV%7B&#39;PERL5_ITHREADS_STACK_SIZE&#39;%7D">#</a><a id="ENV-PERL5_ITHREADS_STACK_SIZE"></a>$ENV{&#39;PERL5_ITHREADS_STACK_SIZE&#39;}</dt>
<dd>

<p>The default per-thread stack size may be set at the start of the application through the use of the environment variable <code>PERL5_ITHREADS_STACK_SIZE</code>:</p>

<pre><code>PERL5_ITHREADS_STACK_SIZE=1048576
export PERL5_ITHREADS_STACK_SIZE
perl -e&#39;use threads; print(threads-&gt;get_stack_size(), &quot;\n&quot;)&#39;</code></pre>

<p>This value overrides any <code>stack_size</code> parameter given to <code>use threads</code>. Its primary purpose is to permit setting the per-thread stack size for legacy threaded applications.</p>

</dd>
<dt id="threads-&gt;create({&#39;stack_size&#39;-=&gt;-VALUE},-FUNCTION,-ARGS)"><a class="permalink" href="#threads-%3Ecreate(%7B&#39;stack_size&#39;-=%3E-VALUE%7D,-FUNCTION,-ARGS)">#</a><a id="threads17"></a><a id="threads-create-stack_size-VALUE-FUNCTION-ARGS"></a>threads-&gt;create({&#39;stack_size&#39; =&gt; VALUE}, FUNCTION, ARGS)</dt>
<dd>

<p>To specify a particular stack size for any individual thread, call <code>-&gt;create()</code> with a hash reference as the first argument:</p>

<pre><code>my $thr = threads-&gt;create({&#39;stack_size&#39; =&gt; 32*4096}, \&amp;foo, @args);</code></pre>

</dd>
<dt id="$thr2-=-$thr1-&gt;create(FUNCTION,-ARGS)"><a class="permalink" href="#$thr2-=-$thr1-%3Ecreate(FUNCTION,-ARGS)">#</a><a id="thr2-thr1-create-FUNCTION-ARGS"></a>$thr2 = $thr1-&gt;create(FUNCTION, ARGS)</dt>
<dd>

<p>This creates a new thread (<code>$thr2</code>) that inherits the stack size from an existing thread (<code>$thr1</code>). This is shorthand for the following:</p>

<pre><code>my $stack_size = $thr1-&gt;get_stack_size();
my $thr2 = threads-&gt;create({&#39;stack_size&#39; =&gt; $stack_size}, FUNCTION, ARGS);</code></pre>

</dd>
</dl>

<h1 id="THREAD-SIGNALLING"><a class="permalink" href="#THREAD-SIGNALLING">#</a><a id="THREAD3"></a>THREAD SIGNALLING</h1>

<p>When safe signals is in effect (the default behavior - see <a href="#Unsafe-signals">&quot;Unsafe signals&quot;</a> for more details), then signals may be sent and acted upon by individual threads.</p>

<dl>

<dt id="$thr-&gt;kill(&#39;SIG...&#39;);"><a class="permalink" href="#$thr-%3Ekill(&#39;SIG...&#39;);">#</a><a id="kill"></a><a id="thr-kill-SIG"></a>$thr-&gt;kill(&#39;SIG...&#39;);</dt>
<dd>

<p>Sends the specified signal to the thread. Signal names and (positive) signal numbers are the same as those supported by <a href="https://perldoc.perl.org/5.12.1/perlfunc#kill-SIGNAL%2C-LIST">kill()</a>. For example, &#39;SIGTERM&#39;, &#39;TERM&#39; and (depending on the OS) 15 are all valid arguments to <code>-&gt;kill()</code>.</p>

<p>Returns the thread object to allow for method chaining:</p>

<pre><code>$thr-&gt;kill(&#39;SIG...&#39;)-&gt;join();</code></pre>

</dd>
</dl>

<p>Signal handlers need to be set up in the threads for the signals they are expected to act upon. Here&#39;s an example for <i>cancelling</i> a thread:</p>

<pre><code>use threads;

sub thr_func
{
    # Thread &#39;cancellation&#39; signal handler
    $SIG{&#39;KILL&#39;} = sub { threads-&gt;exit(); };

    ...
}

# Create a thread
my $thr = threads-&gt;create(&#39;thr_func&#39;);

...

# Signal the thread to terminate, and then detach
# it so that it will get cleaned up automatically
$thr-&gt;kill(&#39;KILL&#39;)-&gt;detach();</code></pre>

<p>Here&#39;s another simplistic example that illustrates the use of thread signalling in conjunction with a semaphore to provide rudimentary <i>suspend</i> and <i>resume</i> capabilities:</p>

<pre><code>use threads;
use Thread::Semaphore;

sub thr_func
{
    my $sema = shift;

    # Thread &#39;suspend/resume&#39; signal handler
    $SIG{&#39;STOP&#39;} = sub {
        $sema-&gt;down();      # Thread suspended
        $sema-&gt;up();        # Thread resumes
    };

    ...
}

# Create a semaphore and pass it to a thread
my $sema = Thread::Semaphore-&gt;new();
my $thr = threads-&gt;create(&#39;thr_func&#39;, $sema);

# Suspend the thread
$sema-&gt;down();
$thr-&gt;kill(&#39;STOP&#39;);

...

# Allow the thread to continue
$sema-&gt;up();</code></pre>

<p>CAVEAT: The thread signalling capability provided by this module does not actually send signals via the OS. It <i>emulates</i> signals at the Perl-level such that signal handlers are called in the appropriate thread. For example, sending <code>$thr-&gt;kill(&#39;STOP&#39;)</code> does not actually suspend a thread (or the whole process), but does cause a <code>$SIG{&#39;STOP&#39;}</code> handler to be called in that thread (as illustrated above).</p>

<p>As such, signals that would normally not be appropriate to use in the <code>kill()</code> command (e.g., <code>kill(&#39;KILL&#39;, $$)</code>) are okay to use with the <code>-&gt;kill()</code> method (again, as illustrated above).</p>

<p>Correspondingly, sending a signal to a thread does not disrupt the operation the thread is currently working on: The signal will be acted upon after the current operation has completed. For instance, if the thread is <i>stuck</i> on an I/O call, sending it a signal will not cause the I/O call to be interrupted such that the signal is acted up immediately.</p>

<p>Sending a signal to a terminated thread is ignored.</p>

<h1 id="WARNINGS"><a class="permalink" href="#WARNINGS">#</a>WARNINGS</h1>

<dl>

<dt id="Perl-exited-with-active-threads:"><a class="permalink" href="#Perl-exited-with-active-threads:">#</a><a id="Perl"></a><a id="Perl-exited-with-active-threads"></a>Perl exited with active threads:</dt>
<dd>

<p>If the program exits without all threads having either been joined or detached, then this warning will be issued.</p>

<p>NOTE: If the <i>main</i> thread exits, then this warning cannot be suppressed using <code>no warnings &#39;threads&#39;;</code> as suggested below.</p>

</dd>
<dt id="Thread-creation-failed:-pthread_create-returned-#"><a class="permalink" href="#Thread-creation-failed:-pthread_create-returned-%23">#</a><a id="Thread"></a><a id="Thread-creation-failed:-pthread_create-returned"></a>Thread creation failed: pthread_create returned #</dt>
<dd>

<p>See the appropriate <i>man</i> page for <code>pthread_create</code> to determine the actual cause for the failure.</p>

</dd>
<dt id="Thread-#-terminated-abnormally:-..."><a class="permalink" href="#Thread-%23-terminated-abnormally:-...">#</a><a id="Thread1"></a><a id="Thread-terminated-abnormally"></a>Thread # terminated abnormally: ...</dt>
<dd>

<p>A thread terminated in some manner other than just returning from its entry point function, or by using <code>threads-&gt;exit()</code>. For example, the thread may have terminated because of an error, or by using <code>die</code>.</p>

</dd>
<dt id="Using-minimum-thread-stack-size-of-#"><a class="permalink" href="#Using-minimum-thread-stack-size-of-%23">#</a><a id="Using"></a><a id="Using-minimum-thread-stack-size-of"></a>Using minimum thread stack size of #</dt>
<dd>

<p>Some platforms have a minimum thread stack size. Trying to set the stack size below this value will result in the above warning, and the stack size will be set to the minimum.</p>

</dd>
<dt id="Thread-creation-failed:-pthread_attr_setstacksize(SIZE)-returned-22"><a class="permalink" href="#Thread-creation-failed:-pthread_attr_setstacksize(SIZE)-returned-22">#</a><a id="Thread2"></a><a id="Thread-creation-failed:-pthread_attr_setstacksize-SIZE-returned-22"></a>Thread creation failed: pthread_attr_setstacksize(<i>SIZE</i>) returned 22</dt>
<dd>

<p>The specified <i>SIZE</i> exceeds the system&#39;s maximum stack size. Use a smaller value for the stack size.</p>

</dd>
</dl>

<p>If needed, thread warnings can be suppressed by using:</p>

<pre><code>no warnings &#39;threads&#39;;</code></pre>

<p>in the appropriate scope.</p>

<h1 id="ERRORS"><a class="permalink" href="#ERRORS">#</a>ERRORS</h1>

<dl>

<dt id="This-Perl-not-built-to-support-threads"><a class="permalink" href="#This-Perl-not-built-to-support-threads">#</a><a id="This"></a>This Perl not built to support threads</dt>
<dd>

<p>The particular copy of Perl that you&#39;re trying to use was not built using the <code>useithreads</code> configuration option.</p>

<p>Having threads support requires all of Perl and all of the XS modules in the Perl installation to be rebuilt; it is not just a question of adding the <a href="threads.html">threads</a> module (i.e., threaded and non-threaded Perls are binary incompatible.)</p>

</dd>
<dt id="Cannot-change-stack-size-of-an-existing-thread"><a class="permalink" href="#Cannot-change-stack-size-of-an-existing-thread">#</a><a id="Cannot"></a>Cannot change stack size of an existing thread</dt>
<dd>

<p>The stack size of currently extant threads cannot be changed, therefore, the following results in the above error:</p>

<pre><code>$thr-&gt;set_stack_size($size);</code></pre>

</dd>
<dt id="Cannot-signal-threads-without-safe-signals"><a class="permalink" href="#Cannot-signal-threads-without-safe-signals">#</a><a id="Cannot1"></a>Cannot signal threads without safe signals</dt>
<dd>

<p>Safe signals must be in effect to use the <code>-&gt;kill()</code> signalling method. See <a href="#Unsafe-signals">&quot;Unsafe signals&quot;</a> for more details.</p>

</dd>
<dt id="Unrecognized-signal-name:-..."><a class="permalink" href="#Unrecognized-signal-name:-...">#</a><a id="Unrecognized"></a><a id="Unrecognized-signal-name"></a>Unrecognized signal name: ...</dt>
<dd>

<p>The particular copy of Perl that you&#39;re trying to use does not support the specified signal being used in a <code>-&gt;kill()</code> call.</p>

</dd>
</dl>

<h1 id="BUGS-AND-LIMITATIONS"><a class="permalink" href="#BUGS-AND-LIMITATIONS">#</a><a id="BUGS"></a>BUGS AND LIMITATIONS</h1>

<p>Before you consider posting a bug report, please consult, and possibly post a message to the discussion forum to see if what you&#39;ve encountered is a known problem.</p>

<dl>

<dt id="Thread-safe-modules"><a class="permalink" href="#Thread-safe-modules">#</a><a id="Thread3"></a>Thread-safe modules</dt>
<dd>

<p>See <a href="perlmod.html#Making-your-module-threadsafe">&quot;Making your module threadsafe&quot; in perlmod</a> when creating modules that may be used in threaded applications, especially if those modules use non-Perl data, or XS code.</p>

</dd>
<dt id="Using-non-thread-safe-modules"><a class="permalink" href="#Using-non-thread-safe-modules">#</a><a id="Using1"></a>Using non-thread-safe modules</dt>
<dd>

<p>Unfortunately, you may encounter Perl modules that are not <i>thread-safe</i>. For example, they may crash the Perl interpreter during execution, or may dump core on termination. Depending on the module and the requirements of your application, it may be possible to work around such difficulties.</p>

<p>If the module will only be used inside a thread, you can try loading the module from inside the thread entry point function using <code>require</code> (and <code>import</code> if needed):</p>

<pre><code>sub thr_func
{
    require Unsafe::Module
    # Unsafe::Module-&gt;import(...);

    ....
}</code></pre>

<p>If the module is needed inside the <i>main</i> thread, try modifying your application so that the module is loaded (again using <code>require</code> and <code>-&gt;import()</code>) after any threads are started, and in such a way that no other threads are started afterwards.</p>

<p>If the above does not work, or is not adequate for your application, then file a bug report on <a href="http://rt.cpan.org/Public/">http://rt.cpan.org/Public/</a> against the problematic module.</p>

</dd>
<dt id="Current-working-directory"><a class="permalink" href="#Current-working-directory">#</a><a id="Current"></a>Current working directory</dt>
<dd>

<p>On all platforms except MSWin32, the setting for the current working directory is shared among all threads such that changing it in one thread (e.g., using <code>chdir()</code>) will affect all the threads in the application.</p>

<p>On MSWin32, each thread maintains its own the current working directory setting.</p>

</dd>
<dt id="Environment-variables"><a class="permalink" href="#Environment-variables">#</a><a id="Environment"></a>Environment variables</dt>
<dd>

<p>Currently, on all platforms except MSWin32, all <i>system</i> calls (e.g., using <code>system()</code> or back-ticks) made from threads use the environment variable settings from the <i>main</i> thread. In other words, changes made to <code>%ENV</code> in a thread will not be visible in <i>system</i> calls made by that thread.</p>

<p>To work around this, set environment variables as part of the <i>system</i> call. For example:</p>

<pre><code>my $msg = &#39;hello&#39;;
system(&quot;FOO=$msg; echo \$FOO&quot;);   # Outputs &#39;hello&#39; to STDOUT</code></pre>

<p>On MSWin32, each thread maintains its own set of environment variables.</p>

</dd>
<dt id="Parent-child-threads"><a class="permalink" href="#Parent-child-threads">#</a><a id="Parent"></a>Parent-child threads</dt>
<dd>

<p>On some platforms, it might not be possible to destroy <i>parent</i> threads while there are still existing <i>child</i> threads.</p>

</dd>
<dt id="Creating-threads-inside-special-blocks"><a class="permalink" href="#Creating-threads-inside-special-blocks">#</a><a id="Creating"></a>Creating threads inside special blocks</dt>
<dd>

<p>Creating threads inside <code>BEGIN</code>, <code>CHECK</code> or <code>INIT</code> blocks should not be relied upon. Depending on the Perl version and the application code, results may range from success, to (apparently harmless) warnings of leaked scalar, or all the way up to crashing of the Perl interpreter.</p>

</dd>
<dt id="Unsafe-signals"><a class="permalink" href="#Unsafe-signals">#</a><a id="Unsafe"></a>Unsafe signals</dt>
<dd>

<p>Since Perl 5.8.0, signals have been made safer in Perl by postponing their handling until the interpreter is in a <i>safe</i> state. See <a href="https://perldoc.perl.org/5.12.1/perl58delta#Safe-Signals">&quot;Safe Signals&quot; in perl58delta</a> and <a href="https://perldoc.perl.org/5.12.1/perlipc#Deferred-Signals-(Safe-Signals)">&quot;Deferred Signals (Safe Signals)&quot; in perlipc</a> for more details.</p>

<p>Safe signals is the default behavior, and the old, immediate, unsafe signalling behavior is only in effect in the following situations:</p>

<ul>

<li><p>Perl has been built with <code>PERL_OLD_SIGNALS</code> (see <code>perl -V</code>).</p>

</li>
<li><p>The environment variable <code>PERL_SIGNALS</code> is set to <code>unsafe</code> (see <a href="https://perldoc.perl.org/5.12.1/perlrun#PERL_SIGNALS">&quot;PERL_SIGNALS&quot; in perlrun</a>).</p>

</li>
<li><p>The module <a href="https://metacpan.org/pod/Perl::Unsafe::Signals">Perl::Unsafe::Signals</a> is used.</p>

</li>
</ul>

<p>If unsafe signals is in effect, then signal handling is not thread-safe, and the <code>-&gt;kill()</code> signalling method cannot be used.</p>

</dd>
<dt id="Returning-closures-from-threads"><a class="permalink" href="#Returning-closures-from-threads">#</a><a id="Returning"></a>Returning closures from threads</dt>
<dd>

<p>Returning closures from threads should not be relied upon. Depending of the Perl version and the application code, results may range from success, to (apparently harmless) warnings of leaked scalar, or all the way up to crashing of the Perl interpreter.</p>

</dd>
<dt id="Returning-objects-from-threads"><a class="permalink" href="#Returning-objects-from-threads">#</a><a id="Returning1"></a>Returning objects from threads</dt>
<dd>

<p>Returning objects from threads does not work. Depending on the classes involved, you may be able to work around this by returning a serialized version of the object (e.g., using <a href="https://perldoc.perl.org/5.12.1/Data::Dumper">Data::Dumper</a> or <a href="https://perldoc.perl.org/5.12.1/Storable">Storable</a>), and then reconstituting it in the joining thread. If you&#39;re using Perl 5.10.0 or later, and if the class supports <a href="https://perldoc.perl.org/5.12.1/threads::shared#OBJECTS">shared objects</a>, you can pass them via <a href="https://metacpan.org/pod/%2520Thread::Queue">shared queues</a>.</p>

</dd>
<dt id="END-blocks-in-threads"><a class="permalink" href="#END-blocks-in-threads">#</a><a id="END"></a>END blocks in threads</dt>
<dd>

<p>It is possible to add <a href="perlmod.html#BEGIN%2C-UNITCHECK%2C-CHECK%2C-INIT-and-END">END blocks</a> to threads by using <a href="https://perldoc.perl.org/5.12.1/perlfunc#require-VERSION">require</a> or <a href="https://perldoc.perl.org/5.12.1/perlfunc#eval-EXPR">eval</a> with the appropriate code. These <code>END</code> blocks will then be executed when the thread&#39;s interpreter is destroyed (i.e., either during a <code>-&gt;join()</code> call, or at program termination).</p>

<p>However, calling any <a href="threads.html">threads</a> methods in such an <code>END</code> block will most likely <i>fail</i> (e.g., the application may hang, or generate an error) due to mutexes that are needed to control functionality within the <a href="threads.html">threads</a> module.</p>

<p>For this reason, the use of <code>END</code> blocks in threads is <b>strongly</b> discouraged.</p>

</dd>
<dt id="Perl-Bugs-and-the-CPAN-Version-of-threads"><a class="permalink" href="#Perl-Bugs-and-the-CPAN-Version-of-threads">#</a><a id="Perl1"></a>Perl Bugs and the CPAN Version of <a href="threads.html">threads</a></dt>
<dd>

<p>Support for threads extends beyond the code in this module (i.e., <i>threads.pm</i> and <i>threads.xs</i>), and into the Perl interpreter itself. Older versions of Perl contain bugs that may manifest themselves despite using the latest version of <a href="threads.html">threads</a> from CPAN. There is no workaround for this other than upgrading to the latest version of Perl.</p>

<p>Even with the latest version of Perl, it is known that certain constructs with threads may result in warning messages concerning leaked scalars or unreferenced scalars. However, such warnings are harmless, and may safely be ignored.</p>

<p>You can search for <a href="threads.html">threads</a> related bug reports at <a href="http://rt.cpan.org/Public/">http://rt.cpan.org/Public/</a>. If needed submit any new bugs, problems, patches, etc. to: <a href="http://rt.cpan.org/Public/Dist/Display.html?Name=threads">http://rt.cpan.org/Public/Dist/Display.html?Name=threads</a></p>

</dd>
</dl>

<h1 id="REQUIREMENTS"><a class="permalink" href="#REQUIREMENTS">#</a>REQUIREMENTS</h1>

<p>Perl 5.8.0 or later</p>

<h1 id="SEE-ALSO"><a class="permalink" href="#SEE-ALSO">#</a><a id="SEE"></a>SEE ALSO</h1>

<p><a href="threads.html">threads</a> Discussion Forum on CPAN: <a href="http://www.cpanforum.com/dist/threads">http://www.cpanforum.com/dist/threads</a></p>

<p>Annotated POD for <a href="threads.html">threads</a>: <a href="http://annocpan.org/~JDHEDDEN/threads-1.75/threads.pm">http://annocpan.org/~JDHEDDEN/threads-1.75/threads.pm</a></p>

<p>Source repository: <a href="http://code.google.com/p/threads-shared/">http://code.google.com/p/threads-shared/</a></p>

<p><a href="https://perldoc.perl.org/5.12.1/threads::shared">threads::shared</a>, <a href="perlthrtut.html">perlthrtut</a></p>

<p><a href="http://www.perl.com/pub/a/2002/06/11/threads.html">http://www.perl.com/pub/a/2002/06/11/threads.html</a> and <a href="http://www.perl.com/pub/a/2002/09/04/threads.html">http://www.perl.com/pub/a/2002/09/04/threads.html</a></p>

<p>Perl threads mailing list: <a href="http://lists.cpan.org/showlist.cgi?name=iThreads">http://lists.cpan.org/showlist.cgi?name=iThreads</a></p>

<p>Stack size discussion: <a href="http://www.perlmonks.org/?node_id=532956">http://www.perlmonks.org/?node_id=532956</a></p>

<h1 id="AUTHOR"><a class="permalink" href="#AUTHOR">#</a>AUTHOR</h1>

<p>Artur Bergman &lt;sky AT crucially DOT net&gt;</p>

<p>CPAN version produced by Jerry D. Hedden &lt;jdhedden AT cpan DOT org&gt;</p>

<h1 id="LICENSE"><a class="permalink" href="#LICENSE">#</a>LICENSE</h1>

<p>threads is released under the same license as Perl.</p>

<h1 id="ACKNOWLEDGEMENTS"><a class="permalink" href="#ACKNOWLEDGEMENTS">#</a>ACKNOWLEDGEMENTS</h1>

<p>Richard Soderberg &lt;perl AT crystalflame DOT net&gt; - Helping me out tons, trying to find reasons for races and other weird bugs!</p>

<p>Simon Cozens &lt;simon AT brecon DOT co DOT uk&gt; - Being there to answer zillions of annoying questions</p>

<p>Rocco Caputo &lt;troc AT netrus DOT net&gt;</p>

<p>Vipul Ved Prakash &lt;mail AT vipul DOT net&gt; - Helping with debugging</p>

<p>Dean Arnold &lt;darnold AT presicient DOT com&gt; - Stack size API</p>


      </div>
      <div id="footer">
        <p>Perldoc Browser is maintained by Dan Book (<a href="https://metacpan.org/author/DBOOK">DBOOK</a>). Please contact him via the <a href="https://github.com/Grinnz/perldoc-browser/issues">GitHub issue tracker</a> or <a href="mailto:dbook@cpan.org">email</a> regarding any issues with the site itself, search, or rendering of documentation.</p>

<p>The Perl documentation is maintained by the Perl 5 Porters in the development of Perl. Please contact them via the <a href="https://github.com/Perl/perl5/issues">Perl issue tracker</a>, the <a href="https://lists.perl.org/list/perl5-porters.html">mailing list</a>, or <a href="https://kiwiirc.com/client/irc.perl.org/p5p">IRC</a> to report any issues with the contents or format of the documentation.</p>


      </div>
    </div>
    <script src="../js/bootstrap.bundle.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.highlightAll();</script>
  </body>

<!-- Mirrored from perldoc.perl.org/5.12.1/threads by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Aug 2025 16:20:40 GMT -->
</html>
