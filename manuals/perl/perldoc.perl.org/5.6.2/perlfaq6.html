<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from perldoc.perl.org/5.6.2/perlfaq6 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Aug 2025 16:20:45 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>perlfaq6 - Regular Expressions ($Revision: 1.20 $, $Date: 2003/01/03 20:05:28 $) - Perldoc Browser</title>
    <link rel="search" href="../opensearch.xml" type="application/opensearchdescription+xml" title="Perldoc Browser">
    <link rel="canonical" href="../perlfaq6.html">
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/stackoverflow-light.min.css" rel="stylesheet">
    <link href="../css/perldoc.css" rel="stylesheet">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KVNWBNT5FB"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-KVNWBNT5FB');
      gtag('config', 'UA-50555-3');
    </script>
  </head>
  <body>
    <nav class="navbar navbar-expand-md bg-dark" data-bs-theme="dark"><div class="container-fluid">
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a class="navbar-brand" href="../index.html"><img src="../images/perl_camel_30.png" width="30" height="30" class="d-inline-block align-text-top" alt="Perl Camel Logo"> Perldoc Browser</a>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav me-auto">
      <li class="nav-item dropdown text-nowrap">
        <a class="nav-link dropdown-toggle" href="#" id="dropdownlink-stable" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">5.6.2</a>
        <div class="dropdown-menu" aria-labelledby="dropdownlink-stable">
          <a class="dropdown-item" href="../perlfaq6.html">Latest</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0/perlfaq6">5.42.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.3/perlfaq6">5.40.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.2/perlfaq6">5.40.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.1/perlfaq6">5.40.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.0/perlfaq6">5.40.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.5/perlfaq6">5.38.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.4/perlfaq6">5.38.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.3/perlfaq6">5.38.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.2/perlfaq6">5.38.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.1/perlfaq6">5.38.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.0/perlfaq6">5.38.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.3/perlfaq6">5.36.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.2/perlfaq6">5.36.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.1/perlfaq6">5.36.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.36.0/perlfaq6">5.36.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.3/perlfaq6">5.34.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.2/perlfaq6">5.34.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.1/perlfaq6">5.34.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.34.0/perlfaq6">5.34.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.32.1/perlfaq6">5.32.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.32.0/perlfaq6">5.32.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.3/perlfaq6">5.30.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.2/perlfaq6">5.30.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.1/perlfaq6">5.30.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.30.0/perlfaq6">5.30.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.3/perlfaq6">5.28.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.2/perlfaq6">5.28.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.1/perlfaq6">5.28.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.28.0/perlfaq6">5.28.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.3/perlfaq6">5.26.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.2/perlfaq6">5.26.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.1/perlfaq6">5.26.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.26.0/perlfaq6">5.26.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.4/perlfaq6">5.24.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.3/perlfaq6">5.24.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.2/perlfaq6">5.24.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.1/perlfaq6">5.24.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.24.0/perlfaq6">5.24.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.4/perlfaq6">5.22.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.3/perlfaq6">5.22.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.2/perlfaq6">5.22.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.1/perlfaq6">5.22.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.22.0/perlfaq6">5.22.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.3/perlfaq6">5.20.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.2/perlfaq6">5.20.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.1/perlfaq6">5.20.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.20.0/perlfaq6">5.20.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.4/perlfaq6">5.18.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.3/perlfaq6">5.18.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.2/perlfaq6">5.18.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.1/perlfaq6">5.18.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.18.0/perlfaq6">5.18.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.16.3/perlfaq6">5.16.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.16.2/perlfaq6">5.16.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.16.1/perlfaq6">5.16.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.16.0/perlfaq6">5.16.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.14.4/perlfaq6">5.14.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.14.3/perlfaq6">5.14.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.14.2/perlfaq6">5.14.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.14.1/perlfaq6">5.14.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.14.0/perlfaq6">5.14.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.5/perlfaq6">5.12.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.4/perlfaq6">5.12.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.3/perlfaq6">5.12.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.2/perlfaq6">5.12.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.1/perlfaq6">5.12.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.12.0/perlfaq6">5.12.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.10.1/perlfaq6">5.10.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.10.0/perlfaq6">5.10.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.9/perlfaq6">5.8.9</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.8/perlfaq6">5.8.8</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.7/perlfaq6">5.8.7</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.6/perlfaq6">5.8.6</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.5/perlfaq6">5.8.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.4/perlfaq6">5.8.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.3/perlfaq6">5.8.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.2/perlfaq6">5.8.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.1/perlfaq6">5.8.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.8.0/perlfaq6">5.8.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item active" href="perlfaq6.html">5.6.2</a>
          <a class="dropdown-item" href="../5.6.1/perlfaq6.html">5.6.1</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.6.0/perlfaq6">5.6.0</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_04/perlfaq6">5.005_04</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_03/perlfaq6">5.005_03</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_02/perlfaq6">5.005_02</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005_01/perlfaq6">5.005_01</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.005/perlfaq6">5.005</a>
        </div>
      </li>
      <li class="nav-item dropdown text-nowrap">
        <a class="nav-link dropdown-toggle" href="#" id="dropdownlink-dev" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dev</a>
        <div class="dropdown-menu" aria-labelledby="dropdownlink-dev">
          <a class="dropdown-item" href="https://perldoc.perl.org/blead/perlfaq6">blead</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.43.1/perlfaq6">5.43.1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0-RC3/perlfaq6">5.42.0-RC3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0-RC2/perlfaq6">5.42.0-RC2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.42.0-RC1/perlfaq6">5.42.0-RC1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.13/perlfaq6">5.41.13</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.12/perlfaq6">5.41.12</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.11/perlfaq6">5.41.11</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.10/perlfaq6">5.41.10</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.9/perlfaq6">5.41.9</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.8/perlfaq6">5.41.8</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.7/perlfaq6">5.41.7</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.6/perlfaq6">5.41.6</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.5/perlfaq6">5.41.5</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.4/perlfaq6">5.41.4</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.3/perlfaq6">5.41.3</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.2/perlfaq6">5.41.2</a>
          <a class="dropdown-item" href="https://perldoc.perl.org/5.41.1/perlfaq6">5.41.1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.40.3-RC1/perlfaq6">5.40.3-RC1</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="https://perldoc.perl.org/5.38.5-RC1/perlfaq6">5.38.5-RC1</a>
        </div>
      </li>
      <li class="nav-item dropdown text-nowrap">
        <a class="nav-link dropdown-toggle" href="#" id="dropdownlink-nav" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Documentation</a>
        <div class="dropdown-menu" aria-labelledby="dropdownlink-nav">
          <a class="dropdown-item" href="perl.html">Perl</a>
          <a class="dropdown-item" href="perlintro.html">Intro</a>
          <a class="dropdown-item" href="perl.html#Tutorials">Tutorials</a>
          <a class="dropdown-item" href="perlfaq.html">FAQs</a>
          <a class="dropdown-item" href="perl.html#Reference-Manual">Reference</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="perlop.html">Operators</a>
          <a class="dropdown-item" href="functions.html">Functions</a>
          <a class="dropdown-item" href="variables.html">Variables</a>
          <a class="dropdown-item" href="modules.html">Modules</a>
          <a class="dropdown-item" href="perlutil.html">Utilities</a>
          <hr class="dropdown-divider">
          <a class="dropdown-item" href="perldelta.html">Release Notes</a>
          <a class="dropdown-item" href="perlcommunity.html">Community</a>
          <a class="dropdown-item" href="perlhist.html">History</a>
        </div>
      </li>
    </ul>
    <ul class="navbar-nav">
      <button id="content-expand-button" type="button" class="btn btn-dark d-none d-lg-inline-block me-4">Expand</button>
      <script src="../js/perldoc-expand-page.js"></script>
    </ul>
    <form class="form-inline" method="get" action="https://perldoc.perl.org/5.6.2/search">
      <input id="search-input" class="form-control me-3" type="search" name="q" placeholder="[S]earch" aria-label="Search" value="">
    </form>
    <script src="../js/perldoc-focus-search.js"></script>
  </div>
</div></nav>

    <div id="wrapperlicious" class="container-fluid">
      <div id="perldocdiv">
        <div id="links">
          <a href="perlfaq6.html">perlfaq6</a>
          <div id="more">
            (<a href="https://perldoc.perl.org/5.6.2/perlfaq6.txt">source</a>,
            <a href="https://metacpan.org/pod/perlfaq6">CPAN</a>)
          </div>
        </div>
        <div class="leading-notice">
          You are viewing the version of this documentation from Perl 5.6.2.
            <a href="../perlfaq6.html">View the latest version</a>
        </div>
        <h1><a id="toc">CONTENTS</a></h1>
                  <ul>
              <li>
                <a class="text-decoration-none" href="#NAME">NAME</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#DESCRIPTION">DESCRIPTION</a>
                            <ul>
              <li>
                <a class="text-decoration-none" href="#How-can-I-hope-to-use-regular-expressions-without-creating-illegible-and-unmaintainable-code?">How can I hope to use regular expressions without creating illegible and unmaintainable code?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#I&#39;m-having-trouble-matching-over-more-than-one-line.-What&#39;s-wrong?">I&#39;m having trouble matching over more than one line. What&#39;s wrong?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#How-can-I-pull-out-lines-between-two-patterns-that-are-themselves-on-different-lines?">How can I pull out lines between two patterns that are themselves on different lines?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#I-put-a-regular-expression-into-$/-but-it-didn&#39;t-work.-What&#39;s-wrong?">I put a regular expression into $/ but it didn&#39;t work. What&#39;s wrong?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#How-do-I-substitute-case-insensitively-on-the-LHS-while-preserving-case-on-the-RHS?">How do I substitute case insensitively on the LHS while preserving case on the RHS?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#How-can-I-make-%5Cw-match-national-character-sets?">How can I make \w match national character sets?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#How-can-I-match-a-locale-smart-version-of-/%5Ba-zA-Z%5D/?">How can I match a locale-smart version of /[a-zA-Z]/?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#How-can-I-quote-a-variable-to-use-in-a-regex?">How can I quote a variable to use in a regex?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#What-is-/o-really-for?">What is /o really for?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#How-do-I-use-a-regular-expression-to-strip-C-style-comments-from-a-file?">How do I use a regular expression to strip C style comments from a file?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#Can-I-use-Perl-regular-expressions-to-match-balanced-text?">Can I use Perl regular expressions to match balanced text?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#What-does-it-mean-that-regexes-are-greedy?-How-can-I-get-around-it?">What does it mean that regexes are greedy? How can I get around it?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#How-do-I-process-each-word-on-each-line?">How do I process each word on each line?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#How-can-I-print-out-a-word-frequency-or-line-frequency-summary?">How can I print out a word-frequency or line-frequency summary?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#How-can-I-do-approximate-matching?">How can I do approximate matching?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#How-do-I-efficiently-match-many-regular-expressions-at-once?">How do I efficiently match many regular expressions at once?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#Why-don&#39;t-word-boundary-searches-with-%5Cb-work-for-me?">Why don&#39;t word-boundary searches with \b work for me?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#Why-does-using-$&amp;,-$%60,-or-$&#39;-slow-my-program-down?">Why does using $&amp;, $`, or $&#39; slow my program down?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#What-good-is-%5CG-in-a-regular-expression?">What good is \G in a regular expression?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#Are-Perl-regexes-DFAs-or-NFAs?-Are-they-POSIX-compliant?">Are Perl regexes DFAs or NFAs? Are they POSIX compliant?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#What&#39;s-wrong-with-using-grep-in-a-void-context?">What&#39;s wrong with using grep in a void context?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#How-can-I-match-strings-with-multibyte-characters?">How can I match strings with multibyte characters?</a>
              </li>
              <li>
                <a class="text-decoration-none" href="#How-do-I-match-a-pattern-that-is-supplied-by-the-user?">How do I match a pattern that is supplied by the user?</a>
              </li>
          </ul>

              </li>
              <li>
                <a class="text-decoration-none" href="#AUTHOR-AND-COPYRIGHT">AUTHOR AND COPYRIGHT</a>
              </li>
          </ul>

      <h1 id="NAME"><a class="permalink" href="#NAME">#</a>NAME</h1>

<p>perlfaq6 - Regular Expressions ($Revision: 1.20 $, $Date: 2003/01/03 20:05:28 $)</p>

<h1 id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">#</a>DESCRIPTION</h1>

<p>This section is surprisingly small because the rest of the FAQ is littered with answers involving regular expressions. For example, decoding a URL and checking whether something is a number are handled with regular expressions, but those answers are found elsewhere in this document (in <a href="perlfaq9.html">perlfaq9</a>: ``How do I decode or create those %-encodings on the web&#39;&#39; and <a href="perlfaq4.html">perlfaq4</a>: ``How do I determine whether a scalar is a number/whole/integer/float&#39;&#39;, to be precise).</p>

<h2 id="How-can-I-hope-to-use-regular-expressions-without-creating-illegible-and-unmaintainable-code?"><a class="permalink" href="#How-can-I-hope-to-use-regular-expressions-without-creating-illegible-and-unmaintainable-code?">#</a><a id="How"></a><a id="How-can-I-hope-to-use-regular-expressions-without-creating-illegible-and-unmaintainable-code"></a>How can I hope to use regular expressions without creating illegible and unmaintainable code?</h2>

<p>Three techniques can make regular expressions maintainable and understandable.</p>

<dl>

<dt id="Comments-Outside-the-Regex"><a class="permalink" href="#Comments-Outside-the-Regex">#</a><a id="Comments"></a>Comments Outside the Regex</dt>
<dd>

<p>Describe what you&#39;re doing and how you&#39;re doing it, using normal Perl comments.</p>

<pre><code># turn the line into the first word, a colon, and the
# number of characters on the rest of the line
s/^(\w+)(.*)/ lc($1) . &quot;:&quot; . length($2) /meg;</code></pre>

</dd>
<dt id="Comments-Inside-the-Regex"><a class="permalink" href="#Comments-Inside-the-Regex">#</a><a id="Comments1"></a>Comments Inside the Regex</dt>
<dd>

<p>The <code>/x</code> modifier causes whitespace to be ignored in a regex pattern (except in a character class), and also allows you to use normal comments there, too. As you can imagine, whitespace and comments help a lot.</p>

<p><code>/x</code> lets you turn this:</p>

<pre><code>s{&lt;(?:[^&gt;&#39;&quot;]*|&quot;.*?&quot;|&#39;.*?&#39;)+&gt;}{}gs;</code></pre>

<p>into this:</p>

<pre><code>s{ &lt;                    # opening angle bracket
    (?:                 # Non-backreffing grouping paren
         [^&gt;&#39;&quot;] *       # 0 or more things that are neither &gt; nor &#39; nor &quot;
            |           #    or else
         &quot;.*?&quot;          # a section between double quotes (stingy match)
            |           #    or else
         &#39;.*?&#39;          # a section between single quotes (stingy match)
    ) +                 #   all occurring one or more times
   &gt;                    # closing angle bracket
}{}gsx;                 # replace with nothing, i.e. delete</code></pre>

<p>It&#39;s still not quite so clear as prose, but it is very useful for describing the meaning of each part of the pattern.</p>

</dd>
<dt id="Different-Delimiters"><a class="permalink" href="#Different-Delimiters">#</a><a id="Different"></a>Different Delimiters</dt>
<dd>

<p>While we normally think of patterns as being delimited with <code>/</code> characters, they can be delimited by almost any character. <a href="perlre.html">perlre</a> describes this. For example, the <code>s///</code> above uses braces as delimiters. Selecting another delimiter can avoid quoting the delimiter within the pattern:</p>

<pre><code>s/\/usr\/local/\/usr\/share/g;	# bad delimiter choice
s#/usr/local#/usr/share#g;		# better</code></pre>

</dd>
</dl>

<h2 id="I&#39;m-having-trouble-matching-over-more-than-one-line.-What&#39;s-wrong?"><a class="permalink" href="#I&#39;m-having-trouble-matching-over-more-than-one-line.-What&#39;s-wrong?">#</a><a id="I"></a><a id="Im-having-trouble-matching-over-more-than-one-line.-Whats-wrong"></a>I&#39;m having trouble matching over more than one line. What&#39;s wrong?</h2>

<p>Either you don&#39;t have more than one line in the string you&#39;re looking at (probably), or else you aren&#39;t using the correct modifier(s) on your pattern (possibly).</p>

<p>There are many ways to get multiline data into a string. If you want it to happen automatically while reading input, you&#39;ll want to set $/ (probably to &#39;&#39; for paragraphs or <code>undef</code> for the whole file) to allow you to read more than one line at a time.</p>

<p>Read <a href="perlre.html">perlre</a> to help you decide which of <code>/s</code> and <code>/m</code> (or both) you might want to use: <code>/s</code> allows dot to include newline, and <code>/m</code> allows caret and dollar to match next to a newline, not just at the end of the string. You do need to make sure that you&#39;ve actually got a multiline string in there.</p>

<p>For example, this program detects duplicate words, even when they span line breaks (but not paragraph ones). For this example, we don&#39;t need <code>/s</code> because we aren&#39;t using dot in a regular expression that we want to cross line boundaries. Neither do we need <code>/m</code> because we aren&#39;t wanting caret or dollar to match at any point inside the record next to newlines. But it&#39;s imperative that $/ be set to something other than the default, or else we won&#39;t actually ever have a multiline record read in.</p>

<pre><code>    $/ = &#39;&#39;;  		# read in more whole paragraph, not just one line
    while ( &lt;&gt; ) {
	while ( /\b([\w&#39;-]+)(\s+\1)+\b/gi ) {  	# word starts alpha
	    print &quot;Duplicate $1 at paragraph $.\n&quot;;
	}
    }</code></pre>

<p>Here&#39;s code that finds sentences that begin with &quot;From &quot; (which would be mangled by many mailers):</p>

<pre><code>    $/ = &#39;&#39;;  		# read in more whole paragraph, not just one line
    while ( &lt;&gt; ) {
	while ( /^From /gm ) { # /m makes ^ match next to \n
	    print &quot;leading from in paragraph $.\n&quot;;
	}
    }</code></pre>

<p>Here&#39;s code that finds everything between START and END in a paragraph:</p>

<pre><code>    undef $/;  		# read in whole file, not just one line or paragraph
    while ( &lt;&gt; ) {
	while ( /START(.*?)END/sgm ) { # /s makes . cross line boundaries
	    print &quot;$1\n&quot;;
	}
    }</code></pre>

<h2 id="How-can-I-pull-out-lines-between-two-patterns-that-are-themselves-on-different-lines?"><a class="permalink" href="#How-can-I-pull-out-lines-between-two-patterns-that-are-themselves-on-different-lines?">#</a><a id="How1"></a><a id="How-can-I-pull-out-lines-between-two-patterns-that-are-themselves-on-different-lines"></a>How can I pull out lines between two patterns that are themselves on different lines?</h2>

<p>You can use Perl&#39;s somewhat exotic <code>..</code> operator (documented in <a href="perlop.html">perlop</a>):</p>

<pre><code class="plaintext">perl -ne &#39;print if /START/ .. /END/&#39; file1 file2 ...</code></pre>

<p>If you wanted text and not lines, you would use</p>

<pre><code>perl -0777 -ne &#39;print &quot;$1\n&quot; while /START(.*?)END/gs&#39; file1 file2 ...</code></pre>

<p>But if you want nested occurrences of <code>START</code> through <code>END</code>, you&#39;ll run up against the problem described in the question in this section on matching balanced text.</p>

<p>Here&#39;s another example of using <code>..</code>:</p>

<pre><code>    while (&lt;&gt;) {
        $in_header =   1  .. /^$/;
        $in_body   = /^$/ .. eof();
	# now choose between them
    } continue {
	reset if eof();		# fix $.
    }</code></pre>

<h2 id="I-put-a-regular-expression-into-$/-but-it-didn&#39;t-work.-What&#39;s-wrong?"><a class="permalink" href="#I-put-a-regular-expression-into-$/-but-it-didn&#39;t-work.-What&#39;s-wrong?">#</a><a id="I1"></a><a id="I-put-a-regular-expression-into-but-it-didnt-work.-Whats-wrong"></a>I put a regular expression into $/ but it didn&#39;t work. What&#39;s wrong?</h2>

<p>Up to Perl 5.8.0, $/ has to be a string. This may change in 5.10, but don&#39;t get your hopes up. Until then, you can use these examples if you really need to do this.</p>

<p>Use the four argument form of sysread to continually add to a buffer. After you add to the buffer, you check if you have a complete line (using your regular expression).</p>

<pre><code>      local $_ = &quot;&quot;;
      while( sysread FH, $_, 8192, length ) {
         while( s/^((?s).*?)your_pattern/ ) {
            my $record = $1;
            # do stuff here.
         }
      }

You can do the same thing with foreach and a match using the
c flag and the \G anchor, if you do not mind your entire file
being in memory at the end.

      local $_ = &quot;&quot;;
      while( sysread FH, $_, 8192, length ) {
         foreach my $record ( m/\G((?s).*?)your_pattern/gc ) {
            # do stuff here.
         }
         substr( $_, 0, pos ) = &quot;&quot; if pos;
      }</code></pre>

<h2 id="How-do-I-substitute-case-insensitively-on-the-LHS-while-preserving-case-on-the-RHS?"><a class="permalink" href="#How-do-I-substitute-case-insensitively-on-the-LHS-while-preserving-case-on-the-RHS?">#</a><a id="How2"></a><a id="How-do-I-substitute-case-insensitively-on-the-LHS-while-preserving-case-on-the-RHS"></a>How do I substitute case insensitively on the LHS while preserving case on the RHS?</h2>

<p>Here&#39;s a lovely Perlish solution by Larry Rosler. It exploits properties of bitwise xor on ASCII strings.</p>

<pre><code>    $_= &quot;this is a TEsT case&quot;;

    $old = &#39;test&#39;;
    $new = &#39;success&#39;;

    s{(\Q$old\E)}
     { uc $new | (uc $1 ^ $1) .
	(uc(substr $1, -1) ^ substr $1, -1) x
	    (length($new) - length $1)
     }egi;

    print;</code></pre>

<p>And here it is as a subroutine, modeled after the above:</p>

<pre><code>    sub preserve_case($$) {
	my ($old, $new) = @_;
	my $mask = uc $old ^ $old;

	uc $new | $mask .
	    substr($mask, -1) x (length($new) - length($old))
    }

    $a = &quot;this is a TEsT case&quot;;
    $a =~ s/(test)/preserve_case($1, &quot;success&quot;)/egi;
    print &quot;$a\n&quot;;</code></pre>

<p>This prints:</p>

<pre><code class="plaintext">this is a SUcCESS case</code></pre>

<p>As an alternative, to keep the case of the replacement word if it is longer than the original, you can use this code, by Jeff Pinyan:</p>

<pre><code>sub preserve_case {
  my ($from, $to) = @_;
  my ($lf, $lt) = map length, @_;

  if ($lt &lt; $lf) { $from = substr $from, 0, $lt }
  else { $from .= substr $to, $lf }

  return uc $to | ($from ^ uc $from);
}</code></pre>

<p>This changes the sentence to &quot;this is a SUcCess case.&quot;</p>

<p>Just to show that C programmers can write C in any programming language, if you prefer a more C-like solution, the following script makes the substitution have the same case, letter by letter, as the original. (It also happens to run about 240% slower than the Perlish solution runs.) If the substitution has more characters than the string being substituted, the case of the last character is used for the rest of the substitution.</p>

<pre><code># Original by Nathan Torkington, massaged by Jeffrey Friedl
#
sub preserve_case($$)
{
    my ($old, $new) = @_;
    my ($state) = 0; # 0 = no change; 1 = lc; 2 = uc
    my ($i, $oldlen, $newlen, $c) = (0, length($old), length($new));
    my ($len) = $oldlen &lt; $newlen ? $oldlen : $newlen;

    for ($i = 0; $i &lt; $len; $i++) {
        if ($c = substr($old, $i, 1), $c =~ /[\W\d_]/) {
            $state = 0;
        } elsif (lc $c eq $c) {
            substr($new, $i, 1) = lc(substr($new, $i, 1));
            $state = 1;
        } else {
            substr($new, $i, 1) = uc(substr($new, $i, 1));
            $state = 2;
        }
    }
    # finish up with any remaining new (for when new is longer than old)
    if ($newlen &gt; $oldlen) {
        if ($state == 1) {
            substr($new, $oldlen) = lc(substr($new, $oldlen));
        } elsif ($state == 2) {
            substr($new, $oldlen) = uc(substr($new, $oldlen));
        }
    }
    return $new;
}</code></pre>

<h2 id="How-can-I-make-\w-match-national-character-sets?"><a class="permalink" href="#How-can-I-make-%5Cw-match-national-character-sets?">#</a><a id="How3"></a><a id="How-can-I-make-w-match-national-character-sets"></a>How can I make <code>\w</code> match national character sets?</h2>

<p>Put <code>use locale;</code> in your script. The \w character class is taken from the current locale.</p>

<p>See <a href="perllocale.html">perllocale</a> for details.</p>

<h2 id="How-can-I-match-a-locale-smart-version-of-/[a-zA-Z]/?"><a class="permalink" href="#How-can-I-match-a-locale-smart-version-of-/%5Ba-zA-Z%5D/?">#</a><a id="How4"></a><a id="How-can-I-match-a-locale-smart-version-of-a-zA-Z"></a>How can I match a locale-smart version of <code>/[a-zA-Z]/</code>?</h2>

<p>You can use the POSIX character class syntax <code>/[[:alpha:]]/</code> documented in <a href="perlre.html">perlre</a>.</p>

<p>No matter which locale you are in, the alphabetic characters are the characters in \w without the digits and the underscore. As a regex, that looks like <code>/[^\W\d_]/</code>. Its complement, the non-alphabetics, is then everything in \W along with the digits and the underscore, or <code>/[\W\d_]/</code>.</p>

<h2 id="How-can-I-quote-a-variable-to-use-in-a-regex?"><a class="permalink" href="#How-can-I-quote-a-variable-to-use-in-a-regex?">#</a><a id="How5"></a><a id="How-can-I-quote-a-variable-to-use-in-a-regex"></a>How can I quote a variable to use in a regex?</h2>

<p>The Perl parser will expand $variable and @variable references in regular expressions unless the delimiter is a single quote. Remember, too, that the right-hand side of a <code>s///</code> substitution is considered a double-quoted string (see <a href="perlop.html">perlop</a> for more details). Remember also that any regex special characters will be acted on unless you precede the substitution with \Q. Here&#39;s an example:</p>

<pre><code>$string = &quot;Placido P. Octopus&quot;;
$regex  = &quot;P.&quot;;

$string =~ s/$regex/Polyp/;
# $string is now &quot;Polypacido P. Octopus&quot;</code></pre>

<p>Because <code>.</code> is special in regular expressions, and can match any single character, the regex <code>P.</code> here has matched the &lt;Pl&gt; in the original string.</p>

<p>To escape the special meaning of <code>.</code>, we use <code>\Q</code>:</p>

<pre><code>$string = &quot;Placido P. Octopus&quot;;
$regex  = &quot;P.&quot;;

$string =~ s/\Q$regex/Polyp/;
# $string is now &quot;Placido Polyp Octopus&quot;</code></pre>

<p>The use of <code>\Q</code> causes the &lt;.&gt; in the regex to be treated as a regular character, so that <code>P.</code> matches a <code>P</code> followed by a dot.</p>

<h2 id="What-is-/o-really-for?"><a class="permalink" href="#What-is-/o-really-for?">#</a><a id="What"></a><a id="What-is-o-really-for"></a>What is <code>/o</code> really for?</h2>

<p>Using a variable in a regular expression match forces a re-evaluation (and perhaps recompilation) each time the regular expression is encountered. The <code>/o</code> modifier locks in the regex the first time it&#39;s used. This always happens in a constant regular expression, and in fact, the pattern was compiled into the internal format at the same time your entire program was.</p>

<p>Use of <code>/o</code> is irrelevant unless variable interpolation is used in the pattern, and if so, the regex engine will neither know nor care whether the variables change after the pattern is evaluated the <i>very first</i> time.</p>

<p><code>/o</code> is often used to gain an extra measure of efficiency by not performing subsequent evaluations when you know it won&#39;t matter (because you know the variables won&#39;t change), or more rarely, when you don&#39;t want the regex to notice if they do.</p>

<p>For example, here&#39;s a &quot;paragrep&quot; program:</p>

<pre><code>$/ = &#39;&#39;;  # paragraph mode
$pat = shift;
while (&lt;&gt;) {
    print if /$pat/o;
}</code></pre>

<h2 id="How-do-I-use-a-regular-expression-to-strip-C-style-comments-from-a-file?"><a class="permalink" href="#How-do-I-use-a-regular-expression-to-strip-C-style-comments-from-a-file?">#</a><a id="How6"></a><a id="How-do-I-use-a-regular-expression-to-strip-C-style-comments-from-a-file"></a>How do I use a regular expression to strip C style comments from a file?</h2>

<p>While this actually can be done, it&#39;s much harder than you&#39;d think. For example, this one-liner</p>

<pre><code class="plaintext">perl -0777 -pe &#39;s{/\*.*?\*/}{}gs&#39; foo.c</code></pre>

<p>will work in many but not all cases. You see, it&#39;s too simple-minded for certain kinds of C programs, in particular, those with what appear to be comments in quoted strings. For that, you&#39;d need something like this, created by Jeffrey Friedl and later modified by Fred Curtis.</p>

<pre><code>$/ = undef;
$_ = &lt;&gt;;
s#/\*[^*]*\*+([^/*][^*]*\*+)*/|(&quot;(\\.|[^&quot;\\])*&quot;|&#39;(\\.|[^&#39;\\])*&#39;|.[^/&quot;&#39;\\]*)#$2#gs
print;</code></pre>

<p>This could, of course, be more legibly written with the <code>/x</code> modifier, adding whitespace and comments. Here it is expanded, courtesy of Fred Curtis.</p>

<pre><code>s{
   /\*         ##  Start of /* ... */ comment
   [^*]*\*+    ##  Non-* followed by 1-or-more *&#39;s
   (
     [^/*][^*]*\*+
   )*          ##  0-or-more things which don&#39;t start with /
               ##    but do end with &#39;*&#39;
   /           ##  End of /* ... */ comment

 |         ##     OR  various things which aren&#39;t comments:

   (
     &quot;           ##  Start of &quot; ... &quot; string
     (
       \\.           ##  Escaped char
     |               ##    OR
       [^&quot;\\]        ##  Non &quot;\
     )*
     &quot;           ##  End of &quot; ... &quot; string

   |         ##     OR

     &#39;           ##  Start of &#39; ... &#39; string
     (
       \\.           ##  Escaped char
     |               ##    OR
       [^&#39;\\]        ##  Non &#39;\
     )*
     &#39;           ##  End of &#39; ... &#39; string

   |         ##     OR

     .           ##  Anything other char
     [^/&quot;&#39;\\]*   ##  Chars which doesn&#39;t start a comment, string or escape
   )
 }{$2}gxs;</code></pre>

<p>A slight modification also removes C++ comments:</p>

<pre><code>s#/\*[^*]*\*+([^/*][^*]*\*+)*/|//[^\n]*|(&quot;(\\.|[^&quot;\\])*&quot;|&#39;(\\.|[^&#39;\\])*&#39;|.[^/&quot;&#39;\\]*)#$2#gs;</code></pre>

<h2 id="Can-I-use-Perl-regular-expressions-to-match-balanced-text?"><a class="permalink" href="#Can-I-use-Perl-regular-expressions-to-match-balanced-text?">#</a><a id="Can"></a><a id="Can-I-use-Perl-regular-expressions-to-match-balanced-text"></a>Can I use Perl regular expressions to match balanced text?</h2>

<p>Historically, Perl regular expressions were not capable of matching balanced text. As of more recent versions of perl including 5.6.1 experimental features have been added that make it possible to do this. Look at the documentation for the (??{ }) construct in recent perlre manual pages to see an example of matching balanced parentheses. Be sure to take special notice of the warnings present in the manual before making use of this feature.</p>

<p>CPAN contains many modules that can be useful for matching text depending on the context. Damian Conway provides some useful patterns in Regexp::Common. The module Text::Balanced provides a general solution to this problem.</p>

<p>One of the common applications of balanced text matching is working with XML and HTML. There are many modules available that support these needs. Two examples are HTML::Parser and XML::Parser. There are many others.</p>

<p>An elaborate subroutine (for 7-bit ASCII only) to pull out balanced and possibly nested single chars, like <code>`</code> and <code>&#39;</code>, <code>{</code> and <code>}</code>, or <code>(</code> and <code>)</code> can be found in http://www.cpan.org/authors/id/TOMC/scripts/pull_quotes.gz .</p>

<p>The C::Scan module from CPAN also contains such subs for internal use, but they are undocumented.</p>

<h2 id="What-does-it-mean-that-regexes-are-greedy?-How-can-I-get-around-it?"><a class="permalink" href="#What-does-it-mean-that-regexes-are-greedy?-How-can-I-get-around-it?">#</a><a id="What1"></a><a id="What-does-it-mean-that-regexes-are-greedy-How-can-I-get-around-it"></a>What does it mean that regexes are greedy? How can I get around it?</h2>

<p>Most people mean that greedy regexes match as much as they can. Technically speaking, it&#39;s actually the quantifiers (<code>?</code>, <code>*</code>, <code>+</code>, <code>{}</code>) that are greedy rather than the whole pattern; Perl prefers local greed and immediate gratification to overall greed. To get non-greedy versions of the same quantifiers, use (<code>??</code>, <code>*?</code>, <code>+?</code>, <code>{}?</code>).</p>

<p>An example:</p>

<pre><code>$s1 = $s2 = &quot;I am very very cold&quot;;
$s1 =~ s/ve.*y //;      # I am cold
$s2 =~ s/ve.*?y //;     # I am very cold</code></pre>

<p>Notice how the second substitution stopped matching as soon as it encountered &quot;y &quot;. The <code>*?</code> quantifier effectively tells the regular expression engine to find a match as quickly as possible and pass control on to whatever is next in line, like you would if you were playing hot potato.</p>

<h2 id="How-do-I-process-each-word-on-each-line?"><a class="permalink" href="#How-do-I-process-each-word-on-each-line?">#</a><a id="How7"></a><a id="How-do-I-process-each-word-on-each-line"></a>How do I process each word on each line?</h2>

<p>Use the split function:</p>

<pre><code>    while (&lt;&gt;) {
	foreach $word ( split ) {
	    # do something with $word here
	}
    }</code></pre>

<p>Note that this isn&#39;t really a word in the English sense; it&#39;s just chunks of consecutive non-whitespace characters.</p>

<p>To work with only alphanumeric sequences (including underscores), you might consider</p>

<pre><code>    while (&lt;&gt;) {
	foreach $word (m/(\w+)/g) {
	    # do something with $word here
	}
    }</code></pre>

<h2 id="How-can-I-print-out-a-word-frequency-or-line-frequency-summary?"><a class="permalink" href="#How-can-I-print-out-a-word-frequency-or-line-frequency-summary?">#</a><a id="How8"></a><a id="How-can-I-print-out-a-word-frequency-or-line-frequency-summary"></a>How can I print out a word-frequency or line-frequency summary?</h2>

<p>To do this, you have to parse out each word in the input stream. We&#39;ll pretend that by word you mean chunk of alphabetics, hyphens, or apostrophes, rather than the non-whitespace chunk idea of a word given in the previous question:</p>

<pre><code>    while (&lt;&gt;) {
	while ( /(\b[^\W_\d][\w&#39;-]+\b)/g ) {   # misses &quot;`sheep&#39;&quot;
	    $seen{$1}++;
	}
    }
    while ( ($word, $count) = each %seen ) {
	print &quot;$count $word\n&quot;;
    }</code></pre>

<p>If you wanted to do the same thing for lines, you wouldn&#39;t need a regular expression:</p>

<pre><code>    while (&lt;&gt;) {
	$seen{$_}++;
    }
    while ( ($line, $count) = each %seen ) {
	print &quot;$count $line&quot;;
    }</code></pre>

<p>If you want these output in a sorted order, see <a href="perlfaq4.html">perlfaq4</a>: ``How do I sort a hash (optionally by value instead of key)?&#39;&#39;.</p>

<h2 id="How-can-I-do-approximate-matching?"><a class="permalink" href="#How-can-I-do-approximate-matching?">#</a><a id="How9"></a><a id="How-can-I-do-approximate-matching"></a>How can I do approximate matching?</h2>

<p>See the module String::Approx available from CPAN.</p>

<h2 id="How-do-I-efficiently-match-many-regular-expressions-at-once?"><a class="permalink" href="#How-do-I-efficiently-match-many-regular-expressions-at-once?">#</a><a id="How10"></a><a id="How-do-I-efficiently-match-many-regular-expressions-at-once"></a>How do I efficiently match many regular expressions at once?</h2>

<p>The following is extremely inefficient:</p>

<pre><code>    # slow but obvious way
    @popstates = qw(CO ON MI WI MN);
    while (defined($line = &lt;&gt;)) {
	for $state (@popstates) {
	    if ($line =~ /\b$state\b/i) {
		print $line;
		last;
	    }
	}
    }</code></pre>

<p>That&#39;s because Perl has to recompile all those patterns for each of the lines of the file. As of the 5.005 release, there&#39;s a much better approach, one which makes use of the new <code>qr//</code> operator:</p>

<pre><code>    # use spiffy new qr// operator, with /i flag even
    use 5.005;
    @popstates = qw(CO ON MI WI MN);
    @poppats   = map { qr/\b$_\b/i } @popstates;
    while (defined($line = &lt;&gt;)) {
	for $patobj (@poppats) {
	    print $line if $line =~ /$patobj/;
	}
    }</code></pre>

<h2 id="Why-don&#39;t-word-boundary-searches-with-\b-work-for-me?"><a class="permalink" href="#Why-don&#39;t-word-boundary-searches-with-%5Cb-work-for-me?">#</a><a id="Why"></a><a id="Why-dont-word-boundary-searches-with-b-work-for-me"></a>Why don&#39;t word-boundary searches with <code>\b</code> work for me?</h2>

<p>Two common misconceptions are that <code>\b</code> is a synonym for <code>\s+</code> and that it&#39;s the edge between whitespace characters and non-whitespace characters. Neither is correct. <code>\b</code> is the place between a <code>\w</code> character and a <code>\W</code> character (that is, <code>\b</code> is the edge of a &quot;word&quot;). It&#39;s a zero-width assertion, just like <code>^</code>, <code>$</code>, and all the other anchors, so it doesn&#39;t consume any characters. <a href="perlre.html">perlre</a> describes the behavior of all the regex metacharacters.</p>

<p>Here are examples of the incorrect application of <code>\b</code>, with fixes:</p>

<pre><code>&quot;two words&quot; =~ /(\w+)\b(\w+)/;	    # WRONG
&quot;two words&quot; =~ /(\w+)\s+(\w+)/;	    # right

&quot; =matchless= text&quot; =~ /\b=(\w+)=\b/;   # WRONG
&quot; =matchless= text&quot; =~ /=(\w+)=/;       # right</code></pre>

<p>Although they may not do what you thought they did, <code>\b</code> and <code>\B</code> can still be quite useful. For an example of the correct use of <code>\b</code>, see the example of matching duplicate words over multiple lines.</p>

<p>An example of using <code>\B</code> is the pattern <code>\Bis\B</code>. This will find occurrences of &quot;is&quot; on the insides of words only, as in &quot;thistle&quot;, but not &quot;this&quot; or &quot;island&quot;.</p>

<h2 id="Why-does-using-$&amp;,-$`,-or-$&#39;-slow-my-program-down?"><a class="permalink" href="#Why-does-using-$&amp;,-$%60,-or-$&#39;-slow-my-program-down?">#</a><a id="Why1"></a><a id="Why-does-using-or-slow-my-program-down"></a>Why does using $&amp;, $`, or $&#39; slow my program down?</h2>

<p>Once Perl sees that you need one of these variables anywhere in the program, it provides them on each and every pattern match. The same mechanism that handles these provides for the use of $1, $2, etc., so you pay the same price for each regex that contains capturing parentheses. If you never use $&amp;, etc., in your script, then regexes <i>without</i> capturing parentheses won&#39;t be penalized. So avoid $&amp;, $&#39;, and $` if you can, but if you can&#39;t, once you&#39;ve used them at all, use them at will because you&#39;ve already paid the price. Remember that some algorithms really appreciate them. As of the 5.005 release. the $&amp; variable is no longer &quot;expensive&quot; the way the other two are.</p>

<h2 id="What-good-is-\G-in-a-regular-expression?"><a class="permalink" href="#What-good-is-%5CG-in-a-regular-expression?">#</a><a id="What2"></a><a id="What-good-is-G-in-a-regular-expression"></a>What good is <code>\G</code> in a regular expression?</h2>

<p>You use the <code>\G</code> anchor to start the next match on the same string where the last match left off. The regular expression engine cannot skip over any characters to find the next match with this anchor, so <code>\G</code> is similar to the beginning of string anchor, <code>^</code>. The <code>\G</code> anchor is typically used with the <code>g</code> flag. It uses the value of pos() as the position to start the next match. As the match operator makes successive matches, it updates pos() with the position of the next character past the last match (or the first character of the next match, depending on how you like to look at it). Each string has its own pos() value.</p>

<p>Suppose you want to match all of consective pairs of digits in a string like &quot;1122a44&quot; and stop matching when you encounter non-digits. You want to match <code>11</code> and <code>22</code> but the letter &lt;a&gt; shows up between <code>22</code> and <code>44</code> and you want to stop at <code>a</code>. Simply matching pairs of digits skips over the <code>a</code> and still matches <code>44</code>.</p>

<pre><code>$_ = &quot;1122a44&quot;;
my @pairs = m/(\d\d)/g;   # qw( 11 22 44 )</code></pre>

<p>If you use the \G anchor, you force the match after <code>22</code> to start with the <code>a</code>. The regular expression cannot match there since it does not find a digit, so the next match fails and the match operator returns the pairs it already found.</p>

<pre><code>$_ = &quot;1122a44&quot;;
my @pairs = m/\G(\d\d)/g; # qw( 11 22 )</code></pre>

<p>You can also use the <code>\G</code> anchor in scalar context. You still need the <code>g</code> flag.</p>

<pre><code>$_ = &quot;1122a44&quot;;
while( m/\G(\d\d)/g )
	{
	print &quot;Found $1\n&quot;;
	}</code></pre>

<p>After the match fails at the letter <code>a</code>, perl resets pos() and the next match on the same string starts at the beginning.</p>

<pre><code>$_ = &quot;1122a44&quot;;
while( m/\G(\d\d)/g )
	{
	print &quot;Found $1\n&quot;;
	}

print &quot;Found $1 after while&quot; if m/(\d\d)/g; # finds &quot;11&quot;</code></pre>

<p>You can disable pos() resets on fail with the <code>c</code> flag. Subsequent matches start where the last successful match ended (the value of pos()) even if a match on the same string as failed in the meantime. In this case, the match after the while() loop starts at the <code>a</code> (where the last match stopped), and since it does not use any anchor it can skip over the <code>a</code> to find &quot;44&quot;.</p>

<pre><code>$_ = &quot;1122a44&quot;;
while( m/\G(\d\d)/gc )
	{
	print &quot;Found $1\n&quot;;
	}

print &quot;Found $1 after while&quot; if m/(\d\d)/g; # finds &quot;44&quot;</code></pre>

<p>Typically you use the <code>\G</code> anchor with the <code>c</code> flag when you want to try a different match if one fails, such as in a tokenizer. Jeffrey Friedl offers this example which works in 5.004 or later.</p>

<pre><code>while (&lt;&gt;) {
  chomp;
  PARSER: {
       m/ \G( \d+\b    )/gcx   &amp;&amp; do { print &quot;number: $1\n&quot;;  redo; };
       m/ \G( \w+      )/gcx   &amp;&amp; do { print &quot;word:   $1\n&quot;;  redo; };
       m/ \G( \s+      )/gcx   &amp;&amp; do { print &quot;space:  $1\n&quot;;  redo; };
       m/ \G( [^\w\d]+ )/gcx   &amp;&amp; do { print &quot;other:  $1\n&quot;;  redo; };
  }
}</code></pre>

<p>For each line, the PARSER loop first tries to match a series of digits followed by a word boundary. This match has to start at the place the last match left off (or the beginning of the string on the first match). Since <code>m/ \G( \d+\b )/gcx</code> uses the <code>c</code> flag, if the string does not match that regular expression, perl does not reset pos() and the next match starts at the same position to try a different pattern.</p>

<h2 id="Are-Perl-regexes-DFAs-or-NFAs?-Are-they-POSIX-compliant?"><a class="permalink" href="#Are-Perl-regexes-DFAs-or-NFAs?-Are-they-POSIX-compliant?">#</a><a id="Are"></a><a id="Are-Perl-regexes-DFAs-or-NFAs-Are-they-POSIX-compliant"></a>Are Perl regexes DFAs or NFAs? Are they POSIX compliant?</h2>

<p>While it&#39;s true that Perl&#39;s regular expressions resemble the DFAs (deterministic finite automata) of the egrep(1) program, they are in fact implemented as NFAs (non-deterministic finite automata) to allow backtracking and backreferencing. And they aren&#39;t POSIX-style either, because those guarantee worst-case behavior for all cases. (It seems that some people prefer guarantees of consistency, even when what&#39;s guaranteed is slowness.) See the book &quot;Mastering Regular Expressions&quot; (from O&#39;Reilly) by Jeffrey Friedl for all the details you could ever hope to know on these matters (a full citation appears in <a href="perlfaq2.html">perlfaq2</a>).</p>

<h2 id="What&#39;s-wrong-with-using-grep-in-a-void-context?"><a class="permalink" href="#What&#39;s-wrong-with-using-grep-in-a-void-context?">#</a><a id="What3"></a><a id="Whats-wrong-with-using-grep-in-a-void-context"></a>What&#39;s wrong with using grep in a void context?</h2>

<p>The problem is that grep builds a return list, regardless of the context. This means you&#39;re making Perl go to the trouble of building a list that you then just throw away. If the list is large, you waste both time and space. If your intent is to iterate over the list, then use a for loop for this purpose.</p>

<p>In perls older than 5.8.1, map suffers from this problem as well. But since 5.8.1, this has been fixed, and map is context aware - in void context, no lists are constructed.</p>

<h2 id="How-can-I-match-strings-with-multibyte-characters?"><a class="permalink" href="#How-can-I-match-strings-with-multibyte-characters?">#</a><a id="How11"></a><a id="How-can-I-match-strings-with-multibyte-characters"></a>How can I match strings with multibyte characters?</h2>

<p>Starting from Perl 5.6 Perl has had some level of multibyte character support. Perl 5.8 or later is recommended. Supported multibyte character repertoires include Unicode, and legacy encodings through the Encode module. See <a href="https://metacpan.org/pod/perluniintro">perluniintro</a>, <a href="perlunicode.html">perlunicode</a>, and <a href="https://metacpan.org/pod/Encode">Encode</a>.</p>

<p>If you are stuck with older Perls, you can do Unicode with the <code>Unicode::String</code> module, and character conversions using the <code>Unicode::Map8</code> and <code>Unicode::Map</code> modules. If you are using Japanese encodings, you might try using the jperl 5.005_03.</p>

<p>Finally, the following set of approaches was offered by Jeffrey Friedl, whose article in issue #5 of The Perl Journal talks about this very matter.</p>

<p>Let&#39;s suppose you have some weird Martian encoding where pairs of ASCII uppercase letters encode single Martian letters (i.e. the two bytes &quot;CV&quot; make a single Martian letter, as do the two bytes &quot;SG&quot;, &quot;VS&quot;, &quot;XX&quot;, etc.). Other bytes represent single characters, just like ASCII.</p>

<p>So, the string of Martian &quot;I am CVSGXX!&quot; uses 12 bytes to encode the nine characters &#39;I&#39;, &#39; &#39;, &#39;a&#39;, &#39;m&#39;, &#39; &#39;, &#39;CV&#39;, &#39;SG&#39;, &#39;XX&#39;, &#39;!&#39;.</p>

<p>Now, say you want to search for the single character <code>/GX/</code>. Perl doesn&#39;t know about Martian, so it&#39;ll find the two bytes &quot;GX&quot; in the &quot;I am CVSGXX!&quot; string, even though that character isn&#39;t there: it just looks like it is because &quot;SG&quot; is next to &quot;XX&quot;, but there&#39;s no real &quot;GX&quot;. This is a big problem.</p>

<p>Here are a few ways, all painful, to deal with it:</p>

<pre><code>$martian =~ s/([A-Z][A-Z])/ $1 /g; # Make sure adjacent ``martian&#39;&#39;
                                   # bytes are no longer adjacent.
print &quot;found GX!\n&quot; if $martian =~ /GX/;</code></pre>

<p>Or like this:</p>

<pre><code>@chars = $martian =~ m/([A-Z][A-Z]|[^A-Z])/g;
# above is conceptually similar to:     @chars = $text =~ m/(.)/g;
#
foreach $char (@chars) {
    print &quot;found GX!\n&quot;, last if $char eq &#39;GX&#39;;
}</code></pre>

<p>Or like this:</p>

<pre><code>while ($martian =~ m/\G([A-Z][A-Z]|.)/gs) {  # \G probably unneeded
    print &quot;found GX!\n&quot;, last if $1 eq &#39;GX&#39;;
}</code></pre>

<p>Here&#39;s another, slightly less painful, way to do it from Benjamin Goldberg:</p>

<pre><code>$martian =~ m/
   (?!&lt;[A-Z])
   (?:[A-Z][A-Z])*?
   GX
/x;</code></pre>

<p>This succeeds if the &quot;martian&quot; character GX is in the string, and fails otherwise. If you don&#39;t like using (?!&lt;), you can replace (?!&lt;[A-Z]) with (?:^|[^A-Z]).</p>

<p>It does have the drawback of putting the wrong thing in $-[0] and $+[0], but this usually can be worked around.</p>

<h2 id="How-do-I-match-a-pattern-that-is-supplied-by-the-user?"><a class="permalink" href="#How-do-I-match-a-pattern-that-is-supplied-by-the-user?">#</a><a id="How12"></a><a id="How-do-I-match-a-pattern-that-is-supplied-by-the-user"></a>How do I match a pattern that is supplied by the user?</h2>

<p>Well, if it&#39;s really a pattern, then just use</p>

<pre><code>chomp($pattern = &lt;STDIN&gt;);
if ($line =~ /$pattern/) { }</code></pre>

<p>Alternatively, since you have no guarantee that your user entered a valid regular expression, trap the exception this way:</p>

<pre><code>if (eval { $line =~ /$pattern/ }) { }</code></pre>

<p>If all you really want to search for a string, not a pattern, then you should either use the index() function, which is made for string searching, or if you can&#39;t be disabused of using a pattern match on a non-pattern, then be sure to use <code>\Q</code>...<code>\E</code>, documented in <a href="perlre.html">perlre</a>.</p>

<pre><code>    $pattern = &lt;STDIN&gt;;

    open (FILE, $input) or die &quot;Couldn&#39;t open input $input: $!; aborting&quot;;
    while (&lt;FILE&gt;) {
	print if /\Q$pattern\E/;
    }
    close FILE;</code></pre>

<h1 id="AUTHOR-AND-COPYRIGHT"><a class="permalink" href="#AUTHOR-AND-COPYRIGHT">#</a><a id="AUTHOR"></a>AUTHOR AND COPYRIGHT</h1>

<p>Copyright (c) 1997-2002 Tom Christiansen and Nathan Torkington. All rights reserved.</p>

<p>This documentation is free; you can redistribute it and/or modify it under the same terms as Perl itself.</p>

<p>Irrespective of its distribution, all code examples in this file are hereby placed into the public domain. You are permitted and encouraged to use this code in your own programs for fun or for profit as you see fit. A simple comment in the code giving credit would be courteous but is not required.</p>


      </div>
      <div id="footer">
        <p>Perldoc Browser is maintained by Dan Book (<a href="https://metacpan.org/author/DBOOK">DBOOK</a>). Please contact him via the <a href="https://github.com/Grinnz/perldoc-browser/issues">GitHub issue tracker</a> or <a href="mailto:dbook@cpan.org">email</a> regarding any issues with the site itself, search, or rendering of documentation.</p>

<p>The Perl documentation is maintained by the Perl 5 Porters in the development of Perl. Please contact them via the <a href="https://github.com/Perl/perl5/issues">Perl issue tracker</a>, the <a href="https://lists.perl.org/list/perl5-porters.html">mailing list</a>, or <a href="https://kiwiirc.com/client/irc.perl.org/p5p">IRC</a> to report any issues with the contents or format of the documentation.</p>


      </div>
    </div>
    <script src="../js/bootstrap.bundle.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.highlightAll();</script>
  </body>

<!-- Mirrored from perldoc.perl.org/5.6.2/perlfaq6 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Aug 2025 16:20:45 GMT -->
</html>
